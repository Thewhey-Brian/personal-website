[
  {
    "title": "Graph Neural Networks for Spatial Transcriptomics",
    "summary": "A comprehensive guide to understanding and applying GNNs to spatial transcriptomics data, from foundational concepts to cutting-edge research implementations",
    "status": "completed",
    "role": "Research & Implementation",
    "stack": [
      "PyTorch",
      "PyTorch Geometric",
      "Python",
      "Graph Neural Networks",
      "Spatial Transcriptomics"
    ],
    "repoUrl": "https://github.com/yourusername/gnn-spatial-transcriptomics",
    "images": [],
    "tags": [
      "deep learning",
      "bioinformatics",
      "graph neural networks",
      "spatial transcriptomics",
      "computational biology"
    ],
    "featured": true,
    "startDate": "2025-08-15T00:00:00.000Z",
    "body": {
      "raw": "\n# Graph Neural Networks for Spatial Transcriptomics\n\nA deep dive into applying Graph Neural Networks (GNNs) to spatial transcriptomics research, bridging deep learning theory with cutting-edge biological applications.\n\n## Table of Contents\n\n1. [Introduction](#introduction)\n2. [From CNNs to GNNs](#from-cnns-to-gnns)\n3. [Core GNN Architectures](#core-gnn-architectures)\n4. [Graph Construction Strategies](#graph-construction-strategies)\n5. [State-of-the-Art Methods in Spatial Transcriptomics](#state-of-the-art-methods)\n6. [Implementation Guide](#implementation-guide)\n7. [Practical Considerations](#practical-considerations)\n\n---\n\n## Introduction\n\nSpatial transcriptomics (ST) captures gene expression while preserving the physical location of cells in tissue. This spatial context creates a natural graph structure where:\n\n- **Nodes** = spots/cells with gene expression vectors\n- **Edges** = spatial proximity or molecular similarity\n- **Task** = identify tissue domains, cell types, or spatial patterns\n\nGraph Neural Networks provide a powerful framework to leverage this structure, enabling message-passing that respects both spatial topology and molecular relationships.\n\n---\n\n## From CNNs to GNNs\n\n### Why CNNs Can't Handle Irregular Grids\n\nConvolutional Neural Networks excel at structured data (images) because:\n\n1. **Local connectivity**: Each pixel has a fixed neighborhood (e.g., 3×3)\n2. **Weight sharing**: The same filter slides across all positions, making parameter efficient\n3. **Translation invariance**: Patterns learned anywhere apply everywhere\n\nThe convolution operation at pixel $(i,j)$ is:\n\n$$\ny_{i,j} = \\sum_{a=-1}^{1} \\sum_{b=-1}^{1} w_{a,b} \\cdot x_{i+a, j+b}\n$$\n\n**The problem for spatial transcriptomics**: Spots are irregularly spaced and often have varying numbers of neighbors. We can't use a fixed 3×3 kernel.\n\n### Message Passing: The Key Insight\n\nGNNs generalize convolution to **arbitrary graph structures** through message passing:\n\n$$\nh_i^{(l+1)} = \\sigma\\left(W^{(l)} \\cdot \\text{AGGREGATE}\\{h_j^{(l)} : j \\in \\mathcal{N}(i)\\}\\right)\n$$\n\nWhere:\n- $h_i^{(l)}$ = feature vector of node $i$ at layer $l$\n- $\\mathcal{N}(i)$ = neighbors of node $i$\n- $W^{(l)}$ = learnable weight matrix\n- $\\sigma$ = activation function (ReLU, etc.)\n\nThis is conceptually similar to CNN convolution, but:\n- Neighbors are defined by **edges**, not spatial proximity on a grid\n- Each node can have a **variable number** of neighbors\n- Weights are **shared across all nodes**, just like CNN filters\n\n---\n\n## Core GNN Architectures\n\n### 1. Graph Convolutional Network (GCN)\n\n**Paper**: Kipf & Welling (2017)\n\n**Core Idea**: Normalize neighbor aggregation by degree to prevent scale issues.\n\n#### Mathematical Formulation\n\nGiven:\n- $\\mathbf{X} \\in \\mathbb{R}^{N \\times F}$: node features (N spots, F genes)\n- $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$: adjacency matrix\n- $\\mathbf{D}$: degree matrix (diagonal, where $D_{ii} = \\sum_j A_{ij}$)\n\nAdd self-loops and normalize:\n\n$$\n\\tilde{\\mathbf{A}} = \\mathbf{A} + \\mathbf{I} \\quad \\text{(add self-connections)}\n$$\n\n$$\n\\tilde{D}_{ii} = \\sum_j \\tilde{A}_{ij} \\quad \\text{(recompute degrees)}\n$$\n\nThe GCN layer performs symmetric normalization:\n\n$$\n\\mathbf{H}^{(l+1)} = \\sigma\\left(\\tilde{\\mathbf{D}}^{-1/2} \\tilde{\\mathbf{A}} \\tilde{\\mathbf{D}}^{-1/2} \\mathbf{H}^{(l)} \\mathbf{W}^{(l)}\\right)\n$$\n\n**Intuition**: The symmetric normalization $\\tilde{\\mathbf{D}}^{-1/2} \\tilde{\\mathbf{A}} \\tilde{\\mathbf{D}}^{-1/2}$ creates a normalized adjacency that averages features fairly across neighbors, preventing high-degree nodes from dominating.\n\n#### PyTorch Implementation (Matrix Form)\n\n```python\nimport torch\nimport torch.nn as nn\n\ndef normalize_adj(edge_index, num_nodes):\n    \"\"\"\n    Build symmetric normalized adjacency: D^{-1/2} A D^{-1/2}\n    Returns sparse tensor indices and values.\n    \"\"\"\n    i, j = edge_index\n    # Add self-loops\n    self_loops = torch.arange(num_nodes, device=edge_index.device)\n    i = torch.cat([i, self_loops])\n    j = torch.cat([j, self_loops])\n\n    # Compute degree\n    deg = torch.bincount(j, minlength=num_nodes).float()\n    deg_inv_sqrt = deg.clamp(min=1).pow(-0.5)\n\n    # Symmetric normalization weights\n    vals = deg_inv_sqrt[i] * deg_inv_sqrt[j]\n    return torch.stack([i, j], dim=0), vals\n\nclass GCNLayer(nn.Module):\n    \"\"\"\n    Graph Convolutional Layer with sparse adjacency multiply.\n    \"\"\"\n    def __init__(self, in_channels, out_channels, bias=True):\n        super().__init__()\n        self.lin = nn.Linear(in_channels, out_channels, bias=bias)\n\n    def forward(self, x, edge_index):\n        N = x.size(0)\n        idx, vals = normalize_adj(edge_index, N)\n        A_norm = torch.sparse_coo_tensor(idx, vals, (N, N), device=x.device)\n\n        x = self.lin(x)                    # [N, F_out]\n        x = torch.sparse.mm(A_norm, x)     # Sparse matrix multiply\n        return torch.relu(x)\n\n# Full GCN Model\nclass GCN(nn.Module):\n    def __init__(self, in_channels, hidden_channels, out_channels, num_layers=2):\n        super().__init__()\n        self.layers = nn.ModuleList()\n        self.layers.append(GCNLayer(in_channels, hidden_channels))\n        for _ in range(num_layers - 2):\n            self.layers.append(GCNLayer(hidden_channels, hidden_channels))\n        self.layers.append(GCNLayer(hidden_channels, out_channels))\n\n    def forward(self, x, edge_index):\n        for i, layer in enumerate(self.layers[:-1]):\n            x = layer(x, edge_index)\n            x = torch.relu(x)\n            x = torch.dropout(x, p=0.5, train=self.training)\n        x = self.layers[-1](x, edge_index)\n        return x\n```\n\n**Strengths**:\n- Simple, efficient, mathematically principled\n- Fast on small-to-medium graphs\n- Smooth aggregation good for homogeneous tissue\n\n**Weaknesses**:\n- Fixed (isotropic) weights—all neighbors treated equally\n- Transductive (needs full graph at training)\n- Over-smoothing with many layers\n\n---\n\n### 2. GraphSAGE\n\n**Paper**: Hamilton et al. (2017)\n\n**Core Idea**: Sample neighbors and use robust aggregators (mean, LSTM, max-pool) to scale to large graphs and enable **inductive learning** (generalize to unseen nodes/graphs).\n\n#### Update Rule\n\n$$\nh_i^{(l+1)} = \\sigma\\left(\\mathbf{W} \\cdot \\text{CONCAT}\\left[h_i^{(l)}, \\text{AGG}\\{h_j^{(l)} : j \\in \\mathcal{N}(i)\\}\\right]\\right)\n$$\n\nKey differences from GCN:\n1. **Concatenate** self-feature with aggregated neighbors (preserves identity)\n2. **Sample** a fixed number of neighbors (e.g., 10) instead of using all\n3. **Aggregator** choices: mean, max-pool, LSTM\n\n#### PyTorch Implementation\n\n```python\nimport torch\nimport torch.nn as nn\nimport torch.nn.functional as F\n\nclass SAGEConv(nn.Module):\n    \"\"\"\n    GraphSAGE layer with mean aggregation.\n    \"\"\"\n    def __init__(self, in_channels, out_channels, normalize=True):\n        super().__init__()\n        self.lin_self = nn.Linear(in_channels, out_channels)\n        self.lin_neigh = nn.Linear(in_channels, out_channels)\n        self.normalize = normalize\n\n    def forward(self, x, edge_index, num_neighbors_sample=10):\n        N = x.size(0)\n\n        # Sample neighbors (for scalability)\n        src, dst = edge_index\n        # Group by destination\n        neighbors = {}\n        for s, d in zip(src.tolist(), dst.tolist()):\n            neighbors.setdefault(d, []).append(s)\n\n        # Sample and aggregate\n        neigh_features = []\n        for i in range(N):\n            if i in neighbors and len(neighbors[i]) > 0:\n                sampled = torch.tensor(\n                    neighbors[i][:num_neighbors_sample],\n                    device=x.device\n                )\n                neigh_features.append(x[sampled].mean(dim=0))\n            else:\n                neigh_features.append(torch.zeros(x.size(1), device=x.device))\n\n        neigh_agg = torch.stack(neigh_features)  # [N, F]\n\n        # Combine self and neighbor\n        out = self.lin_self(x) + self.lin_neigh(neigh_agg)\n\n        if self.normalize:\n            out = F.normalize(out, p=2, dim=1)\n\n        return out\n\nclass GraphSAGE(nn.Module):\n    def __init__(self, in_channels, hidden_channels, out_channels, num_layers=2):\n        super().__init__()\n        self.layers = nn.ModuleList()\n        self.layers.append(SAGEConv(in_channels, hidden_channels))\n        for _ in range(num_layers - 2):\n            self.layers.append(SAGEConv(hidden_channels, hidden_channels))\n        self.layers.append(SAGEConv(hidden_channels, out_channels))\n\n    def forward(self, x, edge_index):\n        for layer in self.layers[:-1]:\n            x = layer(x, edge_index)\n            x = F.relu(x)\n            x = F.dropout(x, p=0.5, training=self.training)\n        x = self.layers[-1](x, edge_index)\n        return x\n```\n\n**Strengths**:\n- Scales to massive graphs via neighbor sampling\n- Inductive: can generalize to new slides without retraining\n- Multiple aggregator options\n\n**Weaknesses**:\n- Sampling introduces variance\n- More hyperparameters (sample size per layer)\n- Still treats all sampled neighbors equally\n\n---\n\n### 3. Graph Attention Network (GAT)\n\n**Paper**: Veličković et al. (2018)\n\n**Core Idea**: Learn **per-edge attention weights** so the model can focus on important neighbors and ignore noisy ones.\n\n#### Attention Mechanism\n\nFor each edge $(i, j)$:\n\n$$\ne_{ij} = \\text{LeakyReLU}\\left(\\mathbf{a}^T [\\mathbf{W} h_i \\,||\\, \\mathbf{W} h_j]\\right)\n$$\n\nNormalize with softmax over all neighbors:\n\n$$\n\\alpha_{ij} = \\frac{\\exp(e_{ij})}{\\sum_{k \\in \\mathcal{N}(i)} \\exp(e_{ik})}\n$$\n\nAggregate with learned weights:\n\n$$\nh_i^{(l+1)} = \\sigma\\left(\\sum_{j \\in \\mathcal{N}(i)} \\alpha_{ij} \\cdot \\mathbf{W} \\cdot h_j^{(l)}\\right)\n$$\n\n**Multi-head attention** (like Transformers): Run $K$ independent attention heads and concatenate:\n\n$$\nh_i^{(l+1)} = \\Big|\\Big|_{k=1}^K \\sigma\\left(\\sum_{j \\in \\mathcal{N}(i)} \\alpha_{ij}^k \\cdot \\mathbf{W}^k \\cdot h_j^{(l)}\\right)\n$$\n\n#### PyTorch Implementation\n\n```python\nimport torch\nimport torch.nn as nn\nimport torch.nn.functional as F\n\nclass GATLayer(nn.Module):\n    \"\"\"\n    Graph Attention Layer (single head).\n    \"\"\"\n    def __init__(self, in_channels, out_channels, dropout=0.6, alpha=0.2):\n        super().__init__()\n        self.W = nn.Linear(in_channels, out_channels, bias=False)\n        self.a = nn.Parameter(torch.zeros(size=(2 * out_channels, 1)))\n        self.leakyrelu = nn.LeakyReLU(alpha)\n        self.dropout = dropout\n        nn.init.xavier_uniform_(self.a.data, gain=1.414)\n\n    def forward(self, x, edge_index):\n        # Linear transformation\n        Wh = self.W(x)  # [N, out_channels]\n        N = Wh.size(0)\n\n        # Compute attention coefficients\n        src, dst = edge_index\n        # Concatenate source and destination features\n        Wh_src = Wh[src]  # [E, out_channels]\n        Wh_dst = Wh[dst]  # [E, out_channels]\n        concat_features = torch.cat([Wh_src, Wh_dst], dim=1)  # [E, 2*out_channels]\n\n        # Attention mechanism\n        e = self.leakyrelu(concat_features @ self.a).squeeze()  # [E]\n\n        # Normalize per destination node\n        attention = torch.zeros(N, device=x.device)\n        attention_weights = torch.zeros_like(e)\n\n        for i in range(N):\n            mask = (dst == i)\n            if mask.sum() > 0:\n                e_neighbors = e[mask]\n                alpha = F.softmax(e_neighbors, dim=0)\n                attention_weights[mask] = alpha\n\n        # Apply dropout to attention\n        attention_weights = F.dropout(attention_weights, self.dropout, training=self.training)\n\n        # Aggregate\n        out = torch.zeros_like(Wh)\n        for i in range(N):\n            mask = (dst == i)\n            if mask.sum() > 0:\n                out[i] = (attention_weights[mask].unsqueeze(1) * Wh[src[mask]]).sum(dim=0)\n\n        return out\n\nclass GAT(nn.Module):\n    def __init__(self, in_channels, hidden_channels, out_channels,\n                 num_heads=8, dropout=0.6):\n        super().__init__()\n        self.dropout = dropout\n\n        # Multi-head first layer\n        self.attentions = nn.ModuleList([\n            GATLayer(in_channels, hidden_channels, dropout=dropout)\n            for _ in range(num_heads)\n        ])\n\n        # Single-head output layer\n        self.out_att = GATLayer(\n            hidden_channels * num_heads,\n            out_channels,\n            dropout=dropout\n        )\n\n    def forward(self, x, edge_index):\n        # First layer: concatenate multi-head outputs\n        x = torch.cat([att(x, edge_index) for att in self.attentions], dim=1)\n        x = F.dropout(x, self.dropout, training=self.training)\n        x = F.elu(x)\n\n        # Output layer\n        x = self.out_att(x, edge_index)\n        return x\n```\n\n**Strengths**:\n- Learns which neighbors are important (anisotropic)\n- Better at handling heterogeneous neighborhoods\n- Respects sharp boundaries (e.g., tumor-stroma)\n\n**Weaknesses**:\n- More parameters (attention + multi-heads)\n- Slower than GCN\n- Can be unstable (needs careful tuning of dropout, LR)\n\n---\n\n## Architecture Comparison Table\n\n| Model | Neighbor Weights | Sampling | Inductive? | Best Use Case |\n|-------|-----------------|----------|------------|---------------|\n| **GCN** | Fixed by normalized adjacency | Full graph (no sampling) | No (transductive) | Smooth tissue, clean spatial graphs, small-medium datasets |\n| **GraphSAGE** | Fixed aggregator (mean/max/LSTM) | Neighborhood sampling | Yes | Large graphs, multiple slides, production systems |\n| **GAT** | Learned per-edge attention | Full neighborhood (or can sample) | Often yes | Heterogeneous tissue, sharp boundaries, variable neighbor quality |\n\n**Visual Comparison**:\n\n```\nGCN:      All neighbors weighted equally (by degree normalization)\n          [Spot] ← (0.25, 0.25, 0.25, 0.25) ← [4 neighbors]\n\nGraphSAGE: Sample subset, aggregate with mean/max\n          [Spot] ← sample 2 → mean([n1, n2])\n\nGAT:      Learn attention per edge\n          [Spot] ← (α₁=0.5, α₂=0.3, α₃=0.15, α₄=0.05) ← [4 neighbors]\n                    ↑ Learned weights\n```\n\n---\n\n## Graph Construction Strategies\n\n**Critical insight**: Graph topology often matters more than the GNN architecture.\n\n### 1. Spatial Proximity Graphs\n\n#### k-Nearest Neighbors (kNN)\n\nConnect each spot to its `k` closest spatial neighbors.\n\n```python\nimport numpy as np\nfrom sklearn.neighbors import NearestNeighbors\nimport torch\n\ndef knn_graph(coords, k=6):\n    \"\"\"\n    Build kNN graph from spatial coordinates.\n\n    Args:\n        coords: [N, 2] array of (x, y) positions\n        k: number of neighbors\n    Returns:\n        edge_index: [2, E] tensor in COO format\n    \"\"\"\n    nbrs = NearestNeighbors(n_neighbors=k+1, algorithm='kd_tree').fit(coords)\n    distances, indices = nbrs.kneighbors(coords)\n\n    # Exclude self (first neighbor)\n    src = np.repeat(np.arange(len(coords)), k)\n    dst = indices[:, 1:].reshape(-1)\n\n    # Make undirected\n    edge_index = np.stack([src, dst], axis=0)\n    edge_index = np.concatenate([edge_index, edge_index[::-1]], axis=1)\n    edge_index = np.unique(edge_index, axis=1)\n\n    return torch.as_tensor(edge_index, dtype=torch.long)\n```\n\n**Pros**: Simple, controllable density\n**Cons**: Fixed `k` ignores tissue density variation\n\n**Effect of `k` on smoothing**:\n- **Small `k` (4-6)**: Preserves sharp boundaries, less smoothing\n- **Large `k` (12-20)**: More smoothing, boundaries blur, risk of over-smoothing\n\n#### Radius (ε-ball) Graph\n\nConnect all spots within distance `ε`.\n\n```python\ndef radius_graph(coords, radius=100.0):\n    \"\"\"\n    Build radius graph: connect nodes within distance threshold.\n    \"\"\"\n    from sklearn.neighbors import radius_neighbors_graph\n    A = radius_neighbors_graph(coords, radius, mode='connectivity')\n    edge_index = torch.as_tensor(np.array(A.nonzero()), dtype=torch.long)\n    return edge_index\n```\n\n**Pros**: Density-adaptive, physically meaningful\n**Cons**: Can create disconnected components if `ε` too small\n\n#### Delaunay Triangulation\n\nBuild triangles connecting nearest points without overlap—preserves natural geometry.\n\n```python\nfrom scipy.spatial import Delaunay\nimport numpy as np\n\ndef delaunay_graph(coords):\n    \"\"\"\n    Build graph from Delaunay triangulation.\n    Used in SpaGCN for natural spatial connectivity.\n    \"\"\"\n    tri = Delaunay(coords)\n    edges = set()\n    for simplex in tri.simplices:\n        for i in range(3):\n            edge = tuple(sorted([simplex[i], simplex[(i+1)%3]]))\n            edges.add(edge)\n\n    edges = np.array(list(edges)).T\n    # Make undirected\n    edge_index = np.concatenate([edges, edges[::-1]], axis=1)\n    return torch.as_tensor(edge_index, dtype=torch.long)\n```\n\n**Pros**: Natural geometric structure, used in SpaGCN\n**Cons**: Can create long edges in sparse regions\n\n---\n\n### 2. Expression Similarity Graphs\n\nConnect spots with similar gene expression, independent of distance.\n\n```python\ndef expression_similarity_graph(X, k=10, metric='cosine'):\n    \"\"\"\n    Build kNN graph in expression space.\n\n    Args:\n        X: [N, genes] expression matrix\n        k: number of neighbors\n        metric: 'cosine' or 'euclidean'\n    \"\"\"\n    from sklearn.neighbors import NearestNeighbors\n    nbrs = NearestNeighbors(n_neighbors=k+1, metric=metric).fit(X)\n    distances, indices = nbrs.kneighbors(X)\n\n    src = np.repeat(np.arange(len(X)), k)\n    dst = indices[:, 1:].reshape(-1)\n    edge_index = np.stack([src, dst], axis=0)\n\n    # Undirected\n    edge_index = np.concatenate([edge_index, edge_index[::-1]], axis=1)\n    edge_index = np.unique(edge_index, axis=1)\n\n    return torch.as_tensor(edge_index, dtype=torch.long)\n```\n\n**Pros**: Captures functional/molecular similarity\n**Cons**: May connect distant regions; ignores spatial structure\n\n---\n\n### 3. Hybrid (Multi-view) Graphs\n\nCombine spatial and expression information.\n\n**Weighted combination**:\n\n$$\n\\mathbf{A} = \\alpha \\cdot \\mathbf{A}_{\\text{spatial}} + (1 - \\alpha) \\cdot \\mathbf{A}_{\\text{expression}}\n$$\n\n**Learnable weighting**:\n\n```python\nclass MultiViewGNN(nn.Module):\n    def __init__(self, in_channels, out_channels):\n        super().__init__()\n        self.gcn_spatial = GCNLayer(in_channels, out_channels)\n        self.gcn_expression = GCNLayer(in_channels, out_channels)\n        self.alpha = nn.Parameter(torch.tensor(0.5))  # Learnable weight\n\n    def forward(self, x, edge_index_spatial, edge_index_expr):\n        h_spatial = self.gcn_spatial(x, edge_index_spatial)\n        h_expr = self.gcn_expression(x, edge_index_expr)\n\n        alpha = torch.sigmoid(self.alpha)  # Ensure [0,1]\n        return alpha * h_spatial + (1 - alpha) * h_expr\n```\n\n**Used in**: STAGATE, conST, GraphST\n\n---\n\n### 4. Image-Based Graphs (Histology Integration)\n\nIf H&E images are available, use morphological similarity.\n\n```python\ndef image_weighted_graph(coords, image_features, k=6, alpha=0.5):\n    \"\"\"\n    Weighted graph combining spatial distance and image feature similarity.\n\n    Args:\n        coords: [N, 2] spatial positions\n        image_features: [N, D] CNN features from histology patches\n        alpha: weight between spatial and image (0=spatial only, 1=image only)\n    \"\"\"\n    from sklearn.neighbors import NearestNeighbors\n    from sklearn.metrics.pairwise import cosine_similarity\n\n    # Spatial kNN\n    nbrs_spatial = NearestNeighbors(n_neighbors=k+1).fit(coords)\n    dist_spatial, idx_spatial = nbrs_spatial.kneighbors(coords)\n\n    # Image similarity\n    img_sim = cosine_similarity(image_features)\n\n    edges = []\n    weights = []\n    for i in range(len(coords)):\n        for j_idx, j in enumerate(idx_spatial[i, 1:]):  # Skip self\n            spatial_sim = 1.0 / (1.0 + dist_spatial[i, j_idx+1])\n            image_sim_val = img_sim[i, j]\n\n            combined_weight = alpha * spatial_sim + (1 - alpha) * image_sim_val\n            edges.append([i, j])\n            weights.append(combined_weight)\n\n    edge_index = torch.tensor(edges, dtype=torch.long).T\n    edge_weight = torch.tensor(weights, dtype=torch.float)\n\n    return edge_index, edge_weight\n```\n\n**Used in**: SpaGCN, conST, MERGE\n\n---\n\n## State-of-the-Art Methods in Spatial Transcriptomics\n\n### Method Comparison Table\n\n| Method | Year | Graph Type | GNN Architecture | Key Innovation | Task |\n|--------|------|------------|------------------|----------------|------|\n| **SpaGCN** | 2021 | Spatial + histology weighted | GCN | Delaunay + image features, domain detection | Clustering, SVG detection |\n| **STAGATE** | 2022 | Spatial kNN | Graph Attention Autoencoder | Learned attention, autoencoder framework | Clustering, denoising, trajectory |\n| **SEDR** | 2021 | Spatial kNN | VGAE + deep autoencoder | Dual embedding (expression + spatial VGAE) | Clustering, embedding |\n| **GraphST** | 2023 | Multi-view (spatial + expr) | GCN + contrastive learning | Self-supervised contrastive, multi-sample integration | Clustering, deconvolution |\n| **STdGCN** | 2023 | Hybrid (spot + pseudo-spot) | GCN | Integrate scRNA reference via hybrid graph | Deconvolution |\n| **stAA** | 2024 | Spatial kNN | Adversarial VGAE | WGAN regularization on embeddings | Clustering |\n| **stMCDI** | 2024 | Spatial | GNN encoder in diffusion model | Diffusion-based imputation with GNN | Missing value imputation |\n| **MERGE** | 2023 | Hierarchical image patches | Multi-scale GNN | Image → gene prediction via hierarchical graph | Prediction from histology |\n\n---\n\n### Deep Dive: SpaGCN\n\n**Paper**: Hu et al., *Nature Methods* (2021)\n\n**Problem**: Identify spatial domains using both gene expression and tissue morphology.\n\n**Graph Construction**:\n1. Build Delaunay triangulation from spot coordinates\n2. Weight edges by combination of:\n   - Spatial distance\n   - Histology image similarity (compare H&E patches around each spot)\n\n$$\nw_{ij} = \\exp\\left(-\\frac{d_{\\text{spatial}}(i,j)^2}{2\\sigma_d^2}\\right) \\times \\exp\\left(-\\frac{d_{\\text{image}}(i,j)^2}{2\\sigma_i^2}\\right)\n$$\n\n**GNN**: Standard GCN with weighted adjacency\n\n**Loss**: Combines:\n- Clustering loss (Louvain or k-means on embeddings)\n- Spatial regularization (neighbors should have similar cluster assignments)\n\n**Code Sketch**:\n\n```python\n# Weighted adjacency from spatial + image\nA_weighted = spatial_weight * image_weight\n\n# GCN embedding\nH = gcn_layers(X, A_weighted)\n\n# Clustering\nclusters = louvain_clustering(H)\n\n# Find spatially variable genes per domain\nsvg_genes = differential_expression_per_domain(clusters)\n```\n\n**Strengths**: Multi-modal, interpretable, works well on Visium data\n**Limitations**: Static graph, sensitive to weighting hyperparameters\n\n---\n\n### Deep Dive: STAGATE\n\n**Paper**: Dong & Chen, *Nature Communications* (2022)\n\n**Problem**: Learn representations robust to noise, preserve spatial structure, enable downstream tasks (clustering, pseudotime).\n\n**Architecture**: Graph Attention Autoencoder\n- **Encoder**: Multi-layer GAT → latent embedding `Z`\n- **Decoder**: Reconstruct both expression `X` and adjacency `A`\n\n**Key Innovation**: Attention mechanism learns which neighbors are relevant, mitigating over-smoothing.\n\n**Loss**:\n\n$$\n\\mathcal{L} = \\mathcal{L}_{\\text{recon}}(\\mathbf{X}, \\hat{\\mathbf{X}}) + \\lambda \\cdot \\mathcal{L}_{\\text{graph}}(\\mathbf{A}, \\hat{\\mathbf{A}})\n$$\n\nWhere:\n- $\\mathcal{L}_{\\text{recon}}$ = MSE for expression reconstruction\n- $\\mathcal{L}_{\\text{graph}}$ = binary cross-entropy for adjacency reconstruction\n\n**Code Outline**:\n\n```python\nclass STAGATE(nn.Module):\n    def __init__(self, n_genes, hidden_dim, latent_dim):\n        super().__init__()\n        self.encoder = nn.ModuleList([\n            GATLayer(n_genes, hidden_dim),\n            GATLayer(hidden_dim, latent_dim)\n        ])\n        self.decoder_expr = nn.Linear(latent_dim, n_genes)\n        self.decoder_graph = InnerProductDecoder()\n\n    def forward(self, x, edge_index):\n        # Encode\n        h = x\n        for layer in self.encoder:\n            h = F.elu(layer(h, edge_index))\n\n        # Decode\n        x_recon = self.decoder_expr(h)\n        adj_recon = torch.sigmoid(h @ h.T)  # Inner product for adjacency\n\n        return x_recon, adj_recon, h\n```\n\n**Strengths**: Adaptive smoothing, rich embeddings for multiple tasks\n**Limitations**: More hyperparameters, potential overfitting on small datasets\n\n---\n\n### Deep Dive: GraphST (Contrastive Learning)\n\n**Paper**: Long et al., *Nature Communications* (2023)\n\n**Problem**: Integrate multiple tissue sections, perform clustering and deconvolution.\n\n**Key Idea**: Self-supervised contrastive learning on graph embeddings.\n\n**Method**:\n1. Build two views of the same graph (e.g., different augmentations or spatial vs. expression graphs)\n2. Encode both with GCN\n3. Contrastive loss: pull together embeddings from same spot, push apart different spots\n\n$$\n\\mathcal{L}_{\\text{contrast}} = -\\log\\frac{\\exp(\\text{sim}(z_i, z_i^+) / \\tau)}{\\sum_j \\exp(\\text{sim}(z_i, z_j) / \\tau)}\n$$\n\nWhere $z_i^+$ is the augmented view of spot $i$.\n\n**Benefits**:\n- Learns robust representations without labeled data\n- Aligns multiple slides in shared embedding space\n\n**Code Sketch**:\n\n```python\n# Create two views\nedge_index_view1 = knn_graph(coords, k=6)\nedge_index_view2 = expression_similarity_graph(X, k=10)\n\n# Encode both\nz1 = gnn_encoder(X, edge_index_view1)\nz2 = gnn_encoder(X, edge_index_view2)\n\n# Contrastive loss (InfoNCE)\nloss = contrastive_loss(z1, z2, temperature=0.5)\n```\n\n---\n\n## Implementation Guide\n\n### Complete Pipeline: Spatial Domain Detection\n\nHere's a complete, runnable pipeline from raw Visium data to domain detection using a GNN.\n\n#### Step 1: Load Data\n\n```python\nimport scanpy as sc\nimport numpy as np\nimport torch\nfrom sklearn.preprocessing import StandardScaler\n\n# Load Visium data (standard scanpy format)\nadata = sc.read_visium(\"path/to/visium/data\")\n\n# Extract coordinates and expression\ncoords = adata.obsm['spatial']  # [N, 2]\nX = adata.X.toarray() if hasattr(adata.X, 'toarray') else adata.X  # [N, genes]\n\n# Highly variable genes\nsc.pp.highly_variable_genes(adata, n_top_genes=2000)\nX = X[:, adata.var['highly_variable']]\n\n# Normalize\nX = StandardScaler().fit_transform(X)\n\n# To tensors\nX_tensor = torch.tensor(X, dtype=torch.float32)\ncoords_np = np.array(coords)\n```\n\n#### Step 2: Build Graph\n\n```python\nfrom sklearn.neighbors import NearestNeighbors\n\ndef build_spatial_graph(coords, k=6):\n    nbrs = NearestNeighbors(n_neighbors=k+1).fit(coords)\n    _, indices = nbrs.kneighbors(coords)\n\n    src = np.repeat(np.arange(len(coords)), k)\n    dst = indices[:, 1:].reshape(-1)\n    edge_index = np.stack([src, dst], axis=0)\n\n    # Undirected\n    edge_index = np.concatenate([edge_index, edge_index[::-1]], axis=1)\n    edge_index = np.unique(edge_index, axis=1)\n\n    return torch.tensor(edge_index, dtype=torch.long)\n\nedge_index = build_spatial_graph(coords_np, k=6)\n```\n\n#### Step 3: Define Model\n\n```python\nclass SpatialGNN(nn.Module):\n    def __init__(self, n_genes, hidden_dim=128, latent_dim=32, n_clusters=7):\n        super().__init__()\n        self.encoder = nn.ModuleList([\n            GCNLayer(n_genes, hidden_dim),\n            GCNLayer(hidden_dim, latent_dim)\n        ])\n        self.cluster_head = nn.Linear(latent_dim, n_clusters)\n\n    def forward(self, x, edge_index):\n        h = x\n        for layer in self.encoder:\n            h = layer(h, edge_index)\n            h = F.relu(h)\n            h = F.dropout(h, p=0.3, training=self.training)\n\n        logits = self.cluster_head(h)\n        return h, logits\n\nmodel = SpatialGNN(n_genes=X.shape[1], n_clusters=7)\noptimizer = torch.optim.Adam(model.parameters(), lr=0.001)\n```\n\n#### Step 4: Training Loop\n\n```python\nfrom sklearn.cluster import KMeans\n\ndef train_epoch(model, x, edge_index, optimizer):\n    model.train()\n    optimizer.zero_grad()\n\n    # Forward\n    embeddings, logits = model(x, edge_index)\n\n    # Pseudo-labels from k-means (self-supervised)\n    with torch.no_grad():\n        kmeans = KMeans(n_clusters=7, random_state=42)\n        pseudo_labels = kmeans.fit_predict(embeddings.cpu().numpy())\n        pseudo_labels = torch.tensor(pseudo_labels, dtype=torch.long)\n\n    # Cross-entropy loss\n    loss = F.cross_entropy(logits, pseudo_labels)\n\n    loss.backward()\n    optimizer.step()\n\n    return loss.item()\n\n# Train\nfor epoch in range(100):\n    loss = train_epoch(model, X_tensor, edge_index, optimizer)\n    if epoch % 10 == 0:\n        print(f\"Epoch {epoch}, Loss: {loss:.4f}\")\n```\n\n#### Step 5: Extract Clusters and Visualize\n\n```python\nmodel.eval()\nwith torch.no_grad():\n    embeddings, logits = model(X_tensor, edge_index)\n    clusters = logits.argmax(dim=1).cpu().numpy()\n\n# Add to adata\nadata.obs['gnn_cluster'] = clusters\n\n# Visualize on tissue\nimport scanpy as sc\nsc.pl.spatial(adata, color='gnn_cluster', spot_size=150)\n```\n\n---\n\n## Practical Considerations\n\n### 1. Over-smoothing Problem\n\n**Issue**: With many GNN layers, all node features converge to the same value.\n\n**Why**: Each layer mixes neighbors' features, leading to exponential diffusion.\n\n**Solutions**:\n- **Limit layers**: 2-3 layers often enough for ST (tissue neighborhoods are local)\n- **Skip connections**: Add residual connections\n\n  ```python\n  h_new = gcn_layer(h) + h  # Residual\n  ```\n\n- **Adaptive depth** (DropEdge, PairNorm): Randomly drop edges or normalize layer outputs\n\n**Rule of thumb for ST**:\n- Small tissue sections: 2 layers\n- Whole-slide: 3-4 layers max\n- Multi-sample integration: Consider global pooling instead of deeper GNN\n\n---\n\n### 2. Choosing Hyperparameter k (Number of Neighbors)\n\n**Trade-off**:\n- **Low k (4-6)**: Sharp boundaries, less smoothing, more noise sensitivity\n- **High k (12-20)**: Smoother, more stable, but blurs boundaries\n\n**Guideline**:\n- **Delaunay**: Natural choice, typically $k \\approx 6$\n- **Brain cortex / layered tissue**: Lower k to preserve layers\n- **Tumor heterogeneity**: Mid-range k (6-8)\n- **Dense spot arrays (Visium HD)**: Higher k (10-15)\n\n**Experiment**: Try $k \\in \\{4, 6, 8, 10, 12\\}$ and check:\n- Silhouette score on clusters\n- Agreement with known anatomical regions\n\n---\n\n### 3. Normalization and Preprocessing\n\n**Critical steps**:\n\n1. **Gene selection**: Use highly variable genes (1000-3000)\n2. **Expression normalization**: Log1p + standard scaling\n3. **Graph normalization**: Symmetric $\\tilde{\\mathbf{D}}^{-1/2} \\tilde{\\mathbf{A}} \\tilde{\\mathbf{D}}^{-1/2}$ (built into GCN)\n4. **Feature scaling**: StandardScaler before training\n\n```python\nimport scanpy as sc\nfrom sklearn.preprocessing import StandardScaler\n\n# Standard pipeline\nsc.pp.normalize_total(adata, target_sum=1e4)\nsc.pp.log1p(adata)\nsc.pp.highly_variable_genes(adata, n_top_genes=2000)\nadata = adata[:, adata.var.highly_variable]\n\nX = StandardScaler().fit_transform(adata.X.toarray())\n```\n\n---\n\n### 4. Evaluation Metrics\n\nFor **clustering**:\n- **Adjusted Rand Index (ARI)**: Compare with ground-truth annotations\n- **Normalized Mutual Information (NMI)**\n- **Silhouette score**: Cluster separation in embedding space\n\nFor **deconvolution**:\n- **RMSE** vs. known proportions (if synthetic data)\n- **Correlation** with reference cell-type markers\n\nFor **imputation**:\n- **RMSE** on held-out genes\n- **Pearson correlation** with ground truth\n\n```python\nfrom sklearn.metrics import adjusted_rand_score, silhouette_score\n\n# Clustering evaluation\nari = adjusted_rand_score(true_labels, predicted_clusters)\nsilhouette = silhouette_score(embeddings, predicted_clusters)\n\nprint(f\"ARI: {ari:.3f}, Silhouette: {silhouette:.3f}\")\n```\n\n---\n\n### 5. Common Pitfalls\n\n| Problem | Symptom | Solution |\n|---------|---------|----------|\n| **Over-smoothing** | All embeddings identical | Reduce layers, add skip connections |\n| **Disconnected graph** | NaN in training | Check graph connectivity, increase k or $\\varepsilon$ |\n| **Unstable GAT** | Loss spikes | Lower learning rate, increase dropout on attention |\n| **Poor clustering** | Random assignments | Better graph construction, tune k, check normalization |\n| **High memory** | OOM errors | Use mini-batching (GraphSAGE), neighbor sampling |\n\n---\n\n## Advanced Topics\n\n### 1. Hypergraph Neural Networks\n\n**Standard GNN**: Pairwise edges (connects 2 nodes)\n**Hypergraph**: Hyperedges connect $\\geq 2$ nodes simultaneously\n\n**Use case in ST**: Group of spots in a tissue domain share a hyperedge\n\n**Example**: [Hypergraph Neural Networks Reveal Spatial Domains](https://arxiv.org/abs/2401.12001)\n\n### 2. Hierarchical and Multi-Scale Graphs\n\n**Idea**: Build graphs at multiple resolutions\n- Fine-scale: spot-to-spot\n- Coarse-scale: domain-to-domain (via clustering)\n\n**Benefits**: Capture both local and global patterns\n\n**Example**: MERGE builds hierarchical image patch graphs\n\n### 3. Graph Transformers\n\nReplace message-passing with full self-attention over all nodes.\n\n**Pros**: No over-smoothing, long-range dependencies\n**Cons**: $\\mathcal{O}(N^2)$ complexity\n\n**Emerging work**: Graphormer, GraphGPS\n\n---\n\n## Resources and Next Steps\n\n### Papers (Recommended Reading Order)\n\n1. **GNN Foundations**:\n   - Kipf & Welling (2017): [Semi-Supervised Classification with GCNs](https://arxiv.org/abs/1609.02907)\n   - Hamilton et al. (2017): [GraphSAGE](https://arxiv.org/abs/1706.02216)\n   - Veličković et al. (2018): [Graph Attention Networks](https://arxiv.org/abs/1710.10903)\n\n2. **ST Applications**:\n   - SpaGCN: [Nature Methods 2021](https://www.nature.com/articles/s41592-021-01255-8)\n   - STAGATE: [Nature Communications 2022](https://www.nature.com/articles/s41467-022-29439-6)\n   - GraphST: [Nature Communications 2023](https://www.nature.com/articles/s41467-023-36796-3)\n\n3. **Advanced**:\n   - [Stanford CS224W course notes](http://web.stanford.edu/class/cs224w/)\n   - [Graph Representation Learning Book](https://www.cs.mcgill.ca/~wlh/grl_book/) (Hamilton)\n\n### Code Repositories\n\n- **PyTorch Geometric**: [https://pytorch-geometric.readthedocs.io/](https://pytorch-geometric.readthedocs.io/)\n- **DGL (Deep Graph Library)**: [https://www.dgl.ai/](https://www.dgl.ai/)\n- **STAGATE**: [https://github.com/zhanglabtools/STAGATE](https://github.com/zhanglabtools/STAGATE)\n- **GraphST**: [https://github.com/JinmiaoChenLab/GraphST](https://github.com/JinmiaoChenLab/GraphST)\n\n### Practice Projects\n\n1. **Reproduce SpaGCN** on a public Visium dataset (e.g., mouse brain)\n2. **Compare GCN vs. GAT** on your own ST data—measure ARI, runtime, smoothness\n3. **Build a hybrid graph** (spatial + expression) and tune the weighting parameter $\\alpha$\n4. **Implement contrastive learning** for multi-sample integration\n\n---\n\n## Conclusion\n\nGraph Neural Networks provide a powerful, principled framework for spatial transcriptomics analysis by:\n\n- **Respecting spatial structure** through graph topology\n- **Learning adaptive representations** via message passing\n- **Integrating multi-modal data** (expression, coordinates, images)\n- **Scaling to large datasets** with sampling and mini-batching\n\nThe key to success is:\n1. **Graph construction**: Choose topology that reflects your biology\n2. **Architecture selection**: Match model complexity to data size and task\n3. **Regularization**: Prevent over-smoothing and overfitting\n4. **Evaluation**: Use domain-relevant metrics and biological validation\n\nAs spatial omics technologies advance (Visium HD, Xenium, CosMx), GNNs will remain essential tools for discovering tissue organization, cell-cell interactions, and disease mechanisms.\n\n---\n\n**Happy graph learning!**\n",
      "code": "var Component=(()=>{var m=Object.create;var i=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty;var N=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports),u=(l,e)=>{for(var s in e)i(l,s,{get:e[s],enumerable:!0})},c=(l,e,s,r)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let a of y(e))!E.call(l,a)&&a!==s&&i(l,a,{get:()=>e[a],enumerable:!(r=p(e,a))||r.enumerable});return l};var F=(l,e,s)=>(s=l!=null?m(g(l)):{},c(e||!l||!l.__esModule?i(s,\"default\",{value:l,enumerable:!0}):s,l)),v=l=>c(i({},\"__esModule\",{value:!0}),l);var h=N((w,t)=>{t.exports=_jsx_runtime});var b={};u(b,{default:()=>o,frontmatter:()=>f});var n=F(h()),f={title:\"Graph Neural Networks for Spatial Transcriptomics\",summary:\"A comprehensive guide to understanding and applying GNNs to spatial transcriptomics data, from foundational concepts to cutting-edge research implementations\",status:\"completed\",role:\"Research & Implementation\",stack:[\"PyTorch\",\"PyTorch Geometric\",\"Python\",\"Graph Neural Networks\",\"Spatial Transcriptomics\"],repoUrl:\"https://github.com/yourusername/gnn-spatial-transcriptomics\",tags:[\"deep learning\",\"bioinformatics\",\"graph neural networks\",\"spatial transcriptomics\",\"computational biology\"],featured:!0,startDate:\"2025-08-15\"};function d(l){let e={a:\"a\",annotation:\"annotation\",code:\"code\",em:\"em\",figure:\"figure\",h1:\"h1\",h2:\"h2\",h3:\"h3\",h4:\"h4\",hr:\"hr\",li:\"li\",math:\"math\",mfrac:\"mfrac\",mi:\"mi\",mn:\"mn\",mo:\"mo\",mover:\"mover\",mrow:\"mrow\",mspace:\"mspace\",msub:\"msub\",msubsup:\"msubsup\",msup:\"msup\",mtext:\"mtext\",munder:\"munder\",munderover:\"munderover\",ol:\"ol\",p:\"p\",path:\"path\",pre:\"pre\",semantics:\"semantics\",span:\"span\",strong:\"strong\",svg:\"svg\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...l.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"graph-neural-networks-for-spatial-transcriptomics\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#graph-neural-networks-for-spatial-transcriptomics\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Graph Neural Networks for Spatial Transcriptomics\"]}),`\n`,(0,n.jsx)(e.p,{children:\"A deep dive into applying Graph Neural Networks (GNNs) to spatial transcriptomics research, bridging deep learning theory with cutting-edge biological applications.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"table-of-contents\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#table-of-contents\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Table of Contents\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#introduction\",children:\"Introduction\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#from-cnns-to-gnns\",children:\"From CNNs to GNNs\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#core-gnn-architectures\",children:\"Core GNN Architectures\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#graph-construction-strategies\",children:\"Graph Construction Strategies\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#state-of-the-art-methods\",children:\"State-of-the-Art Methods in Spatial Transcriptomics\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#implementation-guide\",children:\"Implementation Guide\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#practical-considerations\",children:\"Practical Considerations\"})}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"introduction\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#introduction\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Introduction\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Spatial transcriptomics (ST) captures gene expression while preserving the physical location of cells in tissue. This spatial context creates a natural graph structure where:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Nodes\"}),\" = spots/cells with gene expression vectors\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Edges\"}),\" = spatial proximity or molecular similarity\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Task\"}),\" = identify tissue domains, cell types, or spatial patterns\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Graph Neural Networks provide a powerful framework to leverage this structure, enabling message-passing that respects both spatial topology and molecular relationships.\"}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"from-cnns-to-gnns\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#from-cnns-to-gnns\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"From CNNs to GNNs\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"why-cnns-cant-handle-irregular-grids\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#why-cnns-cant-handle-irregular-grids\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Why CNNs Can't Handle Irregular Grids\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Convolutional Neural Networks excel at structured data (images) because:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Local connectivity\"}),\": Each pixel has a fixed neighborhood (e.g., 3\\xD73)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Weight sharing\"}),\": The same filter slides across all positions, making parameter efficient\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Translation invariance\"}),\": Patterns learned anywhere apply everywhere\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"The convolution operation at pixel \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"(i,j)\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]}),\" is:\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"y\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.munderover,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"a\"}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"})]}),(0,n.jsx)(e.mn,{children:\"1\"})]}),(0,n.jsxs)(e.munderover,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"b\"}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"})]}),(0,n.jsx)(e.mn,{children:\"1\"})]}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"w\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"a\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"b\"})]})]}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"x\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mi,{children:\"a\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mi,{children:\"b\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"y_{i,j} = \\\\sum_{a=-1}^{1} \\\\sum_{b=-1}^{1} w_{a,b} \\\\cdot x_{i+a, j+b}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7167em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"y\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})]})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"3.1616em\",verticalAlign:\"-1.3604em\"}}),(0,n.jsx)(e.span,{className:\"mop op-limits\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.8011em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-1.8829em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,n.jsx)(e.span,{className:\"mrel mtight\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-4.3em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.3254em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mop op-limits\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.8011em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-1.8479em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"mrel mtight\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-4.3em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.3604em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02691em\"},children:\"w\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0269em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,n.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"b\"})]})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7167em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,n.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"b\"})]})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"The problem for spatial transcriptomics\"}),\": Spots are irregularly spaced and often have varying numbers of neighbors. We can't use a fixed 3\\xD73 kernel.\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"message-passing-the-key-insight\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#message-passing-the-key-insight\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Message Passing: The Key Insight\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"GNNs generalize convolution to \",(0,n.jsx)(e.strong,{children:\"arbitrary graph structures\"}),\" through message passing:\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:\"W\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsx)(e.mtext,{children:\"AGGREGATE\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"{\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\":\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"N\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"}\"}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"h_i^{(l+1)} = \\\\sigma\\\\left(W^{(l)} \\\\cdot \\\\text{AGGREGATE}\\\\{h_j^{(l)} : j \\\\in \\\\mathcal{N}(i)\\\\}\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.3217em\",verticalAlign:\"-0.2769em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.8em\",verticalAlign:\"-0.65em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\"(\"})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"W\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.938em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"AGGREGATE\"})}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"{\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.413em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\":\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mord mathcal\",style:{marginRight:\"0.14736em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")}\"}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\")\"})})]})]})]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Where:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"h_i^{(l)}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.3217em\",verticalAlign:\"-0.2769em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),\" = feature vector of node \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"i\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"i\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6595em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"})]})})]}),\" at layer \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"l\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"l\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.01968em\"},children:\"l\"})]})})]})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"N\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{N}(i)\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mord mathcal\",style:{marginRight:\"0.14736em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]}),\" = neighbors of node \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"i\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"i\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6595em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"})]})})]})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:\"W\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"W^{(l)}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.888em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"W\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.888em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})})})})})]})]})})]}),\" = learnable weight matrix\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"\\u03C3\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\sigma\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"})]})})]}),\" = activation function (ReLU, etc.)\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"This is conceptually similar to CNN convolution, but:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Neighbors are defined by \",(0,n.jsx)(e.strong,{children:\"edges\"}),\", not spatial proximity on a grid\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Each node can have a \",(0,n.jsx)(e.strong,{children:\"variable number\"}),\" of neighbors\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Weights are \",(0,n.jsx)(e.strong,{children:\"shared across all nodes\"}),\", just like CNN filters\"]}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"core-gnn-architectures\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#core-gnn-architectures\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Core GNN Architectures\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"1-graph-convolutional-network-gcn\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#1-graph-convolutional-network-gcn\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"1. Graph Convolutional Network (GCN)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Paper\"}),\": Kipf & Welling (2017)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Core Idea\"}),\": Normalize neighbor aggregation by degree to prevent scale issues.\"]}),`\n`,(0,n.jsxs)(e.h4,{id:\"mathematical-formulation\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#mathematical-formulation\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Mathematical Formulation\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Given:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"X\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"R\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"N\"}),(0,n.jsx)(e.mo,{children:\"\\xD7\"}),(0,n.jsx)(e.mi,{children:\"F\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbf{X} \\\\in \\\\mathbb{R}^{N \\\\times F}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7252em\",verticalAlign:\"-0.0391em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"X\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.8413em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbb\",children:\"R\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.10903em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"\\xD7\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.13889em\"},children:\"F\"})]})})]})})})})})]})]})]})]}),\": node features (N spots, F genes)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"R\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"N\"}),(0,n.jsx)(e.mo,{children:\"\\xD7\"}),(0,n.jsx)(e.mi,{children:\"N\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbf{A} \\\\in \\\\mathbb{R}^{N \\\\times N}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7252em\",verticalAlign:\"-0.0391em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.8413em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbb\",children:\"R\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.10903em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"\\xD7\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.10903em\"},children:\"N\"})]})})]})})})})})]})]})]})]}),\": adjacency matrix\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbf{D}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6861em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]})})]}),\": degree matrix (diagonal, where \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"D\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"i\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsx)(e.mi,{children:\"j\"})]}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"A\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"D_{ii} = \\\\sum_j A_{ij}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"ii\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.1858em\",verticalAlign:\"-0.4358em\"}}),(0,n.jsxs)(e.span,{className:\"mop\",children:[(0,n.jsx)(e.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.162em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.4358em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]}),\")\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Add self-loops and normalize:\"}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"I\"}),(0,n.jsx)(e.mspace,{width:\"1em\"}),(0,n.jsx)(e.mtext,{children:\"(add\\xA0self-connections)\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\tilde{\\\\mathbf{A}} = \\\\mathbf{A} + \\\\mathbf{I} \\\\quad \\\\text{(add self-connections)}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.923em\"}}),(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1111em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7694em\",verticalAlign:\"-0.0833em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"I\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"(add\\xA0self-connections)\"})})]})]})]})}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"i\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.munder,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsx)(e.mi,{children:\"j\"})]}),(0,n.jsxs)(e.msub,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{children:\"A\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mspace,{width:\"1em\"}),(0,n.jsx)(e.mtext,{children:\"(recompute\\xA0degrees)\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\tilde{D}_{ii} = \\\\sum_j \\\\tilde{A}_{ij} \\\\quad \\\\text{(recompute degrees)}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.0702em\",verticalAlign:\"-0.15em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.9202em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6023em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"ii\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"2.4638em\",verticalAlign:\"-1.4138em\"}}),(0,n.jsx)(e.span,{className:\"mop op-limits\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-1.8723em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.4138em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.9202em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"A\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6023em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1111em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"(recompute\\xA0degrees)\"})})]})]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"The GCN layer performs symmetric normalization:\"}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"H\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]}),(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.msup,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"H\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"W\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbf{H}^{(l+1)} = \\\\sigma\\\\left(\\\\tilde{\\\\mathbf{D}}^{-1/2} \\\\tilde{\\\\mathbf{A}} \\\\tilde{\\\\mathbf{D}}^{-1/2} \\\\mathbf{H}^{(l)} \\\\mathbf{W}^{(l)}\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.938em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.938em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.8em\",verticalAlign:\"-0.65em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\"(\"})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.938em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1/2\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1111em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.938em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1/2\"})]})})]})})})})})]}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.938em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})})})})})]}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",style:{marginRight:\"0.01597em\"},children:\"W\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.938em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\")\"})})]})]})]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Intuition\"}),\": The symmetric normalization \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msup,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]}),(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.msup,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\tilde{\\\\mathbf{D}}^{-1/2} \\\\tilde{\\\\mathbf{A}} \\\\tilde{\\\\mathbf{D}}^{-1/2}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.923em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.888em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1/2\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1111em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.888em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1/2\"})]})})]})})})})})]})]})})]}),\" creates a normalized adjacency that averages features fairly across neighbors, preventing high-degree nodes from dominating.\"]}),`\n`,(0,n.jsxs)(e.h4,{id:\"pytorch-implementation-matrix-form\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#pytorch-implementation-matrix-form\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"PyTorch Implementation (Matrix Form)\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" normalize_adj\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(edge_index, num_nodes):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Build symmetric normalized adjacency: D^{-1/2} A D^{-1/2}\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Returns sparse tensor indices and values.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    i, j \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" edge_index\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Add self-loops\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    self_loops \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.arange(num_nodes, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"device\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"edge_index.device)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.cat([i, self_loops])\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    j \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.cat([j, self_loops])\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Compute degree\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    deg \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.bincount(j, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"minlength\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"num_nodes).float()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    deg_inv_sqrt \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" deg.clamp(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"min\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").pow(\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Symmetric normalization weights\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    vals \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" deg_inv_sqrt[i] \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" deg_inv_sqrt[j]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.stack([i, j], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"), vals\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" GCNLayer\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Graph Convolutional Layer with sparse adjacency multiply.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, out_channels, bias\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"True\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".lin \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(in_channels, out_channels, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"bias\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"bias)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        N \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x.size(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        idx, vals \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" normalize_adj(edge_index, N)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        A_norm \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.sparse_coo_tensor(idx, vals, (N, N), \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"device\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"x.device)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".lin(x)                    \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [N, F_out]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.sparse.mm(A_norm, x)     \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Sparse matrix multiply\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.relu(x)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Full GCN Model\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" GCN\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, hidden_channels, out_channels, num_layers\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(GCNLayer(in_channels, hidden_channels))\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" _ \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(num_layers \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 2\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"            self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(GCNLayer(hidden_channels, hidden_channels))\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(GCNLayer(hidden_channels, out_channels))\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i, layer \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" enumerate\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers[:\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" layer(x, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.relu(x)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.dropout(x, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"p\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"train\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers[\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"](x, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Strengths\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Simple, efficient, mathematically principled\"}),`\n`,(0,n.jsx)(e.li,{children:\"Fast on small-to-medium graphs\"}),`\n`,(0,n.jsx)(e.li,{children:\"Smooth aggregation good for homogeneous tissue\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Weaknesses\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Fixed (isotropic) weights\\u2014all neighbors treated equally\"}),`\n`,(0,n.jsx)(e.li,{children:\"Transductive (needs full graph at training)\"}),`\n`,(0,n.jsx)(e.li,{children:\"Over-smoothing with many layers\"}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"2-graphsage\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#2-graphsage\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"2. GraphSAGE\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Paper\"}),\": Hamilton et al. (2017)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Core Idea\"}),\": Sample neighbors and use robust aggregators (mean, LSTM, max-pool) to scale to large graphs and enable \",(0,n.jsx)(e.strong,{children:\"inductive learning\"}),\" (generalize to unseen nodes/graphs).\"]}),`\n`,(0,n.jsxs)(e.h4,{id:\"update-rule\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#update-rule\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Update Rule\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"W\"}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsx)(e.mtext,{children:\"CONCAT\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"[\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mtext,{children:\"AGG\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"{\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\":\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"N\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"}\"}),(0,n.jsx)(e.mo,{fence:\"true\",children:\"]\"})]}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"h_i^{(l+1)} = \\\\sigma\\\\left(\\\\mathbf{W} \\\\cdot \\\\text{CONCAT}\\\\left[h_i^{(l)}, \\\\text{AGG}\\\\{h_j^{(l)} : j \\\\in \\\\mathcal{N}(i)\\\\}\\\\right]\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.3217em\",verticalAlign:\"-0.2769em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.8em\",verticalAlign:\"-0.65em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\"(\"})}),(0,n.jsx)(e.span,{className:\"mord mathbf\",style:{marginRight:\"0.01597em\"},children:\"W\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"CONCAT\"})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\"[\"})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"AGG\"})}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"{\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.413em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\":\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mord mathcal\",style:{marginRight:\"0.14736em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")}\"}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\"]\"})})]}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\")\"})})]})]})]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Key differences from GCN:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Concatenate\"}),\" self-feature with aggregated neighbors (preserves identity)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Sample\"}),\" a fixed number of neighbors (e.g., 10) instead of using all\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Aggregator\"}),\" choices: mean, max-pool, LSTM\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h4,{id:\"pytorch-implementation\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#pytorch-implementation\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"PyTorch Implementation\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn.functional \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" SAGEConv\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    GraphSAGE layer with mean aggregation.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, out_channels, normalize\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"True\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".lin_self \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(in_channels, out_channels)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".lin_neigh \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(in_channels, out_channels)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".normalize \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" normalize\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index, num_neighbors_sample\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        N \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x.size(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Sample neighbors (for scalability)\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        src, dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" edge_index\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Group by destination\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {}\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" s, d \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" zip\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(src.tolist(), dst.tolist()):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            neighbors.setdefault(d, []).append(s)\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Sample and aggregate\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        neigh_features \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" []\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(N):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"            if\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"and\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" len\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(neighbors[i]) \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\">\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                sampled \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                    neighbors[i][:num_neighbors_sample],\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"                    device\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"x.device\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                )\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                neigh_features.append(x[sampled].mean(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"))\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"            else\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                neigh_features.append(torch.zeros(x.size(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"), \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"device\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"x.device))\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        neigh_agg \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.stack(neigh_features)  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [N, F]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Combine self and neighbor\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        out \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".lin_self(x) \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".lin_neigh(neigh_agg)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        if\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".normalize:\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            out \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.normalize(out, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"p\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" out\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" GraphSAGE\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, hidden_channels, out_channels, num_layers\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(SAGEConv(in_channels, hidden_channels))\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" _ \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(num_layers \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 2\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"            self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(SAGEConv(hidden_channels, hidden_channels))\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(SAGEConv(hidden_channels, out_channels))\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" layer \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers[:\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]:\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" layer(x, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.relu(x)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.dropout(x, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"p\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"training\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers[\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"](x, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Strengths\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Scales to massive graphs via neighbor sampling\"}),`\n`,(0,n.jsx)(e.li,{children:\"Inductive: can generalize to new slides without retraining\"}),`\n`,(0,n.jsx)(e.li,{children:\"Multiple aggregator options\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Weaknesses\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Sampling introduces variance\"}),`\n`,(0,n.jsx)(e.li,{children:\"More hyperparameters (sample size per layer)\"}),`\n`,(0,n.jsx)(e.li,{children:\"Still treats all sampled neighbors equally\"}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"3-graph-attention-network-gat\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#3-graph-attention-network-gat\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3. Graph Attention Network (GAT)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Paper\"}),\": Veli\\u010Dkovi\\u0107 et al. (2018)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Core Idea\"}),\": Learn \",(0,n.jsx)(e.strong,{children:\"per-edge attention weights\"}),\" so the model can focus on important neighbors and ignore noisy ones.\"]}),`\n`,(0,n.jsxs)(e.h4,{id:\"attention-mechanism\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#attention-mechanism\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Attention Mechanism\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"For each edge \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"(i, j)\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]}),\":\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"e\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mtext,{children:\"LeakyReLU\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"a\"}),(0,n.jsx)(e.mi,{children:\"T\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"[\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"W\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"})]}),(0,n.jsx)(e.mtext,{children:\"\\u2009\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,n.jsx)(e.mtext,{children:\"\\u2009\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"W\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"j\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"]\"}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"e_{ij} = \\\\text{LeakyReLU}\\\\left(\\\\mathbf{a}^T [\\\\mathbf{W} h_i \\\\,||\\\\, \\\\mathbf{W} h_j]\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7167em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"e\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.2413em\",verticalAlign:\"-0.35em\"}}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"LeakyReLU\"})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size1\",children:\"(\"})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"a\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8913em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.13889em\"},children:\"T\"})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"mord mathbf\",style:{marginRight:\"0.01597em\"},children:\"W\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"\\u2223\\u2223\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",style:{marginRight:\"0.01597em\"},children:\"W\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size1\",children:\")\"})})]})]})]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Normalize with softmax over all neighbors:\"}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"\\u03B1\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"exp\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"e\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.munder,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"k\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"N\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mi,{children:\"exp\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"e\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"k\"})]})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\alpha_{ij} = \\\\frac{\\\\exp(e_{ij})}{\\\\sum_{k \\\\in \\\\mathcal{N}(i)} \\\\exp(e_{ik})}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7167em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0037em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"2.5877em\",verticalAlign:\"-1.1607em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mopen nulldelimiter\"}),(0,n.jsx)(e.span,{className:\"mfrac\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.427em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.314em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsxs)(e.span,{className:\"mop\",children:[(0,n.jsx)(e.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2253em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"}),(0,n.jsx)(e.span,{className:\"mrel mtight\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mord mathcal mtight\",style:{marginRight:\"0.14736em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.4747em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"e\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"ik\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.23em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.677em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"e\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.1607em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mclose nulldelimiter\"})]})]})]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Aggregate with learned weights:\"}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsxs)(e.munder,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"N\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"\\u03B1\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"W\"}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"h_i^{(l+1)} = \\\\sigma\\\\left(\\\\sum_{j \\\\in \\\\mathcal{N}(i)} \\\\alpha_{ij} \\\\cdot \\\\mathbf{W} \\\\cdot h_j^{(l)}\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.3217em\",verticalAlign:\"-0.2769em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"3.6em\",verticalAlign:\"-1.55em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen\",children:(0,n.jsx)(e.span,{className:\"delimsizing mult\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"2.05em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-4.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"5.6em\"}}),(0,n.jsx)(e.span,{style:{width:\"0.875em\",height:\"3.600em\"},children:(0,n.jsx)(e.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"0.875em\",height:\"3.600em\",viewBox:\"0 0 875 3600\",children:(0,n.jsx)(e.path,{d:`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1\nc-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,\n-36,557 l0,84c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,\n949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9\nc0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,\n-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189\nl0,-92c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,\n-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.55em\"},children:(0,n.jsx)(e.span,{})})})]})})}),(0,n.jsx)(e.span,{className:\"mop op-limits\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-1.809em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mrel mtight\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mord mathcal mtight\",style:{marginRight:\"0.14736em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.516em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0037em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",style:{marginRight:\"0.01597em\"},children:\"W\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.413em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:(0,n.jsx)(e.span,{className:\"delimsizing mult\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"2.05em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-4.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"5.6em\"}}),(0,n.jsx)(e.span,{style:{width:\"0.875em\",height:\"3.600em\"},children:(0,n.jsx)(e.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"0.875em\",height:\"3.600em\",viewBox:\"0 0 875 3600\",children:(0,n.jsx)(e.path,{d:`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,\n63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5\nc11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,9\nc-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664\nc-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11\nc0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17\nc242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558\nl0,-144c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,\n-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.55em\"},children:(0,n.jsx)(e.span,{})})})]})})})]})]})]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Multi-head attention\"}),\" (like Transformers): Run \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"K\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"K\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"K\"})]})})]}),\" independent attention heads and concatenate:\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mo,{fence:\"false\",stretchy:\"true\",minsize:\"1.8em\",maxsize:\"1.8em\",children:\"\\u2223\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mo,{fence:\"false\",stretchy:\"true\",minsize:\"1.8em\",maxsize:\"1.8em\",children:\"\\u2223\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"k\"}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mn,{children:\"1\"})]}),(0,n.jsx)(e.mi,{children:\"K\"})]}),(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsxs)(e.munder,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"N\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"\\u03B1\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]}),(0,n.jsx)(e.mi,{children:\"k\"})]}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"W\"}),(0,n.jsx)(e.mi,{children:\"k\"})]}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"h_i^{(l+1)} = \\\\Big|\\\\Big|_{k=1}^K \\\\sigma\\\\left(\\\\sum_{j \\\\in \\\\mathcal{N}(i)} \\\\alpha_{ij}^k \\\\cdot \\\\mathbf{W}^k \\\\cdot h_j^{(l)}\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.3217em\",verticalAlign:\"-0.2769em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"3.6em\",verticalAlign:\"-1.55em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:(0,n.jsx)(e.span,{className:\"delimsizing mult\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.15em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.15em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.8em\"}}),(0,n.jsx)(e.span,{style:{width:\"0.333em\",height:\"1.800em\"},children:(0,n.jsx)(e.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"0.333em\",height:\"1.800em\",viewBox:\"0 0 333 1800\",children:(0,n.jsx)(e.path,{d:`M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z`})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.65em\"},children:(0,n.jsx)(e.span,{})})})]})})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\",children:(0,n.jsx)(e.span,{className:\"delimsizing mult\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.15em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.15em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.8em\"}}),(0,n.jsx)(e.span,{style:{width:\"0.333em\",height:\"1.800em\"},children:(0,n.jsx)(e.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"0.333em\",height:\"1.800em\",viewBox:\"0 0 333 1800\",children:(0,n.jsx)(e.path,{d:`M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z`})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.65em\"},children:(0,n.jsx)(e.span,{})})})]})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.3812em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.0003em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"}),(0,n.jsx)(e.span,{className:\"mrel mtight\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6029em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.07153em\"},children:\"K\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.6997em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen\",children:(0,n.jsx)(e.span,{className:\"delimsizing mult\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"2.05em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-4.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"5.6em\"}}),(0,n.jsx)(e.span,{style:{width:\"0.875em\",height:\"3.600em\"},children:(0,n.jsx)(e.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"0.875em\",height:\"3.600em\",viewBox:\"0 0 875 3600\",children:(0,n.jsx)(e.path,{d:`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1\nc-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,\n-36,557 l0,84c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,\n949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9\nc0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,\n-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189\nl0,-92c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,\n-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.55em\"},children:(0,n.jsx)(e.span,{})})})]})})}),(0,n.jsx)(e.span,{className:\"mop op-limits\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-1.809em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mrel mtight\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mord mathcal mtight\",style:{marginRight:\"0.14736em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.516em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.453em\",marginLeft:\"-0.0037em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3831em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",style:{marginRight:\"0.01597em\"},children:\"W\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.413em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:(0,n.jsx)(e.span,{className:\"delimsizing mult\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"2.05em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-4.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"5.6em\"}}),(0,n.jsx)(e.span,{style:{width:\"0.875em\",height:\"3.600em\"},children:(0,n.jsx)(e.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"0.875em\",height:\"3.600em\",viewBox:\"0 0 875 3600\",children:(0,n.jsx)(e.path,{d:`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,\n63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5\nc11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,9\nc-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664\nc-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11\nc0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17\nc242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558\nl0,-144c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,\n-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.55em\"},children:(0,n.jsx)(e.span,{})})})]})})})]})]})]})]})}),`\n`,(0,n.jsxs)(e.h4,{id:\"pytorch-implementation-1\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#pytorch-implementation-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"PyTorch Implementation\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn.functional \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" GATLayer\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Graph Attention Layer (single head).\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, out_channels, dropout\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", alpha\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.2\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".W \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(in_channels, out_channels, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"bias\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"False\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".a \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Parameter(torch.zeros(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"size\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" *\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" out_channels, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")))\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".leakyrelu \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.LeakyReLU(alpha)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".dropout \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" dropout\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        nn.init.xavier_uniform_(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".a.data, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"gain\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1.414\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Linear transformation\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        Wh \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".W(x)  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [N, out_channels]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        N \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Wh.size(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Compute attention coefficients\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        src, dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" edge_index\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Concatenate source and destination features\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        Wh_src \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Wh[src]  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [E, out_channels]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        Wh_dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Wh[dst]  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [E, out_channels]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        concat_features \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.cat([Wh_src, Wh_dst], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [E, 2*out_channels]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Attention mechanism\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        e \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".leakyrelu(concat_features \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"@\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".a).squeeze()  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [E]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Normalize per destination node\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        attention \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.zeros(N, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"device\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"x.device)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        attention_weights \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.zeros_like(e)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(N):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            mask \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"==\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"            if\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" mask.sum() \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\">\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                e_neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" e[mask]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                alpha \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.softmax(e_neighbors, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                attention_weights[mask] \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" alpha\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Apply dropout to attention\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        attention_weights \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.dropout(attention_weights, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".dropout, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"training\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Aggregate\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        out \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.zeros_like(Wh)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(N):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            mask \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"==\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"            if\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" mask.sum() \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\">\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                out[i] \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (attention_weights[mask].unsqueeze(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Wh[src[mask]]).sum(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" out\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" GAT\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, hidden_channels, out_channels,\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                 num_heads\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"8\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", dropout\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".dropout \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" dropout\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Multi-head first layer\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".attentions \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList([\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            GATLayer(in_channels, hidden_channels, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dropout\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"dropout)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"            for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" _ \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(num_heads)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        ])\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Single-head output layer\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".out_att \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" GATLayer(\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            hidden_channels \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" num_heads,\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            out_channels,\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"            dropout\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"dropout\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        )\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # First layer: concatenate multi-head outputs\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.cat([att(x, edge_index) \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" att \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".attentions], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.dropout(x, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".dropout, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"training\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.elu(x)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Output layer\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".out_att(x, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Strengths\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Learns which neighbors are important (anisotropic)\"}),`\n`,(0,n.jsx)(e.li,{children:\"Better at handling heterogeneous neighborhoods\"}),`\n`,(0,n.jsx)(e.li,{children:\"Respects sharp boundaries (e.g., tumor-stroma)\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Weaknesses\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"More parameters (attention + multi-heads)\"}),`\n`,(0,n.jsx)(e.li,{children:\"Slower than GCN\"}),`\n`,(0,n.jsx)(e.li,{children:\"Can be unstable (needs careful tuning of dropout, LR)\"}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"architecture-comparison-table\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#architecture-comparison-table\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Architecture Comparison Table\"]}),`\n`,(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:\"Model\"}),(0,n.jsx)(e.th,{children:\"Neighbor Weights\"}),(0,n.jsx)(e.th,{children:\"Sampling\"}),(0,n.jsx)(e.th,{children:\"Inductive?\"}),(0,n.jsx)(e.th,{children:\"Best Use Case\"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"GCN\"})}),(0,n.jsx)(e.td,{children:\"Fixed by normalized adjacency\"}),(0,n.jsx)(e.td,{children:\"Full graph (no sampling)\"}),(0,n.jsx)(e.td,{children:\"No (transductive)\"}),(0,n.jsx)(e.td,{children:\"Smooth tissue, clean spatial graphs, small-medium datasets\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"GraphSAGE\"})}),(0,n.jsx)(e.td,{children:\"Fixed aggregator (mean/max/LSTM)\"}),(0,n.jsx)(e.td,{children:\"Neighborhood sampling\"}),(0,n.jsx)(e.td,{children:\"Yes\"}),(0,n.jsx)(e.td,{children:\"Large graphs, multiple slides, production systems\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"GAT\"})}),(0,n.jsx)(e.td,{children:\"Learned per-edge attention\"}),(0,n.jsx)(e.td,{children:\"Full neighborhood (or can sample)\"}),(0,n.jsx)(e.td,{children:\"Often yes\"}),(0,n.jsx)(e.td,{children:\"Heterogeneous tissue, sharp boundaries, variable neighbor quality\"})]})]})]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Visual Comparison\"}),\":\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`GCN:      All neighbors weighted equally (by degree normalization)\n          [Spot] \\u2190 (0.25, 0.25, 0.25, 0.25) \\u2190 [4 neighbors]\n\nGraphSAGE: Sample subset, aggregate with mean/max\n          [Spot] \\u2190 sample 2 \\u2192 mean([n1, n2])\n\nGAT:      Learn attention per edge\n          [Spot] \\u2190 (\\u03B1\\u2081=0.5, \\u03B1\\u2082=0.3, \\u03B1\\u2083=0.15, \\u03B1\\u2084=0.05) \\u2190 [4 neighbors]\n                    \\u2191 Learned weights\n`})}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"graph-construction-strategies\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#graph-construction-strategies\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Graph Construction Strategies\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Critical insight\"}),\": Graph topology often matters more than the GNN architecture.\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"1-spatial-proximity-graphs\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#1-spatial-proximity-graphs\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"1. Spatial Proximity Graphs\"]}),`\n`,(0,n.jsxs)(e.h4,{id:\"k-nearest-neighbors-knn\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#k-nearest-neighbors-knn\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"k-Nearest Neighbors (kNN)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Connect each spot to its \",(0,n.jsx)(e.code,{children:\"k\"}),\" closest spatial neighbors.\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" numpy \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" knn_graph\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords, k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Build kNN graph from spatial coordinates.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Args:\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        coords: [N, 2] array of (x, y) positions\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        k: number of neighbors\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Returns:\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        edge_index: [2, E] tensor in COO format\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    nbrs \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_neighbors\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"algorithm\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'kd_tree'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").fit(coords)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    distances, indices \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nbrs.kneighbors(coords)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Exclude self (first neighbor)\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    src \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.repeat(np.arange(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"len\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords)), k)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" indices[:, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":].reshape(\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Make undirected\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.stack([src, dst], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.concatenate([edge_index, edge_index[::\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.unique(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.as_tensor(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Pros\"}),`: Simple, controllable density\n`,(0,n.jsx)(e.strong,{children:\"Cons\"}),\": Fixed \",(0,n.jsx)(e.code,{children:\"k\"}),\" ignores tissue density variation\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsxs)(e.strong,{children:[\"Effect of \",(0,n.jsx)(e.code,{children:\"k\"}),\" on smoothing\"]}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.strong,{children:[\"Small \",(0,n.jsx)(e.code,{children:\"k\"}),\" (4-6)\"]}),\": Preserves sharp boundaries, less smoothing\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.strong,{children:[\"Large \",(0,n.jsx)(e.code,{children:\"k\"}),\" (12-20)\"]}),\": More smoothing, boundaries blur, risk of over-smoothing\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h4,{id:\"radius-\\u03B5-ball-graph\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#radius-\\u03B5-ball-graph\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Radius (\\u03B5-ball) Graph\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Connect all spots within distance \",(0,n.jsx)(e.code,{children:\"\\u03B5\"}),\".\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" radius_graph\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords, radius\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"100.0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Build radius graph: connect nodes within distance threshold.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" radius_neighbors_graph\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    A \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" radius_neighbors_graph(coords, radius, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"mode\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'connectivity'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.as_tensor(np.array(A.nonzero()), \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" edge_index\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Pros\"}),`: Density-adaptive, physically meaningful\n`,(0,n.jsx)(e.strong,{children:\"Cons\"}),\": Can create disconnected components if \",(0,n.jsx)(e.code,{children:\"\\u03B5\"}),\" too small\"]}),`\n`,(0,n.jsxs)(e.h4,{id:\"delaunay-triangulation\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#delaunay-triangulation\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Delaunay Triangulation\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Build triangles connecting nearest points without overlap\\u2014preserves natural geometry.\"}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" scipy.spatial \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Delaunay\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" numpy \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" delaunay_graph\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Build graph from Delaunay triangulation.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Used in SpaGCN for natural spatial connectivity.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    tri \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Delaunay(coords)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edges \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" set\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" simplex \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" tri.simplices:\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"3\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            edge \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" tuple\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"sorted\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"([simplex[i], simplex[(i\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"%\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"3\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]]))\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            edges.add(edge)\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edges \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.array(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"list\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(edges)).T\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Make undirected\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.concatenate([edges, edges[::\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.as_tensor(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Pros\"}),`: Natural geometric structure, used in SpaGCN\n`,(0,n.jsx)(e.strong,{children:\"Cons\"}),\": Can create long edges in sparse regions\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"2-expression-similarity-graphs\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#2-expression-similarity-graphs\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"2. Expression Similarity Graphs\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Connect spots with similar gene expression, independent of distance.\"}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" expression_similarity_graph\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(X, k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", metric\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'cosine'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Build kNN graph in expression space.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Args:\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        X: [N, genes] expression matrix\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        k: number of neighbors\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        metric: 'cosine' or 'euclidean'\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    nbrs \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_neighbors\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"metric\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"metric).fit(X)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    distances, indices \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nbrs.kneighbors(X)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    src \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.repeat(np.arange(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"len\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(X)), k)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" indices[:, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":].reshape(\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.stack([src, dst], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Undirected\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.concatenate([edge_index, edge_index[::\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.unique(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.as_tensor(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Pros\"}),`: Captures functional/molecular similarity\n`,(0,n.jsx)(e.strong,{children:\"Cons\"}),\": May connect distant regions; ignores spatial structure\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"3-hybrid-multi-view-graphs\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#3-hybrid-multi-view-graphs\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3. Hybrid (Multi-view) Graphs\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Combine spatial and expression information.\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Weighted combination\"}),\":\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{children:\"\\u03B1\"}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mtext,{children:\"spatial\"})]}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mi,{children:\"\\u03B1\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mtext,{children:\"expression\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbf{A} = \\\\alpha \\\\cdot \\\\mathbf{A}_{\\\\text{spatial}} + (1 - \\\\alpha) \\\\cdot \\\\mathbf{A}_{\\\\text{expression}}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6861em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.4445em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.9722em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"spatial\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.9722em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3175em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"expression\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Learnable weighting\"}),\":\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" MultiViewGNN\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, out_channels):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".gcn_spatial \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" GCNLayer(in_channels, out_channels)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".gcn_expression \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" GCNLayer(in_channels, out_channels)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".alpha \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Parameter(torch.tensor(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"))  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Learnable weight\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index_spatial, edge_index_expr):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        h_spatial \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".gcn_spatial(x, edge_index_spatial)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        h_expr \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".gcn_expression(x, edge_index_expr)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        alpha \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.sigmoid(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".alpha)  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Ensure [0,1]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" alpha \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" h_spatial \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" -\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" alpha) \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" h_expr\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Used in\"}),\": STAGATE, conST, GraphST\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"4-image-based-graphs-histology-integration\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#4-image-based-graphs-histology-integration\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"4. Image-Based Graphs (Histology Integration)\"]}),`\n`,(0,n.jsx)(e.p,{children:\"If H&E images are available, use morphological similarity.\"}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" image_weighted_graph\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords, image_features, k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", alpha\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Weighted graph combining spatial distance and image feature similarity.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Args:\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        coords: [N, 2] spatial positions\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        image_features: [N, D] CNN features from histology patches\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        alpha: weight between spatial and image (0=spatial only, 1=image only)\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.metrics.pairwise \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" cosine_similarity\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Spatial kNN\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    nbrs_spatial \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_neighbors\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").fit(coords)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    dist_spatial, idx_spatial \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nbrs_spatial.kneighbors(coords)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Image similarity\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    img_sim \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" cosine_similarity(image_features)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edges \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" []\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    weights \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" []\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"len\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords)):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" j_idx, j \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" enumerate\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(idx_spatial[i, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":]):  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Skip self\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            spatial_sim \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 1.0\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" /\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1.0\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" +\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" dist_spatial[i, j_idx\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"])\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            image_sim_val \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" img_sim[i, j]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            combined_weight \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" alpha \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" spatial_sim \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" -\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" alpha) \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" image_sim_val\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            edges.append([i, j])\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            weights.append(combined_weight)\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(edges, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long).T\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_weight \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(weights, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.float)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" edge_index, edge_weight\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Used in\"}),\": SpaGCN, conST, MERGE\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"state-of-the-art-methods-in-spatial-transcriptomics\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#state-of-the-art-methods-in-spatial-transcriptomics\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"State-of-the-Art Methods in Spatial Transcriptomics\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"method-comparison-table\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#method-comparison-table\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Method Comparison Table\"]}),`\n`,(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:\"Method\"}),(0,n.jsx)(e.th,{children:\"Year\"}),(0,n.jsx)(e.th,{children:\"Graph Type\"}),(0,n.jsx)(e.th,{children:\"GNN Architecture\"}),(0,n.jsx)(e.th,{children:\"Key Innovation\"}),(0,n.jsx)(e.th,{children:\"Task\"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"SpaGCN\"})}),(0,n.jsx)(e.td,{children:\"2021\"}),(0,n.jsx)(e.td,{children:\"Spatial + histology weighted\"}),(0,n.jsx)(e.td,{children:\"GCN\"}),(0,n.jsx)(e.td,{children:\"Delaunay + image features, domain detection\"}),(0,n.jsx)(e.td,{children:\"Clustering, SVG detection\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"STAGATE\"})}),(0,n.jsx)(e.td,{children:\"2022\"}),(0,n.jsx)(e.td,{children:\"Spatial kNN\"}),(0,n.jsx)(e.td,{children:\"Graph Attention Autoencoder\"}),(0,n.jsx)(e.td,{children:\"Learned attention, autoencoder framework\"}),(0,n.jsx)(e.td,{children:\"Clustering, denoising, trajectory\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"SEDR\"})}),(0,n.jsx)(e.td,{children:\"2021\"}),(0,n.jsx)(e.td,{children:\"Spatial kNN\"}),(0,n.jsx)(e.td,{children:\"VGAE + deep autoencoder\"}),(0,n.jsx)(e.td,{children:\"Dual embedding (expression + spatial VGAE)\"}),(0,n.jsx)(e.td,{children:\"Clustering, embedding\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"GraphST\"})}),(0,n.jsx)(e.td,{children:\"2023\"}),(0,n.jsx)(e.td,{children:\"Multi-view (spatial + expr)\"}),(0,n.jsx)(e.td,{children:\"GCN + contrastive learning\"}),(0,n.jsx)(e.td,{children:\"Self-supervised contrastive, multi-sample integration\"}),(0,n.jsx)(e.td,{children:\"Clustering, deconvolution\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"STdGCN\"})}),(0,n.jsx)(e.td,{children:\"2023\"}),(0,n.jsx)(e.td,{children:\"Hybrid (spot + pseudo-spot)\"}),(0,n.jsx)(e.td,{children:\"GCN\"}),(0,n.jsx)(e.td,{children:\"Integrate scRNA reference via hybrid graph\"}),(0,n.jsx)(e.td,{children:\"Deconvolution\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"stAA\"})}),(0,n.jsx)(e.td,{children:\"2024\"}),(0,n.jsx)(e.td,{children:\"Spatial kNN\"}),(0,n.jsx)(e.td,{children:\"Adversarial VGAE\"}),(0,n.jsx)(e.td,{children:\"WGAN regularization on embeddings\"}),(0,n.jsx)(e.td,{children:\"Clustering\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"stMCDI\"})}),(0,n.jsx)(e.td,{children:\"2024\"}),(0,n.jsx)(e.td,{children:\"Spatial\"}),(0,n.jsx)(e.td,{children:\"GNN encoder in diffusion model\"}),(0,n.jsx)(e.td,{children:\"Diffusion-based imputation with GNN\"}),(0,n.jsx)(e.td,{children:\"Missing value imputation\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"MERGE\"})}),(0,n.jsx)(e.td,{children:\"2023\"}),(0,n.jsx)(e.td,{children:\"Hierarchical image patches\"}),(0,n.jsx)(e.td,{children:\"Multi-scale GNN\"}),(0,n.jsx)(e.td,{children:\"Image \\u2192 gene prediction via hierarchical graph\"}),(0,n.jsx)(e.td,{children:\"Prediction from histology\"})]})]})]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"deep-dive-spagcn\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#deep-dive-spagcn\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Deep Dive: SpaGCN\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Paper\"}),\": Hu et al., \",(0,n.jsx)(e.em,{children:\"Nature Methods\"}),\" (2021)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Problem\"}),\": Identify spatial domains using both gene expression and tissue morphology.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Graph Construction\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Build Delaunay triangulation from spot coordinates\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"Weight edges by combination of:\",`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Spatial distance\"}),`\n`,(0,n.jsx)(e.li,{children:\"Histology image similarity (compare H&E patches around each spot)\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"w\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{children:\"exp\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"d\"}),(0,n.jsx)(e.mtext,{children:\"spatial\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mn,{children:\"2\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsx)(e.mi,{children:\"d\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]})]}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]}),(0,n.jsx)(e.mo,{children:\"\\xD7\"}),(0,n.jsx)(e.mi,{children:\"exp\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"d\"}),(0,n.jsx)(e.mtext,{children:\"image\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mn,{children:\"2\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]})]}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"w_{ij} = \\\\exp\\\\left(-\\\\frac{d_{\\\\text{spatial}}(i,j)^2}{2\\\\sigma_d^2}\\\\right) \\\\times \\\\exp\\\\left(-\\\\frac{d_{\\\\text{image}}(i,j)^2}{2\\\\sigma_i^2}\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7167em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02691em\"},children:\"w\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0269em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"2.4784em\",verticalAlign:\"-0.9873em\"}}),(0,n.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size3\",children:\"(\"})}),(0,n.jsx)(e.span,{className:\"mord\",children:\"\\u2212\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mopen nulldelimiter\"}),(0,n.jsx)(e.span,{className:\"mfrac\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.4911em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.314em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\",children:\"2\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.7959em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.3987em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"d\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.0448em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3013em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.23em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.677em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"d\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"spatial\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsxs)(e.span,{className:\"mclose\",children:[(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})})})})})]})]})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.9873em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mclose nulldelimiter\"})]}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size3\",children:\")\"})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\xD7\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"2.454em\",verticalAlign:\"-0.9629em\"}}),(0,n.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size3\",children:\"(\"})}),(0,n.jsx)(e.span,{className:\"mord\",children:\"\\u2212\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mopen nulldelimiter\"}),(0,n.jsx)(e.span,{className:\"mfrac\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.4911em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.314em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\",children:\"2\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.7959em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.0448em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.23em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.677em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"d\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3175em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"image\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsxs)(e.span,{className:\"mclose\",children:[(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})})})})})]})]})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.9629em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mclose nulldelimiter\"})]}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size3\",children:\")\"})})]})]})]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"GNN\"}),\": Standard GCN with weighted adjacency\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Loss\"}),\": Combines:\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Clustering loss (Louvain or k-means on embeddings)\"}),`\n`,(0,n.jsx)(e.li,{children:\"Spatial regularization (neighbors should have similar cluster assignments)\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Code Sketch\"}),\":\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Weighted adjacency from spatial + image\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"A_weighted \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" spatial_weight \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" image_weight\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# GCN embedding\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"H \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" gcn_layers(X, A_weighted)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Clustering\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"clusters \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" louvain_clustering(H)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Find spatially variable genes per domain\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"svg_genes \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" differential_expression_per_domain(clusters)\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Strengths\"}),`: Multi-modal, interpretable, works well on Visium data\n`,(0,n.jsx)(e.strong,{children:\"Limitations\"}),\": Static graph, sensitive to weighting hyperparameters\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"deep-dive-stagate\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#deep-dive-stagate\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Deep Dive: STAGATE\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Paper\"}),\": Dong & Chen, \",(0,n.jsx)(e.em,{children:\"Nature Communications\"}),\" (2022)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Problem\"}),\": Learn representations robust to noise, preserve spatial structure, enable downstream tasks (clustering, pseudotime).\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Architecture\"}),\": Graph Attention Autoencoder\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Encoder\"}),\": Multi-layer GAT \\u2192 latent embedding \",(0,n.jsx)(e.code,{children:\"Z\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Decoder\"}),\": Reconstruct both expression \",(0,n.jsx)(e.code,{children:\"X\"}),\" and adjacency \",(0,n.jsx)(e.code,{children:\"A\"})]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Key Innovation\"}),\": Attention mechanism learns which neighbors are relevant, mitigating over-smoothing.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Loss\"}),\":\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,n.jsx)(e.mtext,{children:\"recon\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"X\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"X\"}),(0,n.jsx)(e.mo,{children:\"^\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mi,{children:\"\\u03BB\"}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,n.jsx)(e.mtext,{children:\"graph\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"^\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{L} = \\\\mathcal{L}_{\\\\text{recon}}(\\\\mathbf{X}, \\\\hat{\\\\mathbf{X}}) + \\\\lambda \\\\cdot \\\\mathcal{L}_{\\\\text{graph}}(\\\\mathbf{A}, \\\\hat{\\\\mathbf{A}})\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,n.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.1995em\",verticalAlign:\"-0.25em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"recon\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"X\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.9495em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"X\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2551em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1667em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"^\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03BB\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.2357em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"graph\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.9495em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2551em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1111em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"^\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Where:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,n.jsx)(e.mtext,{children:\"recon\"})]})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{L}_{\\\\text{recon}}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"recon\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),\" = MSE for expression reconstruction\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,n.jsx)(e.mtext,{children:\"graph\"})]})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{L}_{\\\\text{graph}}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"graph\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),\" = binary cross-entropy for adjacency reconstruction\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Code Outline\"}),\":\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" STAGATE\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, n_genes, hidden_dim, latent_dim):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".encoder \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList([\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            GATLayer(n_genes, hidden_dim),\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            GATLayer(hidden_dim, latent_dim)\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        ])\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".decoder_expr \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(latent_dim, n_genes)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".decoder_graph \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" InnerProductDecoder()\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Encode\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" layer \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".encoder:\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.elu(layer(h, edge_index))\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Decode\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x_recon \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".decoder_expr(h)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        adj_recon \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.sigmoid(h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"@\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" h.T)  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Inner product for adjacency\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x_recon, adj_recon, h\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Strengths\"}),`: Adaptive smoothing, rich embeddings for multiple tasks\n`,(0,n.jsx)(e.strong,{children:\"Limitations\"}),\": More hyperparameters, potential overfitting on small datasets\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"deep-dive-graphst-contrastive-learning\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#deep-dive-graphst-contrastive-learning\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Deep Dive: GraphST (Contrastive Learning)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Paper\"}),\": Long et al., \",(0,n.jsx)(e.em,{children:\"Nature Communications\"}),\" (2023)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Problem\"}),\": Integrate multiple tissue sections, perform clustering and deconvolution.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Key Idea\"}),\": Self-supervised contrastive learning on graph embeddings.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Method\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Build two views of the same graph (e.g., different augmentations or spatial vs. expression graphs)\"}),`\n`,(0,n.jsx)(e.li,{children:\"Encode both with GCN\"}),`\n`,(0,n.jsx)(e.li,{children:\"Contrastive loss: pull together embeddings from same spot, push apart different spots\"}),`\n`]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,n.jsx)(e.mtext,{children:\"contrast\"})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mi,{children:\"log\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"exp\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mtext,{children:\"sim\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"z\"}),(0,n.jsx)(e.mi,{children:\"i\"})]}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"z\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{children:\"+\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mi,{children:\"\\u03C4\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.munder,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsx)(e.mi,{children:\"j\"})]}),(0,n.jsx)(e.mi,{children:\"exp\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mtext,{children:\"sim\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"z\"}),(0,n.jsx)(e.mi,{children:\"i\"})]}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"z\"}),(0,n.jsx)(e.mi,{children:\"j\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mi,{children:\"\\u03C4\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{L}_{\\\\text{contrast}} = -\\\\log\\\\frac{\\\\exp(\\\\text{sim}(z_i, z_i^+) / \\\\tau)}{\\\\sum_j \\\\exp(\\\\text{sim}(z_i, z_j) / \\\\tau)}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"contrast\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"2.6103em\",verticalAlign:\"-1.1218em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mop\",children:[\"lo\",(0,n.jsx)(e.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mopen nulldelimiter\"}),(0,n.jsx)(e.span,{className:\"mfrac\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.4885em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.314em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsxs)(e.span,{className:\"mop\",children:[(0,n.jsx)(e.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.162em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.4358em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"sim\"})}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,n.jsx)(e.span,{className:\"mord\",children:\"/\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.23em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.677em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"sim\"})}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.8115em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.1031em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,n.jsx)(e.span,{className:\"mord\",children:\"/\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.1218em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mclose nulldelimiter\"})]})]})]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Where \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"z\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{children:\"+\"})]})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"z_i^+\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.0883em\",verticalAlign:\"-0.2769em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.8115em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.1031em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),\" is the augmented view of spot \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"i\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"i\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6595em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"})]})})]}),\".\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Benefits\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Learns robust representations without labeled data\"}),`\n`,(0,n.jsx)(e.li,{children:\"Aligns multiple slides in shared embedding space\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Code Sketch\"}),\":\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Create two views\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"edge_index_view1 \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" knn_graph(coords, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"edge_index_view2 \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" expression_similarity_graph(X, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Encode both\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"z1 \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" gnn_encoder(X, edge_index_view1)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"z2 \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" gnn_encoder(X, edge_index_view2)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Contrastive loss (InfoNCE)\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"loss \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" contrastive_loss(z1, z2, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"temperature\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"implementation-guide\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#implementation-guide\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Implementation Guide\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"complete-pipeline-spatial-domain-detection\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#complete-pipeline-spatial-domain-detection\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Complete Pipeline: Spatial Domain Detection\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Here's a complete, runnable pipeline from raw Visium data to domain detection using a GNN.\"}),`\n`,(0,n.jsxs)(e.h4,{id:\"step-1-load-data\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#step-1-load-data\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 1: Load Data\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" scanpy \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sc\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" numpy \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.preprocessing \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" StandardScaler\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Load Visium data (standard scanpy format)\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"adata \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sc.read_visium(\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"path/to/visium/data\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Extract coordinates and expression\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"coords \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" adata.obsm[\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'spatial'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [N, 2]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"X \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" adata.X.toarray() \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"if\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" hasattr\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(adata.X, \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'toarray'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"else\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" adata.X  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [N, genes]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Highly variable genes\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"sc.pp.highly_variable_genes(adata, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_top_genes\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2000\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"X \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" X[:, adata.var[\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'highly_variable'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Normalize\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"X \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" StandardScaler().fit_transform(X)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# To tensors\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"X_tensor \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(X, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.float32)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"coords_np \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.array(coords)\"})]})]})})}),`\n`,(0,n.jsxs)(e.h4,{id:\"step-2-build-graph\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#step-2-build-graph\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 2: Build Graph\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" build_spatial_graph\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords, k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    nbrs \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_neighbors\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").fit(coords)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    _, indices \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nbrs.kneighbors(coords)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    src \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.repeat(np.arange(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"len\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords)), k)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" indices[:, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":].reshape(\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.stack([src, dst], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Undirected\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.concatenate([edge_index, edge_index[::\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.unique(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" build_spatial_graph(coords_np, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,n.jsxs)(e.h4,{id:\"step-3-define-model\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#step-3-define-model\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 3: Define Model\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" SpatialGNN\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, n_genes, hidden_dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"128\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", latent_dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"32\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", n_clusters\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"7\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".encoder \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList([\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            GCNLayer(n_genes, hidden_dim),\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            GCNLayer(hidden_dim, latent_dim)\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        ])\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".cluster_head \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(latent_dim, n_clusters)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" layer \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".encoder:\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" layer(h, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.relu(h)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.dropout(h, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"p\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.3\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"training\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        logits \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".cluster_head(h)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" h, logits\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"model \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" SpatialGNN(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_genes\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"X.shape[\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_clusters\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"7\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"optimizer \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.optim.Adam(model.parameters(), \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"lr\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.001\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,n.jsxs)(e.h4,{id:\"step-4-training-loop\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#step-4-training-loop\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 4: Training Loop\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.cluster \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" KMeans\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" train_epoch\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(model, x, edge_index, optimizer):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    model.train()\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    optimizer.zero_grad()\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Forward\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    embeddings, logits \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" model(x, edge_index)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Pseudo-labels from k-means (self-supervised)\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    with\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.no_grad():\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        kmeans \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" KMeans(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_clusters\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"7\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"random_state\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"42\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        pseudo_labels \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" kmeans.fit_predict(embeddings.cpu().numpy())\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        pseudo_labels \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(pseudo_labels, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Cross-entropy loss\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    loss \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.cross_entropy(logits, pseudo_labels)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    loss.backward()\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    optimizer.step()\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" loss.item()\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Train\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" epoch \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"100\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    loss \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" train_epoch(model, X_tensor, edge_index, optimizer)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" epoch \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"%\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 10\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" ==\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        print\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"f\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"Epoch '}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"epoch\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"}\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\", Loss: \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"loss\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\":.4f\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"}\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,n.jsxs)(e.h4,{id:\"step-5-extract-clusters-and-visualize\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#step-5-extract-clusters-and-visualize\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 5: Extract Clusters and Visualize\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"model.eval()\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"with\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.no_grad():\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    embeddings, logits \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" model(X_tensor, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    clusters \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" logits.argmax(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").cpu().numpy()\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Add to adata\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"adata.obs[\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'gnn_cluster'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" clusters\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Visualize on tissue\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" scanpy \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sc\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"sc.pl.spatial(adata, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"color\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'gnn_cluster'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"spot_size\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"150\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"practical-considerations\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#practical-considerations\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Practical Considerations\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"1-over-smoothing-problem\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#1-over-smoothing-problem\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"1. Over-smoothing Problem\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Issue\"}),\": With many GNN layers, all node features converge to the same value.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Why\"}),\": Each layer mixes neighbors' features, leading to exponential diffusion.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Solutions\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Limit layers\"}),\": 2-3 layers often enough for ST (tissue neighborhoods are local)\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Skip connections\"}),\": Add residual connections\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"h_new \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" gcn_layer(h) \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" h  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Residual\"})]})})})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Adaptive depth\"}),\" (DropEdge, PairNorm): Randomly drop edges or normalize layer outputs\"]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Rule of thumb for ST\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Small tissue sections: 2 layers\"}),`\n`,(0,n.jsx)(e.li,{children:\"Whole-slide: 3-4 layers max\"}),`\n`,(0,n.jsx)(e.li,{children:\"Multi-sample integration: Consider global pooling instead of deeper GNN\"}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"2-choosing-hyperparameter-k-number-of-neighbors\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#2-choosing-hyperparameter-k-number-of-neighbors\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"2. Choosing Hyperparameter k (Number of Neighbors)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Trade-off\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Low k (4-6)\"}),\": Sharp boundaries, less smoothing, more noise sensitivity\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"High k (12-20)\"}),\": Smoother, more stable, but blurs boundaries\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Guideline\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Delaunay\"}),\": Natural choice, typically \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"k\"}),(0,n.jsx)(e.mo,{children:\"\\u2248\"}),(0,n.jsx)(e.mn,{children:\"6\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"k \\\\approx 6\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03148em\"},children:\"k\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2248\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"6\"})]})]})]})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Brain cortex / layered tissue\"}),\": Lower k to preserve layers\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Tumor heterogeneity\"}),\": Mid-range k (6-8)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Dense spot arrays (Visium HD)\"}),\": Higher k (10-15)\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Experiment\"}),\": Try \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"k\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"{\"}),(0,n.jsx)(e.mn,{children:\"4\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mn,{children:\"6\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mn,{children:\"8\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mn,{children:\"10\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mn,{children:\"12\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"}\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"k \\\\in \\\\{4, 6, 8, 10, 12\\\\}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7335em\",verticalAlign:\"-0.0391em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03148em\"},children:\"k\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"mord\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"6\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"8\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"12\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\"}\"})]})]})]}),\" and check:\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Silhouette score on clusters\"}),`\n`,(0,n.jsx)(e.li,{children:\"Agreement with known anatomical regions\"}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"3-normalization-and-preprocessing\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#3-normalization-and-preprocessing\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3. Normalization and Preprocessing\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Critical steps\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Gene selection\"}),\": Use highly variable genes (1000-3000)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Expression normalization\"}),\": Log1p + standard scaling\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Graph normalization\"}),\": Symmetric \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msup,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]}),(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.msup,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\tilde{\\\\mathbf{D}}^{-1/2} \\\\tilde{\\\\mathbf{A}} \\\\tilde{\\\\mathbf{D}}^{-1/2}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.923em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.888em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1/2\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1111em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.888em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1/2\"})]})})]})})})})})]})]})})]}),\" (built into GCN)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Feature scaling\"}),\": StandardScaler before training\"]}),`\n`]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" scanpy \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sc\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.preprocessing \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" StandardScaler\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Standard pipeline\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"sc.pp.normalize_total(adata, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"target_sum\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1e4\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"sc.pp.log1p(adata)\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"sc.pp.highly_variable_genes(adata, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_top_genes\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2000\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"adata \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" adata[:, adata.var.highly_variable]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"X \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" StandardScaler().fit_transform(adata.X.toarray())\"})]})]})})}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"4-evaluation-metrics\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#4-evaluation-metrics\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"4. Evaluation Metrics\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"For \",(0,n.jsx)(e.strong,{children:\"clustering\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Adjusted Rand Index (ARI)\"}),\": Compare with ground-truth annotations\"]}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.strong,{children:\"Normalized Mutual Information (NMI)\"})}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Silhouette score\"}),\": Cluster separation in embedding space\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"For \",(0,n.jsx)(e.strong,{children:\"deconvolution\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"RMSE\"}),\" vs. known proportions (if synthetic data)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Correlation\"}),\" with reference cell-type markers\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"For \",(0,n.jsx)(e.strong,{children:\"imputation\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"RMSE\"}),\" on held-out genes\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Pearson correlation\"}),\" with ground truth\"]}),`\n`]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.metrics \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" adjusted_rand_score, silhouette_score\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Clustering evaluation\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"ari \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" adjusted_rand_score(true_labels, predicted_clusters)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"silhouette \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" silhouette_score(embeddings, predicted_clusters)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"print\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"f\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"ARI: '}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"ari\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\":.3f\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"}\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\", Silhouette: \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"silhouette\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\":.3f\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"}\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"5-common-pitfalls\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#5-common-pitfalls\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"5. Common Pitfalls\"]}),`\n`,(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:\"Problem\"}),(0,n.jsx)(e.th,{children:\"Symptom\"}),(0,n.jsx)(e.th,{children:\"Solution\"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"Over-smoothing\"})}),(0,n.jsx)(e.td,{children:\"All embeddings identical\"}),(0,n.jsx)(e.td,{children:\"Reduce layers, add skip connections\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"Disconnected graph\"})}),(0,n.jsx)(e.td,{children:\"NaN in training\"}),(0,n.jsxs)(e.td,{children:[\"Check graph connectivity, increase k or \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"\\u03B5\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\varepsilon\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03B5\"})]})})]})]})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"Unstable GAT\"})}),(0,n.jsx)(e.td,{children:\"Loss spikes\"}),(0,n.jsx)(e.td,{children:\"Lower learning rate, increase dropout on attention\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"Poor clustering\"})}),(0,n.jsx)(e.td,{children:\"Random assignments\"}),(0,n.jsx)(e.td,{children:\"Better graph construction, tune k, check normalization\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"High memory\"})}),(0,n.jsx)(e.td,{children:\"OOM errors\"}),(0,n.jsx)(e.td,{children:\"Use mini-batching (GraphSAGE), neighbor sampling\"})]})]})]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"advanced-topics\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#advanced-topics\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Advanced Topics\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"1-hypergraph-neural-networks\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#1-hypergraph-neural-networks\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"1. Hypergraph Neural Networks\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Standard GNN\"}),`: Pairwise edges (connects 2 nodes)\n`,(0,n.jsx)(e.strong,{children:\"Hypergraph\"}),\": Hyperedges connect \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2265\"}),(0,n.jsx)(e.mn,{children:\"2\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\geq 2\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7719em\",verticalAlign:\"-0.136em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2265\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"2\"})]})]})]}),\" nodes simultaneously\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Use case in ST\"}),\": Group of spots in a tissue domain share a hyperedge\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Example\"}),\": \",(0,n.jsx)(e.a,{href:\"https://arxiv.org/abs/2401.12001\",children:\"Hypergraph Neural Networks Reveal Spatial Domains\"})]}),`\n`,(0,n.jsxs)(e.h3,{id:\"2-hierarchical-and-multi-scale-graphs\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#2-hierarchical-and-multi-scale-graphs\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"2. Hierarchical and Multi-Scale Graphs\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Idea\"}),\": Build graphs at multiple resolutions\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Fine-scale: spot-to-spot\"}),`\n`,(0,n.jsx)(e.li,{children:\"Coarse-scale: domain-to-domain (via clustering)\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Benefits\"}),\": Capture both local and global patterns\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Example\"}),\": MERGE builds hierarchical image patch graphs\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"3-graph-transformers\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#3-graph-transformers\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3. Graph Transformers\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Replace message-passing with full self-attention over all nodes.\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Pros\"}),`: No over-smoothing, long-range dependencies\n`,(0,n.jsx)(e.strong,{children:\"Cons\"}),\": \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"O\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:\"N\"}),(0,n.jsx)(e.mn,{children:\"2\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{O}(N^2)\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.0641em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mord mathcal\",style:{marginRight:\"0.02778em\"},children:\"O\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10903em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]}),\" complexity\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Emerging work\"}),\": Graphormer, GraphGPS\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"resources-and-next-steps\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#resources-and-next-steps\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Resources and Next Steps\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"papers-recommended-reading-order\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#papers-recommended-reading-order\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Papers (Recommended Reading Order)\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"GNN Foundations\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Kipf & Welling (2017): \",(0,n.jsx)(e.a,{href:\"https://arxiv.org/abs/1609.02907\",children:\"Semi-Supervised Classification with GCNs\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Hamilton et al. (2017): \",(0,n.jsx)(e.a,{href:\"https://arxiv.org/abs/1706.02216\",children:\"GraphSAGE\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Veli\\u010Dkovi\\u0107 et al. (2018): \",(0,n.jsx)(e.a,{href:\"https://arxiv.org/abs/1710.10903\",children:\"Graph Attention Networks\"})]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"ST Applications\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"SpaGCN: \",(0,n.jsx)(e.a,{href:\"https://www.nature.com/articles/s41592-021-01255-8\",children:\"Nature Methods 2021\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"STAGATE: \",(0,n.jsx)(e.a,{href:\"https://www.nature.com/articles/s41467-022-29439-6\",children:\"Nature Communications 2022\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"GraphST: \",(0,n.jsx)(e.a,{href:\"https://www.nature.com/articles/s41467-023-36796-3\",children:\"Nature Communications 2023\"})]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Advanced\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"http://web.stanford.edu/class/cs224w/\",children:\"Stanford CS224W course notes\"})}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://www.cs.mcgill.ca/~wlh/grl_book/\",children:\"Graph Representation Learning Book\"}),\" (Hamilton)\"]}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.h3,{id:\"code-repositories\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#code-repositories\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Code Repositories\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"PyTorch Geometric\"}),\": \",(0,n.jsx)(e.a,{href:\"https://pytorch-geometric.readthedocs.io/\",children:\"https://pytorch-geometric.readthedocs.io/\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"DGL (Deep Graph Library)\"}),\": \",(0,n.jsx)(e.a,{href:\"https://www.dgl.ai/\",children:\"https://www.dgl.ai/\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"STAGATE\"}),\": \",(0,n.jsx)(e.a,{href:\"https://github.com/zhanglabtools/STAGATE\",children:\"https://github.com/zhanglabtools/STAGATE\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"GraphST\"}),\": \",(0,n.jsx)(e.a,{href:\"https://github.com/JinmiaoChenLab/GraphST\",children:\"https://github.com/JinmiaoChenLab/GraphST\"})]}),`\n`]}),`\n`,(0,n.jsxs)(e.h3,{id:\"practice-projects\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#practice-projects\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Practice Projects\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Reproduce SpaGCN\"}),\" on a public Visium dataset (e.g., mouse brain)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Compare GCN vs. GAT\"}),\" on your own ST data\\u2014measure ARI, runtime, smoothness\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Build a hybrid graph\"}),\" (spatial + expression) and tune the weighting parameter \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"\\u03B1\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\alpha\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"})]})})]})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Implement contrastive learning\"}),\" for multi-sample integration\"]}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"conclusion\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#conclusion\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Graph Neural Networks provide a powerful, principled framework for spatial transcriptomics analysis by:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Respecting spatial structure\"}),\" through graph topology\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Learning adaptive representations\"}),\" via message passing\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Integrating multi-modal data\"}),\" (expression, coordinates, images)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Scaling to large datasets\"}),\" with sampling and mini-batching\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"The key to success is:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Graph construction\"}),\": Choose topology that reflects your biology\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Architecture selection\"}),\": Match model complexity to data size and task\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Regularization\"}),\": Prevent over-smoothing and overfitting\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Evaluation\"}),\": Use domain-relevant metrics and biological validation\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"As spatial omics technologies advance (Visium HD, Xenium, CosMx), GNNs will remain essential tools for discovering tissue organization, cell-cell interactions, and disease mechanisms.\"}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:\"Happy graph learning!\"})})]})}function o(l={}){let{wrapper:e}=l.components||{};return e?(0,n.jsx)(e,{...l,children:(0,n.jsx)(d,{...l})}):d(l)}return v(b);})();\n;return Component;"
    },
    "_id": "projects/gnn-spatial-transcriptomics.mdx",
    "_raw": {
      "sourceFilePath": "projects/gnn-spatial-transcriptomics.mdx",
      "sourceFileName": "gnn-spatial-transcriptomics.mdx",
      "sourceFileDir": "projects",
      "contentType": "mdx",
      "flattenedPath": "projects/gnn-spatial-transcriptomics"
    },
    "type": "Project",
    "url": "/projects/gnn-spatial-transcriptomics",
    "slug": "gnn-spatial-transcriptomics"
  },
  {
    "title": "Personal Website Project",
    "summary": "A modern personal website with AI-powered content search and interactive knowledge graphs",
    "status": "in-progress",
    "role": "Full-stack Developer",
    "stack": [
      "Next.js",
      "TypeScript",
      "Tailwind CSS",
      "Supabase",
      "Contentlayer"
    ],
    "repoUrl": "https://github.com/sample/personal-website",
    "demoUrl": "https://sample-website.vercel.app",
    "images": [],
    "tags": [
      "web development",
      "AI",
      "full-stack"
    ],
    "featured": true,
    "startDate": "2025-08-27T00:00:00.000Z",
    "body": {
      "raw": "\n# Personal Website Project\n\nThis project showcases a modern approach to building personal academic websites with integrated AI capabilities.\n\n## Overview\n\nThe website features:\n- Git-based content management\n- AI-powered search and chat\n- Interactive knowledge graphs\n- Responsive design with dark mode\n\n## Technology Stack\n\n- **Frontend**: Next.js with App Router, React, TypeScript\n- **Styling**: Tailwind CSS, shadcn/ui components  \n- **Content**: MDX with Contentlayer for static generation\n- **Database**: Supabase with pgvector for embeddings\n- **Deployment**: Vercel for automatic deployments\n\n## Key Features\n\n### Content Management\n- Markdown/MDX files in Git for publications and projects\n- Automatic content indexing and embedding generation\n- Support for rich media including images, videos, and PDFs\n\n### AI Agent\n- Context-aware chat interface on every page\n- Semantic search across all content\n- Graph visualization tools\n- Media preview capabilities\n\n## Architecture\n\nThe application follows a modern JAMstack approach with:\n1. Static generation for optimal performance\n2. Dynamic API routes for search and AI features  \n3. Edge functions for content processing\n4. CDN distribution for global availability",
      "code": "var Component=(()=>{var p=Object.create;var t=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty;var w=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),b=(i,e)=>{for(var a in e)t(i,a,{get:e[a],enumerable:!0})},l=(i,e,a,c)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let r of g(e))!f.call(i,r)&&r!==a&&t(i,r,{get:()=>e[r],enumerable:!(c=m(e,r))||c.enumerable});return i};var k=(i,e,a)=>(a=i!=null?p(u(i)):{},l(e||!i||!i.__esModule?t(a,\"default\",{value:i,enumerable:!0}):a,i)),v=i=>l(t({},\"__esModule\",{value:!0}),i);var s=w((x,o)=>{o.exports=_jsx_runtime});var N={};b(N,{default:()=>d,frontmatter:()=>y});var n=k(s()),y={title:\"Personal Website Project\",summary:\"A modern personal website with AI-powered content search and interactive knowledge graphs\",status:\"in-progress\",role:\"Full-stack Developer\",stack:[\"Next.js\",\"TypeScript\",\"Tailwind CSS\",\"Supabase\",\"Contentlayer\"],repoUrl:\"https://github.com/sample/personal-website\",demoUrl:\"https://sample-website.vercel.app\",tags:[\"web development\",\"AI\",\"full-stack\"],featured:!0,startDate:\"2025-08-27\"};function h(i){let e={a:\"a\",h1:\"h1\",h2:\"h2\",h3:\"h3\",li:\"li\",ol:\"ol\",p:\"p\",span:\"span\",strong:\"strong\",ul:\"ul\",...i.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"personal-website-project\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#personal-website-project\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Personal Website Project\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This project showcases a modern approach to building personal academic websites with integrated AI capabilities.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"overview\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#overview\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Overview\"]}),`\n`,(0,n.jsx)(e.p,{children:\"The website features:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Git-based content management\"}),`\n`,(0,n.jsx)(e.li,{children:\"AI-powered search and chat\"}),`\n`,(0,n.jsx)(e.li,{children:\"Interactive knowledge graphs\"}),`\n`,(0,n.jsx)(e.li,{children:\"Responsive design with dark mode\"}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"technology-stack\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#technology-stack\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Technology Stack\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Frontend\"}),\": Next.js with App Router, React, TypeScript\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Styling\"}),\": Tailwind CSS, shadcn/ui components\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Content\"}),\": MDX with Contentlayer for static generation\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Database\"}),\": Supabase with pgvector for embeddings\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Deployment\"}),\": Vercel for automatic deployments\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"key-features\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#key-features\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Key Features\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"content-management\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#content-management\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Content Management\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Markdown/MDX files in Git for publications and projects\"}),`\n`,(0,n.jsx)(e.li,{children:\"Automatic content indexing and embedding generation\"}),`\n`,(0,n.jsx)(e.li,{children:\"Support for rich media including images, videos, and PDFs\"}),`\n`]}),`\n`,(0,n.jsxs)(e.h3,{id:\"ai-agent\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#ai-agent\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"AI Agent\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Context-aware chat interface on every page\"}),`\n`,(0,n.jsx)(e.li,{children:\"Semantic search across all content\"}),`\n`,(0,n.jsx)(e.li,{children:\"Graph visualization tools\"}),`\n`,(0,n.jsx)(e.li,{children:\"Media preview capabilities\"}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"architecture\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#architecture\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Architecture\"]}),`\n`,(0,n.jsx)(e.p,{children:\"The application follows a modern JAMstack approach with:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Static generation for optimal performance\"}),`\n`,(0,n.jsx)(e.li,{children:\"Dynamic API routes for search and AI features\"}),`\n`,(0,n.jsx)(e.li,{children:\"Edge functions for content processing\"}),`\n`,(0,n.jsx)(e.li,{children:\"CDN distribution for global availability\"}),`\n`]})]})}function d(i={}){let{wrapper:e}=i.components||{};return e?(0,n.jsx)(e,{...i,children:(0,n.jsx)(h,{...i})}):h(i)}return v(N);})();\n;return Component;"
    },
    "_id": "projects/personal-website.mdx",
    "_raw": {
      "sourceFilePath": "projects/personal-website.mdx",
      "sourceFileName": "personal-website.mdx",
      "sourceFileDir": "projects",
      "contentType": "mdx",
      "flattenedPath": "projects/personal-website"
    },
    "type": "Project",
    "url": "/projects/personal-website",
    "slug": "personal-website"
  }
]