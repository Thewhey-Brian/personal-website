[
  {
    "title": "Graph Neural Networks for Spatial Transcriptomics",
    "summary": "A comprehensive guide to understanding and applying GNNs to spatial transcriptomics data, from foundational concepts to cutting-edge research implementations",
    "status": "completed",
    "role": "Research & Implementation",
    "stack": [
      "PyTorch",
      "PyTorch Geometric",
      "Python",
      "Graph Neural Networks",
      "Spatial Transcriptomics"
    ],
    "images": [],
    "tags": [
      "deep learning",
      "bioinformatics",
      "graph neural networks",
      "spatial transcriptomics",
      "computational biology"
    ],
    "featured": false,
    "startDate": "2025-02-06T00:00:00.000Z",
    "body": {
      "raw": "\n# Graph Neural Networks for Spatial Transcriptomics\n\nA deep dive into applying Graph Neural Networks (GNNs) to spatial transcriptomics research, bridging deep learning theory with cutting-edge biological applications.\n\n## Table of Contents\n\n1. [Introduction](#introduction)\n2. [From CNNs to GNNs](#from-cnns-to-gnns)\n3. [Core GNN Architectures](#core-gnn-architectures)\n4. [Graph Construction Strategies](#graph-construction-strategies)\n5. [State-of-the-Art Methods in Spatial Transcriptomics](#state-of-the-art-methods)\n6. [Implementation Guide](#implementation-guide)\n7. [Practical Considerations](#practical-considerations)\n\n---\n\n## Introduction\n\nSpatial transcriptomics (ST) captures gene expression while preserving the physical location of cells in tissue. This spatial context creates a natural graph structure where:\n\n- **Nodes** = spots/cells with gene expression vectors\n- **Edges** = spatial proximity or molecular similarity\n- **Task** = identify tissue domains, cell types, or spatial patterns\n\nGraph Neural Networks provide a powerful framework to leverage this structure, enabling message-passing that respects both spatial topology and molecular relationships.\n\n---\n\n## From CNNs to GNNs\n\n### Why CNNs Can't Handle Irregular Grids\n\nConvolutional Neural Networks excel at structured data (images) because:\n\n1. **Local connectivity**: Each pixel has a fixed neighborhood (e.g., 3×3)\n2. **Weight sharing**: The same filter slides across all positions, making parameter efficient\n3. **Translation invariance**: Patterns learned anywhere apply everywhere\n\nThe convolution operation at pixel $(i,j)$ is:\n\n$$\ny_{i,j} = \\sum_{a=-1}^{1} \\sum_{b=-1}^{1} w_{a,b} \\cdot x_{i+a, j+b}\n$$\n\n**The problem for spatial transcriptomics**: Spots are irregularly spaced and often have varying numbers of neighbors. We can't use a fixed 3×3 kernel.\n\n### Message Passing: The Key Insight\n\nGNNs generalize convolution to **arbitrary graph structures** through message passing:\n\n$$\nh_i^{(l+1)} = \\sigma\\left(W^{(l)} \\cdot \\text{AGGREGATE}\\{h_j^{(l)} : j \\in \\mathcal{N}(i)\\}\\right)\n$$\n\nWhere:\n- $h_i^{(l)}$ = feature vector of node $i$ at layer $l$\n- $\\mathcal{N}(i)$ = neighbors of node $i$\n- $W^{(l)}$ = learnable weight matrix\n- $\\sigma$ = activation function (ReLU, etc.)\n\nThis is conceptually similar to CNN convolution, but:\n- Neighbors are defined by **edges**, not spatial proximity on a grid\n- Each node can have a **variable number** of neighbors\n- Weights are **shared across all nodes**, just like CNN filters\n\n---\n\n## Core GNN Architectures\n\n### 1. Graph Convolutional Network (GCN)\n\n**Paper**: Kipf & Welling (2017)\n\n**Core Idea**: Normalize neighbor aggregation by degree to prevent scale issues.\n\n#### Mathematical Formulation\n\nGiven:\n- $\\mathbf{X} \\in \\mathbb{R}^{N \\times F}$: node features (N spots, F genes)\n- $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$: adjacency matrix\n- $\\mathbf{D}$: degree matrix (diagonal, where $D_{ii} = \\sum_j A_{ij}$)\n\nAdd self-loops and normalize:\n\n$$\n\\tilde{\\mathbf{A}} = \\mathbf{A} + \\mathbf{I} \\quad \\text{(add self-connections)}\n$$\n\n$$\n\\tilde{D}_{ii} = \\sum_j \\tilde{A}_{ij} \\quad \\text{(recompute degrees)}\n$$\n\nThe GCN layer performs symmetric normalization:\n\n$$\n\\mathbf{H}^{(l+1)} = \\sigma\\left(\\tilde{\\mathbf{D}}^{-1/2} \\tilde{\\mathbf{A}} \\tilde{\\mathbf{D}}^{-1/2} \\mathbf{H}^{(l)} \\mathbf{W}^{(l)}\\right)\n$$\n\n**Intuition**: The symmetric normalization $\\tilde{\\mathbf{D}}^{-1/2} \\tilde{\\mathbf{A}} \\tilde{\\mathbf{D}}^{-1/2}$ creates a normalized adjacency that averages features fairly across neighbors, preventing high-degree nodes from dominating.\n\n#### PyTorch Implementation (Matrix Form)\n\n```python\nimport torch\nimport torch.nn as nn\n\ndef normalize_adj(edge_index, num_nodes):\n    \"\"\"\n    Build symmetric normalized adjacency: D^{-1/2} A D^{-1/2}\n    Returns sparse tensor indices and values.\n    \"\"\"\n    i, j = edge_index\n    # Add self-loops\n    self_loops = torch.arange(num_nodes, device=edge_index.device)\n    i = torch.cat([i, self_loops])\n    j = torch.cat([j, self_loops])\n\n    # Compute degree\n    deg = torch.bincount(j, minlength=num_nodes).float()\n    deg_inv_sqrt = deg.clamp(min=1).pow(-0.5)\n\n    # Symmetric normalization weights\n    vals = deg_inv_sqrt[i] * deg_inv_sqrt[j]\n    return torch.stack([i, j], dim=0), vals\n\nclass GCNLayer(nn.Module):\n    \"\"\"\n    Graph Convolutional Layer with sparse adjacency multiply.\n    \"\"\"\n    def __init__(self, in_channels, out_channels, bias=True):\n        super().__init__()\n        self.lin = nn.Linear(in_channels, out_channels, bias=bias)\n\n    def forward(self, x, edge_index):\n        N = x.size(0)\n        idx, vals = normalize_adj(edge_index, N)\n        A_norm = torch.sparse_coo_tensor(idx, vals, (N, N), device=x.device)\n\n        x = self.lin(x)                    # [N, F_out]\n        x = torch.sparse.mm(A_norm, x)     # Sparse matrix multiply\n        return torch.relu(x)\n\n# Full GCN Model\nclass GCN(nn.Module):\n    def __init__(self, in_channels, hidden_channels, out_channels, num_layers=2):\n        super().__init__()\n        self.layers = nn.ModuleList()\n        self.layers.append(GCNLayer(in_channels, hidden_channels))\n        for _ in range(num_layers - 2):\n            self.layers.append(GCNLayer(hidden_channels, hidden_channels))\n        self.layers.append(GCNLayer(hidden_channels, out_channels))\n\n    def forward(self, x, edge_index):\n        for i, layer in enumerate(self.layers[:-1]):\n            x = layer(x, edge_index)\n            x = torch.relu(x)\n            x = torch.dropout(x, p=0.5, train=self.training)\n        x = self.layers[-1](x, edge_index)\n        return x\n```\n\n**Strengths**:\n- Simple, efficient, mathematically principled\n- Fast on small-to-medium graphs\n- Smooth aggregation good for homogeneous tissue\n\n**Weaknesses**:\n- Fixed (isotropic) weights—all neighbors treated equally\n- Transductive (needs full graph at training)\n- Over-smoothing with many layers\n\n---\n\n### 2. GraphSAGE\n\n**Paper**: Hamilton et al. (2017)\n\n**Core Idea**: Sample neighbors and use robust aggregators (mean, LSTM, max-pool) to scale to large graphs and enable **inductive learning** (generalize to unseen nodes/graphs).\n\n#### Update Rule\n\n$$\nh_i^{(l+1)} = \\sigma\\left(\\mathbf{W} \\cdot \\text{CONCAT}\\left[h_i^{(l)}, \\text{AGG}\\{h_j^{(l)} : j \\in \\mathcal{N}(i)\\}\\right]\\right)\n$$\n\nKey differences from GCN:\n1. **Concatenate** self-feature with aggregated neighbors (preserves identity)\n2. **Sample** a fixed number of neighbors (e.g., 10) instead of using all\n3. **Aggregator** choices: mean, max-pool, LSTM\n\n#### PyTorch Implementation\n\n```python\nimport torch\nimport torch.nn as nn\nimport torch.nn.functional as F\n\nclass SAGEConv(nn.Module):\n    \"\"\"\n    GraphSAGE layer with mean aggregation.\n    \"\"\"\n    def __init__(self, in_channels, out_channels, normalize=True):\n        super().__init__()\n        self.lin_self = nn.Linear(in_channels, out_channels)\n        self.lin_neigh = nn.Linear(in_channels, out_channels)\n        self.normalize = normalize\n\n    def forward(self, x, edge_index, num_neighbors_sample=10):\n        N = x.size(0)\n\n        # Sample neighbors (for scalability)\n        src, dst = edge_index\n        # Group by destination\n        neighbors = {}\n        for s, d in zip(src.tolist(), dst.tolist()):\n            neighbors.setdefault(d, []).append(s)\n\n        # Sample and aggregate\n        neigh_features = []\n        for i in range(N):\n            if i in neighbors and len(neighbors[i]) > 0:\n                sampled = torch.tensor(\n                    neighbors[i][:num_neighbors_sample],\n                    device=x.device\n                )\n                neigh_features.append(x[sampled].mean(dim=0))\n            else:\n                neigh_features.append(torch.zeros(x.size(1), device=x.device))\n\n        neigh_agg = torch.stack(neigh_features)  # [N, F]\n\n        # Combine self and neighbor\n        out = self.lin_self(x) + self.lin_neigh(neigh_agg)\n\n        if self.normalize:\n            out = F.normalize(out, p=2, dim=1)\n\n        return out\n\nclass GraphSAGE(nn.Module):\n    def __init__(self, in_channels, hidden_channels, out_channels, num_layers=2):\n        super().__init__()\n        self.layers = nn.ModuleList()\n        self.layers.append(SAGEConv(in_channels, hidden_channels))\n        for _ in range(num_layers - 2):\n            self.layers.append(SAGEConv(hidden_channels, hidden_channels))\n        self.layers.append(SAGEConv(hidden_channels, out_channels))\n\n    def forward(self, x, edge_index):\n        for layer in self.layers[:-1]:\n            x = layer(x, edge_index)\n            x = F.relu(x)\n            x = F.dropout(x, p=0.5, training=self.training)\n        x = self.layers[-1](x, edge_index)\n        return x\n```\n\n**Strengths**:\n- Scales to massive graphs via neighbor sampling\n- Inductive: can generalize to new slides without retraining\n- Multiple aggregator options\n\n**Weaknesses**:\n- Sampling introduces variance\n- More hyperparameters (sample size per layer)\n- Still treats all sampled neighbors equally\n\n---\n\n### 3. Graph Attention Network (GAT)\n\n**Paper**: Veličković et al. (2018)\n\n**Core Idea**: Learn **per-edge attention weights** so the model can focus on important neighbors and ignore noisy ones.\n\n#### Attention Mechanism\n\nFor each edge $(i, j)$:\n\n$$\ne_{ij} = \\text{LeakyReLU}\\left(\\mathbf{a}^T [\\mathbf{W} h_i \\,||\\, \\mathbf{W} h_j]\\right)\n$$\n\nNormalize with softmax over all neighbors:\n\n$$\n\\alpha_{ij} = \\frac{\\exp(e_{ij})}{\\sum_{k \\in \\mathcal{N}(i)} \\exp(e_{ik})}\n$$\n\nAggregate with learned weights:\n\n$$\nh_i^{(l+1)} = \\sigma\\left(\\sum_{j \\in \\mathcal{N}(i)} \\alpha_{ij} \\cdot \\mathbf{W} \\cdot h_j^{(l)}\\right)\n$$\n\n**Multi-head attention** (like Transformers): Run $K$ independent attention heads and concatenate:\n\n$$\nh_i^{(l+1)} = \\Big|\\Big|_{k=1}^K \\sigma\\left(\\sum_{j \\in \\mathcal{N}(i)} \\alpha_{ij}^k \\cdot \\mathbf{W}^k \\cdot h_j^{(l)}\\right)\n$$\n\n#### PyTorch Implementation\n\n```python\nimport torch\nimport torch.nn as nn\nimport torch.nn.functional as F\n\nclass GATLayer(nn.Module):\n    \"\"\"\n    Graph Attention Layer (single head).\n    \"\"\"\n    def __init__(self, in_channels, out_channels, dropout=0.6, alpha=0.2):\n        super().__init__()\n        self.W = nn.Linear(in_channels, out_channels, bias=False)\n        self.a = nn.Parameter(torch.zeros(size=(2 * out_channels, 1)))\n        self.leakyrelu = nn.LeakyReLU(alpha)\n        self.dropout = dropout\n        nn.init.xavier_uniform_(self.a.data, gain=1.414)\n\n    def forward(self, x, edge_index):\n        # Linear transformation\n        Wh = self.W(x)  # [N, out_channels]\n        N = Wh.size(0)\n\n        # Compute attention coefficients\n        src, dst = edge_index\n        # Concatenate source and destination features\n        Wh_src = Wh[src]  # [E, out_channels]\n        Wh_dst = Wh[dst]  # [E, out_channels]\n        concat_features = torch.cat([Wh_src, Wh_dst], dim=1)  # [E, 2*out_channels]\n\n        # Attention mechanism\n        e = self.leakyrelu(concat_features @ self.a).squeeze()  # [E]\n\n        # Normalize per destination node\n        attention = torch.zeros(N, device=x.device)\n        attention_weights = torch.zeros_like(e)\n\n        for i in range(N):\n            mask = (dst == i)\n            if mask.sum() > 0:\n                e_neighbors = e[mask]\n                alpha = F.softmax(e_neighbors, dim=0)\n                attention_weights[mask] = alpha\n\n        # Apply dropout to attention\n        attention_weights = F.dropout(attention_weights, self.dropout, training=self.training)\n\n        # Aggregate\n        out = torch.zeros_like(Wh)\n        for i in range(N):\n            mask = (dst == i)\n            if mask.sum() > 0:\n                out[i] = (attention_weights[mask].unsqueeze(1) * Wh[src[mask]]).sum(dim=0)\n\n        return out\n\nclass GAT(nn.Module):\n    def __init__(self, in_channels, hidden_channels, out_channels,\n                 num_heads=8, dropout=0.6):\n        super().__init__()\n        self.dropout = dropout\n\n        # Multi-head first layer\n        self.attentions = nn.ModuleList([\n            GATLayer(in_channels, hidden_channels, dropout=dropout)\n            for _ in range(num_heads)\n        ])\n\n        # Single-head output layer\n        self.out_att = GATLayer(\n            hidden_channels * num_heads,\n            out_channels,\n            dropout=dropout\n        )\n\n    def forward(self, x, edge_index):\n        # First layer: concatenate multi-head outputs\n        x = torch.cat([att(x, edge_index) for att in self.attentions], dim=1)\n        x = F.dropout(x, self.dropout, training=self.training)\n        x = F.elu(x)\n\n        # Output layer\n        x = self.out_att(x, edge_index)\n        return x\n```\n\n**Strengths**:\n- Learns which neighbors are important (anisotropic)\n- Better at handling heterogeneous neighborhoods\n- Respects sharp boundaries (e.g., tumor-stroma)\n\n**Weaknesses**:\n- More parameters (attention + multi-heads)\n- Slower than GCN\n- Can be unstable (needs careful tuning of dropout, LR)\n\n---\n\n## Architecture Comparison Table\n\n| Model | Neighbor Weights | Sampling | Inductive? | Best Use Case |\n|-------|-----------------|----------|------------|---------------|\n| **GCN** | Fixed by normalized adjacency | Full graph (no sampling) | No (transductive) | Smooth tissue, clean spatial graphs, small-medium datasets |\n| **GraphSAGE** | Fixed aggregator (mean/max/LSTM) | Neighborhood sampling | Yes | Large graphs, multiple slides, production systems |\n| **GAT** | Learned per-edge attention | Full neighborhood (or can sample) | Often yes | Heterogeneous tissue, sharp boundaries, variable neighbor quality |\n\n**Visual Comparison**:\n\n```\nGCN:      All neighbors weighted equally (by degree normalization)\n          [Spot] ← (0.25, 0.25, 0.25, 0.25) ← [4 neighbors]\n\nGraphSAGE: Sample subset, aggregate with mean/max\n          [Spot] ← sample 2 → mean([n1, n2])\n\nGAT:      Learn attention per edge\n          [Spot] ← (α₁=0.5, α₂=0.3, α₃=0.15, α₄=0.05) ← [4 neighbors]\n                    ↑ Learned weights\n```\n\n---\n\n## Graph Construction Strategies\n\n**Critical insight**: Graph topology often matters more than the GNN architecture.\n\n### 1. Spatial Proximity Graphs\n\n#### k-Nearest Neighbors (kNN)\n\nConnect each spot to its `k` closest spatial neighbors.\n\n```python\nimport numpy as np\nfrom sklearn.neighbors import NearestNeighbors\nimport torch\n\ndef knn_graph(coords, k=6):\n    \"\"\"\n    Build kNN graph from spatial coordinates.\n\n    Args:\n        coords: [N, 2] array of (x, y) positions\n        k: number of neighbors\n    Returns:\n        edge_index: [2, E] tensor in COO format\n    \"\"\"\n    nbrs = NearestNeighbors(n_neighbors=k+1, algorithm='kd_tree').fit(coords)\n    distances, indices = nbrs.kneighbors(coords)\n\n    # Exclude self (first neighbor)\n    src = np.repeat(np.arange(len(coords)), k)\n    dst = indices[:, 1:].reshape(-1)\n\n    # Make undirected\n    edge_index = np.stack([src, dst], axis=0)\n    edge_index = np.concatenate([edge_index, edge_index[::-1]], axis=1)\n    edge_index = np.unique(edge_index, axis=1)\n\n    return torch.as_tensor(edge_index, dtype=torch.long)\n```\n\n**Pros**: Simple, controllable density\n**Cons**: Fixed `k` ignores tissue density variation\n\n**Effect of `k` on smoothing**:\n- **Small `k` (4-6)**: Preserves sharp boundaries, less smoothing\n- **Large `k` (12-20)**: More smoothing, boundaries blur, risk of over-smoothing\n\n#### Radius (ε-ball) Graph\n\nConnect all spots within distance `ε`.\n\n```python\ndef radius_graph(coords, radius=100.0):\n    \"\"\"\n    Build radius graph: connect nodes within distance threshold.\n    \"\"\"\n    from sklearn.neighbors import radius_neighbors_graph\n    A = radius_neighbors_graph(coords, radius, mode='connectivity')\n    edge_index = torch.as_tensor(np.array(A.nonzero()), dtype=torch.long)\n    return edge_index\n```\n\n**Pros**: Density-adaptive, physically meaningful\n**Cons**: Can create disconnected components if `ε` too small\n\n#### Delaunay Triangulation\n\nBuild triangles connecting nearest points without overlap—preserves natural geometry.\n\n```python\nfrom scipy.spatial import Delaunay\nimport numpy as np\n\ndef delaunay_graph(coords):\n    \"\"\"\n    Build graph from Delaunay triangulation.\n    Used in SpaGCN for natural spatial connectivity.\n    \"\"\"\n    tri = Delaunay(coords)\n    edges = set()\n    for simplex in tri.simplices:\n        for i in range(3):\n            edge = tuple(sorted([simplex[i], simplex[(i+1)%3]]))\n            edges.add(edge)\n\n    edges = np.array(list(edges)).T\n    # Make undirected\n    edge_index = np.concatenate([edges, edges[::-1]], axis=1)\n    return torch.as_tensor(edge_index, dtype=torch.long)\n```\n\n**Pros**: Natural geometric structure, used in SpaGCN\n**Cons**: Can create long edges in sparse regions\n\n---\n\n### 2. Expression Similarity Graphs\n\nConnect spots with similar gene expression, independent of distance.\n\n```python\ndef expression_similarity_graph(X, k=10, metric='cosine'):\n    \"\"\"\n    Build kNN graph in expression space.\n\n    Args:\n        X: [N, genes] expression matrix\n        k: number of neighbors\n        metric: 'cosine' or 'euclidean'\n    \"\"\"\n    from sklearn.neighbors import NearestNeighbors\n    nbrs = NearestNeighbors(n_neighbors=k+1, metric=metric).fit(X)\n    distances, indices = nbrs.kneighbors(X)\n\n    src = np.repeat(np.arange(len(X)), k)\n    dst = indices[:, 1:].reshape(-1)\n    edge_index = np.stack([src, dst], axis=0)\n\n    # Undirected\n    edge_index = np.concatenate([edge_index, edge_index[::-1]], axis=1)\n    edge_index = np.unique(edge_index, axis=1)\n\n    return torch.as_tensor(edge_index, dtype=torch.long)\n```\n\n**Pros**: Captures functional/molecular similarity\n**Cons**: May connect distant regions; ignores spatial structure\n\n---\n\n### 3. Hybrid (Multi-view) Graphs\n\nCombine spatial and expression information.\n\n**Weighted combination**:\n\n$$\n\\mathbf{A} = \\alpha \\cdot \\mathbf{A}_{\\text{spatial}} + (1 - \\alpha) \\cdot \\mathbf{A}_{\\text{expression}}\n$$\n\n**Learnable weighting**:\n\n```python\nclass MultiViewGNN(nn.Module):\n    def __init__(self, in_channels, out_channels):\n        super().__init__()\n        self.gcn_spatial = GCNLayer(in_channels, out_channels)\n        self.gcn_expression = GCNLayer(in_channels, out_channels)\n        self.alpha = nn.Parameter(torch.tensor(0.5))  # Learnable weight\n\n    def forward(self, x, edge_index_spatial, edge_index_expr):\n        h_spatial = self.gcn_spatial(x, edge_index_spatial)\n        h_expr = self.gcn_expression(x, edge_index_expr)\n\n        alpha = torch.sigmoid(self.alpha)  # Ensure [0,1]\n        return alpha * h_spatial + (1 - alpha) * h_expr\n```\n\n**Used in**: STAGATE, conST, GraphST\n\n---\n\n### 4. Image-Based Graphs (Histology Integration)\n\nIf H&E images are available, use morphological similarity.\n\n```python\ndef image_weighted_graph(coords, image_features, k=6, alpha=0.5):\n    \"\"\"\n    Weighted graph combining spatial distance and image feature similarity.\n\n    Args:\n        coords: [N, 2] spatial positions\n        image_features: [N, D] CNN features from histology patches\n        alpha: weight between spatial and image (0=spatial only, 1=image only)\n    \"\"\"\n    from sklearn.neighbors import NearestNeighbors\n    from sklearn.metrics.pairwise import cosine_similarity\n\n    # Spatial kNN\n    nbrs_spatial = NearestNeighbors(n_neighbors=k+1).fit(coords)\n    dist_spatial, idx_spatial = nbrs_spatial.kneighbors(coords)\n\n    # Image similarity\n    img_sim = cosine_similarity(image_features)\n\n    edges = []\n    weights = []\n    for i in range(len(coords)):\n        for j_idx, j in enumerate(idx_spatial[i, 1:]):  # Skip self\n            spatial_sim = 1.0 / (1.0 + dist_spatial[i, j_idx+1])\n            image_sim_val = img_sim[i, j]\n\n            combined_weight = alpha * spatial_sim + (1 - alpha) * image_sim_val\n            edges.append([i, j])\n            weights.append(combined_weight)\n\n    edge_index = torch.tensor(edges, dtype=torch.long).T\n    edge_weight = torch.tensor(weights, dtype=torch.float)\n\n    return edge_index, edge_weight\n```\n\n**Used in**: SpaGCN, conST, MERGE\n\n---\n\n## State-of-the-Art Methods in Spatial Transcriptomics\n\n### Method Comparison Table\n\n| Method | Year | Graph Type | GNN Architecture | Key Innovation | Task |\n|--------|------|------------|------------------|----------------|------|\n| **SpaGCN** | 2021 | Spatial + histology weighted | GCN | Delaunay + image features, domain detection | Clustering, SVG detection |\n| **STAGATE** | 2022 | Spatial kNN | Graph Attention Autoencoder | Learned attention, autoencoder framework | Clustering, denoising, trajectory |\n| **SEDR** | 2021 | Spatial kNN | VGAE + deep autoencoder | Dual embedding (expression + spatial VGAE) | Clustering, embedding |\n| **GraphST** | 2023 | Multi-view (spatial + expr) | GCN + contrastive learning | Self-supervised contrastive, multi-sample integration | Clustering, deconvolution |\n| **STdGCN** | 2023 | Hybrid (spot + pseudo-spot) | GCN | Integrate scRNA reference via hybrid graph | Deconvolution |\n| **stAA** | 2024 | Spatial kNN | Adversarial VGAE | WGAN regularization on embeddings | Clustering |\n| **stMCDI** | 2024 | Spatial | GNN encoder in diffusion model | Diffusion-based imputation with GNN | Missing value imputation |\n| **MERGE** | 2023 | Hierarchical image patches | Multi-scale GNN | Image → gene prediction via hierarchical graph | Prediction from histology |\n\n---\n\n### Deep Dive: SpaGCN\n\n**Paper**: Hu et al., *Nature Methods* (2021)\n\n**Problem**: Identify spatial domains using both gene expression and tissue morphology.\n\n**Graph Construction**:\n1. Build Delaunay triangulation from spot coordinates\n2. Weight edges by combination of:\n   - Spatial distance\n   - Histology image similarity (compare H&E patches around each spot)\n\n$$\nw_{ij} = \\exp\\left(-\\frac{d_{\\text{spatial}}(i,j)^2}{2\\sigma_d^2}\\right) \\times \\exp\\left(-\\frac{d_{\\text{image}}(i,j)^2}{2\\sigma_i^2}\\right)\n$$\n\n**GNN**: Standard GCN with weighted adjacency\n\n**Loss**: Combines:\n- Clustering loss (Louvain or k-means on embeddings)\n- Spatial regularization (neighbors should have similar cluster assignments)\n\n**Code Sketch**:\n\n```python\n# Weighted adjacency from spatial + image\nA_weighted = spatial_weight * image_weight\n\n# GCN embedding\nH = gcn_layers(X, A_weighted)\n\n# Clustering\nclusters = louvain_clustering(H)\n\n# Find spatially variable genes per domain\nsvg_genes = differential_expression_per_domain(clusters)\n```\n\n**Strengths**: Multi-modal, interpretable, works well on Visium data\n**Limitations**: Static graph, sensitive to weighting hyperparameters\n\n---\n\n### Deep Dive: STAGATE\n\n**Paper**: Dong & Chen, *Nature Communications* (2022)\n\n**Problem**: Learn representations robust to noise, preserve spatial structure, enable downstream tasks (clustering, pseudotime).\n\n**Architecture**: Graph Attention Autoencoder\n- **Encoder**: Multi-layer GAT → latent embedding `Z`\n- **Decoder**: Reconstruct both expression `X` and adjacency `A`\n\n**Key Innovation**: Attention mechanism learns which neighbors are relevant, mitigating over-smoothing.\n\n**Loss**:\n\n$$\n\\mathcal{L} = \\mathcal{L}_{\\text{recon}}(\\mathbf{X}, \\hat{\\mathbf{X}}) + \\lambda \\cdot \\mathcal{L}_{\\text{graph}}(\\mathbf{A}, \\hat{\\mathbf{A}})\n$$\n\nWhere:\n- $\\mathcal{L}_{\\text{recon}}$ = MSE for expression reconstruction\n- $\\mathcal{L}_{\\text{graph}}$ = binary cross-entropy for adjacency reconstruction\n\n**Code Outline**:\n\n```python\nclass STAGATE(nn.Module):\n    def __init__(self, n_genes, hidden_dim, latent_dim):\n        super().__init__()\n        self.encoder = nn.ModuleList([\n            GATLayer(n_genes, hidden_dim),\n            GATLayer(hidden_dim, latent_dim)\n        ])\n        self.decoder_expr = nn.Linear(latent_dim, n_genes)\n        self.decoder_graph = InnerProductDecoder()\n\n    def forward(self, x, edge_index):\n        # Encode\n        h = x\n        for layer in self.encoder:\n            h = F.elu(layer(h, edge_index))\n\n        # Decode\n        x_recon = self.decoder_expr(h)\n        adj_recon = torch.sigmoid(h @ h.T)  # Inner product for adjacency\n\n        return x_recon, adj_recon, h\n```\n\n**Strengths**: Adaptive smoothing, rich embeddings for multiple tasks\n**Limitations**: More hyperparameters, potential overfitting on small datasets\n\n---\n\n### Deep Dive: GraphST (Contrastive Learning)\n\n**Paper**: Long et al., *Nature Communications* (2023)\n\n**Problem**: Integrate multiple tissue sections, perform clustering and deconvolution.\n\n**Key Idea**: Self-supervised contrastive learning on graph embeddings.\n\n**Method**:\n1. Build two views of the same graph (e.g., different augmentations or spatial vs. expression graphs)\n2. Encode both with GCN\n3. Contrastive loss: pull together embeddings from same spot, push apart different spots\n\n$$\n\\mathcal{L}_{\\text{contrast}} = -\\log\\frac{\\exp(\\text{sim}(z_i, z_i^+) / \\tau)}{\\sum_j \\exp(\\text{sim}(z_i, z_j) / \\tau)}\n$$\n\nWhere $z_i^+$ is the augmented view of spot $i$.\n\n**Benefits**:\n- Learns robust representations without labeled data\n- Aligns multiple slides in shared embedding space\n\n**Code Sketch**:\n\n```python\n# Create two views\nedge_index_view1 = knn_graph(coords, k=6)\nedge_index_view2 = expression_similarity_graph(X, k=10)\n\n# Encode both\nz1 = gnn_encoder(X, edge_index_view1)\nz2 = gnn_encoder(X, edge_index_view2)\n\n# Contrastive loss (InfoNCE)\nloss = contrastive_loss(z1, z2, temperature=0.5)\n```\n\n---\n\n## Implementation Guide\n\n### Complete Pipeline: Spatial Domain Detection\n\nHere's a complete, runnable pipeline from raw Visium data to domain detection using a GNN.\n\n#### Step 1: Load Data\n\n```python\nimport scanpy as sc\nimport numpy as np\nimport torch\nfrom sklearn.preprocessing import StandardScaler\n\n# Load Visium data (standard scanpy format)\nadata = sc.read_visium(\"path/to/visium/data\")\n\n# Extract coordinates and expression\ncoords = adata.obsm['spatial']  # [N, 2]\nX = adata.X.toarray() if hasattr(adata.X, 'toarray') else adata.X  # [N, genes]\n\n# Highly variable genes\nsc.pp.highly_variable_genes(adata, n_top_genes=2000)\nX = X[:, adata.var['highly_variable']]\n\n# Normalize\nX = StandardScaler().fit_transform(X)\n\n# To tensors\nX_tensor = torch.tensor(X, dtype=torch.float32)\ncoords_np = np.array(coords)\n```\n\n#### Step 2: Build Graph\n\n```python\nfrom sklearn.neighbors import NearestNeighbors\n\ndef build_spatial_graph(coords, k=6):\n    nbrs = NearestNeighbors(n_neighbors=k+1).fit(coords)\n    _, indices = nbrs.kneighbors(coords)\n\n    src = np.repeat(np.arange(len(coords)), k)\n    dst = indices[:, 1:].reshape(-1)\n    edge_index = np.stack([src, dst], axis=0)\n\n    # Undirected\n    edge_index = np.concatenate([edge_index, edge_index[::-1]], axis=1)\n    edge_index = np.unique(edge_index, axis=1)\n\n    return torch.tensor(edge_index, dtype=torch.long)\n\nedge_index = build_spatial_graph(coords_np, k=6)\n```\n\n#### Step 3: Define Model\n\n```python\nclass SpatialGNN(nn.Module):\n    def __init__(self, n_genes, hidden_dim=128, latent_dim=32, n_clusters=7):\n        super().__init__()\n        self.encoder = nn.ModuleList([\n            GCNLayer(n_genes, hidden_dim),\n            GCNLayer(hidden_dim, latent_dim)\n        ])\n        self.cluster_head = nn.Linear(latent_dim, n_clusters)\n\n    def forward(self, x, edge_index):\n        h = x\n        for layer in self.encoder:\n            h = layer(h, edge_index)\n            h = F.relu(h)\n            h = F.dropout(h, p=0.3, training=self.training)\n\n        logits = self.cluster_head(h)\n        return h, logits\n\nmodel = SpatialGNN(n_genes=X.shape[1], n_clusters=7)\noptimizer = torch.optim.Adam(model.parameters(), lr=0.001)\n```\n\n#### Step 4: Training Loop\n\n```python\nfrom sklearn.cluster import KMeans\n\ndef train_epoch(model, x, edge_index, optimizer):\n    model.train()\n    optimizer.zero_grad()\n\n    # Forward\n    embeddings, logits = model(x, edge_index)\n\n    # Pseudo-labels from k-means (self-supervised)\n    with torch.no_grad():\n        kmeans = KMeans(n_clusters=7, random_state=42)\n        pseudo_labels = kmeans.fit_predict(embeddings.cpu().numpy())\n        pseudo_labels = torch.tensor(pseudo_labels, dtype=torch.long)\n\n    # Cross-entropy loss\n    loss = F.cross_entropy(logits, pseudo_labels)\n\n    loss.backward()\n    optimizer.step()\n\n    return loss.item()\n\n# Train\nfor epoch in range(100):\n    loss = train_epoch(model, X_tensor, edge_index, optimizer)\n    if epoch % 10 == 0:\n        print(f\"Epoch {epoch}, Loss: {loss:.4f}\")\n```\n\n#### Step 5: Extract Clusters and Visualize\n\n```python\nmodel.eval()\nwith torch.no_grad():\n    embeddings, logits = model(X_tensor, edge_index)\n    clusters = logits.argmax(dim=1).cpu().numpy()\n\n# Add to adata\nadata.obs['gnn_cluster'] = clusters\n\n# Visualize on tissue\nimport scanpy as sc\nsc.pl.spatial(adata, color='gnn_cluster', spot_size=150)\n```\n\n---\n\n## Practical Considerations\n\n### 1. Over-smoothing Problem\n\n**Issue**: With many GNN layers, all node features converge to the same value.\n\n**Why**: Each layer mixes neighbors' features, leading to exponential diffusion.\n\n**Solutions**:\n- **Limit layers**: 2-3 layers often enough for ST (tissue neighborhoods are local)\n- **Skip connections**: Add residual connections\n\n  ```python\n  h_new = gcn_layer(h) + h  # Residual\n  ```\n\n- **Adaptive depth** (DropEdge, PairNorm): Randomly drop edges or normalize layer outputs\n\n**Rule of thumb for ST**:\n- Small tissue sections: 2 layers\n- Whole-slide: 3-4 layers max\n- Multi-sample integration: Consider global pooling instead of deeper GNN\n\n---\n\n### 2. Choosing Hyperparameter k (Number of Neighbors)\n\n**Trade-off**:\n- **Low k (4-6)**: Sharp boundaries, less smoothing, more noise sensitivity\n- **High k (12-20)**: Smoother, more stable, but blurs boundaries\n\n**Guideline**:\n- **Delaunay**: Natural choice, typically $k \\approx 6$\n- **Brain cortex / layered tissue**: Lower k to preserve layers\n- **Tumor heterogeneity**: Mid-range k (6-8)\n- **Dense spot arrays (Visium HD)**: Higher k (10-15)\n\n**Experiment**: Try $k \\in \\{4, 6, 8, 10, 12\\}$ and check:\n- Silhouette score on clusters\n- Agreement with known anatomical regions\n\n---\n\n### 3. Normalization and Preprocessing\n\n**Critical steps**:\n\n1. **Gene selection**: Use highly variable genes (1000-3000)\n2. **Expression normalization**: Log1p + standard scaling\n3. **Graph normalization**: Symmetric $\\tilde{\\mathbf{D}}^{-1/2} \\tilde{\\mathbf{A}} \\tilde{\\mathbf{D}}^{-1/2}$ (built into GCN)\n4. **Feature scaling**: StandardScaler before training\n\n```python\nimport scanpy as sc\nfrom sklearn.preprocessing import StandardScaler\n\n# Standard pipeline\nsc.pp.normalize_total(adata, target_sum=1e4)\nsc.pp.log1p(adata)\nsc.pp.highly_variable_genes(adata, n_top_genes=2000)\nadata = adata[:, adata.var.highly_variable]\n\nX = StandardScaler().fit_transform(adata.X.toarray())\n```\n\n---\n\n### 4. Evaluation Metrics\n\nFor **clustering**:\n- **Adjusted Rand Index (ARI)**: Compare with ground-truth annotations\n- **Normalized Mutual Information (NMI)**\n- **Silhouette score**: Cluster separation in embedding space\n\nFor **deconvolution**:\n- **RMSE** vs. known proportions (if synthetic data)\n- **Correlation** with reference cell-type markers\n\nFor **imputation**:\n- **RMSE** on held-out genes\n- **Pearson correlation** with ground truth\n\n```python\nfrom sklearn.metrics import adjusted_rand_score, silhouette_score\n\n# Clustering evaluation\nari = adjusted_rand_score(true_labels, predicted_clusters)\nsilhouette = silhouette_score(embeddings, predicted_clusters)\n\nprint(f\"ARI: {ari:.3f}, Silhouette: {silhouette:.3f}\")\n```\n\n---\n\n### 5. Common Pitfalls\n\n| Problem | Symptom | Solution |\n|---------|---------|----------|\n| **Over-smoothing** | All embeddings identical | Reduce layers, add skip connections |\n| **Disconnected graph** | NaN in training | Check graph connectivity, increase k or $\\varepsilon$ |\n| **Unstable GAT** | Loss spikes | Lower learning rate, increase dropout on attention |\n| **Poor clustering** | Random assignments | Better graph construction, tune k, check normalization |\n| **High memory** | OOM errors | Use mini-batching (GraphSAGE), neighbor sampling |\n\n---\n\n## Advanced Topics\n\n### 1. Hypergraph Neural Networks\n\n**Standard GNN**: Pairwise edges (connects 2 nodes)\n**Hypergraph**: Hyperedges connect $\\geq 2$ nodes simultaneously\n\n**Use case in ST**: Group of spots in a tissue domain share a hyperedge\n\n**Example**: [Hypergraph Neural Networks Reveal Spatial Domains](https://arxiv.org/abs/2401.12001)\n\n### 2. Hierarchical and Multi-Scale Graphs\n\n**Idea**: Build graphs at multiple resolutions\n- Fine-scale: spot-to-spot\n- Coarse-scale: domain-to-domain (via clustering)\n\n**Benefits**: Capture both local and global patterns\n\n**Example**: MERGE builds hierarchical image patch graphs\n\n### 3. Graph Transformers\n\nReplace message-passing with full self-attention over all nodes.\n\n**Pros**: No over-smoothing, long-range dependencies\n**Cons**: $\\mathcal{O}(N^2)$ complexity\n\n**Emerging work**: Graphormer, GraphGPS\n\n---\n\n## Resources and Next Steps\n\n### Papers (Recommended Reading Order)\n\n1. **GNN Foundations**:\n   - Kipf & Welling (2017): [Semi-Supervised Classification with GCNs](https://arxiv.org/abs/1609.02907)\n   - Hamilton et al. (2017): [GraphSAGE](https://arxiv.org/abs/1706.02216)\n   - Veličković et al. (2018): [Graph Attention Networks](https://arxiv.org/abs/1710.10903)\n\n2. **ST Applications**:\n   - SpaGCN: [Nature Methods 2021](https://www.nature.com/articles/s41592-021-01255-8)\n   - STAGATE: [Nature Communications 2022](https://www.nature.com/articles/s41467-022-29439-6)\n   - GraphST: [Nature Communications 2023](https://www.nature.com/articles/s41467-023-36796-3)\n\n3. **Advanced**:\n   - [Stanford CS224W course notes](http://web.stanford.edu/class/cs224w/)\n   - [Graph Representation Learning Book](https://www.cs.mcgill.ca/~wlh/grl_book/) (Hamilton)\n\n### Code Repositories\n\n- **PyTorch Geometric**: [https://pytorch-geometric.readthedocs.io/](https://pytorch-geometric.readthedocs.io/)\n- **DGL (Deep Graph Library)**: [https://www.dgl.ai/](https://www.dgl.ai/)\n- **STAGATE**: [https://github.com/zhanglabtools/STAGATE](https://github.com/zhanglabtools/STAGATE)\n- **GraphST**: [https://github.com/JinmiaoChenLab/GraphST](https://github.com/JinmiaoChenLab/GraphST)\n\n### Practice Projects\n\n1. **Reproduce SpaGCN** on a public Visium dataset (e.g., mouse brain)\n2. **Compare GCN vs. GAT** on your own ST data—measure ARI, runtime, smoothness\n3. **Build a hybrid graph** (spatial + expression) and tune the weighting parameter $\\alpha$\n4. **Implement contrastive learning** for multi-sample integration\n\n---\n\n## Conclusion\n\nGraph Neural Networks provide a powerful, principled framework for spatial transcriptomics analysis by:\n\n- **Respecting spatial structure** through graph topology\n- **Learning adaptive representations** via message passing\n- **Integrating multi-modal data** (expression, coordinates, images)\n- **Scaling to large datasets** with sampling and mini-batching\n\nThe key to success is:\n1. **Graph construction**: Choose topology that reflects your biology\n2. **Architecture selection**: Match model complexity to data size and task\n3. **Regularization**: Prevent over-smoothing and overfitting\n4. **Evaluation**: Use domain-relevant metrics and biological validation\n\nAs spatial omics technologies advance (Visium HD, Xenium, CosMx), GNNs will remain essential tools for discovering tissue organization, cell-cell interactions, and disease mechanisms.\n\n---\n\n**Happy graph learning!**\n",
      "code": "var Component=(()=>{var m=Object.create;var i=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty;var N=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports),u=(l,e)=>{for(var s in e)i(l,s,{get:e[s],enumerable:!0})},c=(l,e,s,r)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let a of y(e))!E.call(l,a)&&a!==s&&i(l,a,{get:()=>e[a],enumerable:!(r=p(e,a))||r.enumerable});return l};var F=(l,e,s)=>(s=l!=null?m(g(l)):{},c(e||!l||!l.__esModule?i(s,\"default\",{value:l,enumerable:!0}):s,l)),v=l=>c(i({},\"__esModule\",{value:!0}),l);var h=N((w,t)=>{t.exports=_jsx_runtime});var b={};u(b,{default:()=>o,frontmatter:()=>f});var n=F(h()),f={title:\"Graph Neural Networks for Spatial Transcriptomics\",summary:\"A comprehensive guide to understanding and applying GNNs to spatial transcriptomics data, from foundational concepts to cutting-edge research implementations\",status:\"completed\",role:\"Research & Implementation\",stack:[\"PyTorch\",\"PyTorch Geometric\",\"Python\",\"Graph Neural Networks\",\"Spatial Transcriptomics\"],tags:[\"deep learning\",\"bioinformatics\",\"graph neural networks\",\"spatial transcriptomics\",\"computational biology\"],featured:!1,startDate:\"2025-02-06\"};function d(l){let e={a:\"a\",annotation:\"annotation\",code:\"code\",em:\"em\",figure:\"figure\",h1:\"h1\",h2:\"h2\",h3:\"h3\",h4:\"h4\",hr:\"hr\",li:\"li\",math:\"math\",mfrac:\"mfrac\",mi:\"mi\",mn:\"mn\",mo:\"mo\",mover:\"mover\",mrow:\"mrow\",mspace:\"mspace\",msub:\"msub\",msubsup:\"msubsup\",msup:\"msup\",mtext:\"mtext\",munder:\"munder\",munderover:\"munderover\",ol:\"ol\",p:\"p\",path:\"path\",pre:\"pre\",semantics:\"semantics\",span:\"span\",strong:\"strong\",svg:\"svg\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...l.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"graph-neural-networks-for-spatial-transcriptomics\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#graph-neural-networks-for-spatial-transcriptomics\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Graph Neural Networks for Spatial Transcriptomics\"]}),`\n`,(0,n.jsx)(e.p,{children:\"A deep dive into applying Graph Neural Networks (GNNs) to spatial transcriptomics research, bridging deep learning theory with cutting-edge biological applications.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"table-of-contents\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#table-of-contents\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Table of Contents\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#introduction\",children:\"Introduction\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#from-cnns-to-gnns\",children:\"From CNNs to GNNs\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#core-gnn-architectures\",children:\"Core GNN Architectures\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#graph-construction-strategies\",children:\"Graph Construction Strategies\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#state-of-the-art-methods\",children:\"State-of-the-Art Methods in Spatial Transcriptomics\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#implementation-guide\",children:\"Implementation Guide\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#practical-considerations\",children:\"Practical Considerations\"})}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"introduction\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#introduction\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Introduction\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Spatial transcriptomics (ST) captures gene expression while preserving the physical location of cells in tissue. This spatial context creates a natural graph structure where:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Nodes\"}),\" = spots/cells with gene expression vectors\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Edges\"}),\" = spatial proximity or molecular similarity\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Task\"}),\" = identify tissue domains, cell types, or spatial patterns\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Graph Neural Networks provide a powerful framework to leverage this structure, enabling message-passing that respects both spatial topology and molecular relationships.\"}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"from-cnns-to-gnns\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#from-cnns-to-gnns\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"From CNNs to GNNs\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"why-cnns-cant-handle-irregular-grids\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#why-cnns-cant-handle-irregular-grids\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Why CNNs Can't Handle Irregular Grids\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Convolutional Neural Networks excel at structured data (images) because:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Local connectivity\"}),\": Each pixel has a fixed neighborhood (e.g., 3\\xD73)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Weight sharing\"}),\": The same filter slides across all positions, making parameter efficient\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Translation invariance\"}),\": Patterns learned anywhere apply everywhere\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"The convolution operation at pixel \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"(i,j)\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]}),\" is:\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"y\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.munderover,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"a\"}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"})]}),(0,n.jsx)(e.mn,{children:\"1\"})]}),(0,n.jsxs)(e.munderover,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"b\"}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"})]}),(0,n.jsx)(e.mn,{children:\"1\"})]}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"w\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"a\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"b\"})]})]}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"x\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mi,{children:\"a\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mi,{children:\"b\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"y_{i,j} = \\\\sum_{a=-1}^{1} \\\\sum_{b=-1}^{1} w_{a,b} \\\\cdot x_{i+a, j+b}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7167em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"y\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})]})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"3.1616em\",verticalAlign:\"-1.3604em\"}}),(0,n.jsx)(e.span,{className:\"mop op-limits\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.8011em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-1.8829em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,n.jsx)(e.span,{className:\"mrel mtight\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-4.3em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.3254em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mop op-limits\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.8011em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-1.8479em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"b\"}),(0,n.jsx)(e.span,{className:\"mrel mtight\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-4.3em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.3604em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02691em\"},children:\"w\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0269em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,n.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"b\"})]})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7167em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,n.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"b\"})]})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"The problem for spatial transcriptomics\"}),\": Spots are irregularly spaced and often have varying numbers of neighbors. We can't use a fixed 3\\xD73 kernel.\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"message-passing-the-key-insight\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#message-passing-the-key-insight\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Message Passing: The Key Insight\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"GNNs generalize convolution to \",(0,n.jsx)(e.strong,{children:\"arbitrary graph structures\"}),\" through message passing:\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:\"W\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsx)(e.mtext,{children:\"AGGREGATE\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"{\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\":\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"N\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"}\"}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"h_i^{(l+1)} = \\\\sigma\\\\left(W^{(l)} \\\\cdot \\\\text{AGGREGATE}\\\\{h_j^{(l)} : j \\\\in \\\\mathcal{N}(i)\\\\}\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.3217em\",verticalAlign:\"-0.2769em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.8em\",verticalAlign:\"-0.65em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\"(\"})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"W\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.938em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"AGGREGATE\"})}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"{\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.413em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\":\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mord mathcal\",style:{marginRight:\"0.14736em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")}\"}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\")\"})})]})]})]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Where:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"h_i^{(l)}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.3217em\",verticalAlign:\"-0.2769em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),\" = feature vector of node \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"i\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"i\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6595em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"})]})})]}),\" at layer \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"l\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"l\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.01968em\"},children:\"l\"})]})})]})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"N\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{N}(i)\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mord mathcal\",style:{marginRight:\"0.14736em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]}),\" = neighbors of node \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"i\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"i\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6595em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"})]})})]})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:\"W\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"W^{(l)}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.888em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"W\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.888em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})})})})})]})]})})]}),\" = learnable weight matrix\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"\\u03C3\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\sigma\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"})]})})]}),\" = activation function (ReLU, etc.)\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"This is conceptually similar to CNN convolution, but:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Neighbors are defined by \",(0,n.jsx)(e.strong,{children:\"edges\"}),\", not spatial proximity on a grid\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Each node can have a \",(0,n.jsx)(e.strong,{children:\"variable number\"}),\" of neighbors\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Weights are \",(0,n.jsx)(e.strong,{children:\"shared across all nodes\"}),\", just like CNN filters\"]}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"core-gnn-architectures\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#core-gnn-architectures\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Core GNN Architectures\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"1-graph-convolutional-network-gcn\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#1-graph-convolutional-network-gcn\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"1. Graph Convolutional Network (GCN)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Paper\"}),\": Kipf & Welling (2017)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Core Idea\"}),\": Normalize neighbor aggregation by degree to prevent scale issues.\"]}),`\n`,(0,n.jsxs)(e.h4,{id:\"mathematical-formulation\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#mathematical-formulation\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Mathematical Formulation\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Given:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"X\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"R\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"N\"}),(0,n.jsx)(e.mo,{children:\"\\xD7\"}),(0,n.jsx)(e.mi,{children:\"F\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbf{X} \\\\in \\\\mathbb{R}^{N \\\\times F}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7252em\",verticalAlign:\"-0.0391em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"X\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.8413em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbb\",children:\"R\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.10903em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"\\xD7\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.13889em\"},children:\"F\"})]})})]})})})})})]})]})]})]}),\": node features (N spots, F genes)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"R\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"N\"}),(0,n.jsx)(e.mo,{children:\"\\xD7\"}),(0,n.jsx)(e.mi,{children:\"N\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbf{A} \\\\in \\\\mathbb{R}^{N \\\\times N}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7252em\",verticalAlign:\"-0.0391em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.8413em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbb\",children:\"R\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.10903em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"\\xD7\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.10903em\"},children:\"N\"})]})})]})})})})})]})]})]})]}),\": adjacency matrix\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbf{D}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6861em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]})})]}),\": degree matrix (diagonal, where \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"D\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"i\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsx)(e.mi,{children:\"j\"})]}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"A\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"D_{ii} = \\\\sum_j A_{ij}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"ii\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.1858em\",verticalAlign:\"-0.4358em\"}}),(0,n.jsxs)(e.span,{className:\"mop\",children:[(0,n.jsx)(e.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.162em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.4358em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]}),\")\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Add self-loops and normalize:\"}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"I\"}),(0,n.jsx)(e.mspace,{width:\"1em\"}),(0,n.jsx)(e.mtext,{children:\"(add\\xA0self-connections)\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\tilde{\\\\mathbf{A}} = \\\\mathbf{A} + \\\\mathbf{I} \\\\quad \\\\text{(add self-connections)}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.923em\"}}),(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1111em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7694em\",verticalAlign:\"-0.0833em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"I\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"(add\\xA0self-connections)\"})})]})]})]})}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"i\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.munder,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsx)(e.mi,{children:\"j\"})]}),(0,n.jsxs)(e.msub,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{children:\"A\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mspace,{width:\"1em\"}),(0,n.jsx)(e.mtext,{children:\"(recompute\\xA0degrees)\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\tilde{D}_{ii} = \\\\sum_j \\\\tilde{A}_{ij} \\\\quad \\\\text{(recompute degrees)}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.0702em\",verticalAlign:\"-0.15em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.9202em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6023em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"ii\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"2.4638em\",verticalAlign:\"-1.4138em\"}}),(0,n.jsx)(e.span,{className:\"mop op-limits\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-1.8723em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.4138em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.9202em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"A\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6023em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1111em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"(recompute\\xA0degrees)\"})})]})]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"The GCN layer performs symmetric normalization:\"}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"H\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]}),(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.msup,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"H\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"W\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbf{H}^{(l+1)} = \\\\sigma\\\\left(\\\\tilde{\\\\mathbf{D}}^{-1/2} \\\\tilde{\\\\mathbf{A}} \\\\tilde{\\\\mathbf{D}}^{-1/2} \\\\mathbf{H}^{(l)} \\\\mathbf{W}^{(l)}\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.938em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.938em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.8em\",verticalAlign:\"-0.65em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\"(\"})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.938em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1/2\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1111em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.938em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1/2\"})]})})]})})})})})]}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"H\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.938em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})})})})})]}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",style:{marginRight:\"0.01597em\"},children:\"W\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.938em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\")\"})})]})]})]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Intuition\"}),\": The symmetric normalization \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msup,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]}),(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.msup,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\tilde{\\\\mathbf{D}}^{-1/2} \\\\tilde{\\\\mathbf{A}} \\\\tilde{\\\\mathbf{D}}^{-1/2}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.923em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.888em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1/2\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1111em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.888em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1/2\"})]})})]})})})})})]})]})})]}),\" creates a normalized adjacency that averages features fairly across neighbors, preventing high-degree nodes from dominating.\"]}),`\n`,(0,n.jsxs)(e.h4,{id:\"pytorch-implementation-matrix-form\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#pytorch-implementation-matrix-form\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"PyTorch Implementation (Matrix Form)\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" normalize_adj\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(edge_index, num_nodes):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Build symmetric normalized adjacency: D^{-1/2} A D^{-1/2}\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Returns sparse tensor indices and values.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    i, j \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" edge_index\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Add self-loops\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    self_loops \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.arange(num_nodes, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"device\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"edge_index.device)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.cat([i, self_loops])\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    j \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.cat([j, self_loops])\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Compute degree\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    deg \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.bincount(j, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"minlength\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"num_nodes).float()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    deg_inv_sqrt \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" deg.clamp(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"min\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").pow(\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Symmetric normalization weights\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    vals \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" deg_inv_sqrt[i] \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" deg_inv_sqrt[j]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.stack([i, j], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"), vals\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" GCNLayer\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Graph Convolutional Layer with sparse adjacency multiply.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, out_channels, bias\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"True\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".lin \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(in_channels, out_channels, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"bias\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"bias)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        N \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x.size(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        idx, vals \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" normalize_adj(edge_index, N)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        A_norm \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.sparse_coo_tensor(idx, vals, (N, N), \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"device\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"x.device)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".lin(x)                    \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [N, F_out]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.sparse.mm(A_norm, x)     \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Sparse matrix multiply\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.relu(x)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Full GCN Model\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" GCN\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, hidden_channels, out_channels, num_layers\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(GCNLayer(in_channels, hidden_channels))\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" _ \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(num_layers \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 2\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"            self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(GCNLayer(hidden_channels, hidden_channels))\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(GCNLayer(hidden_channels, out_channels))\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i, layer \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" enumerate\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers[:\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" layer(x, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.relu(x)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.dropout(x, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"p\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"train\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers[\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"](x, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Strengths\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Simple, efficient, mathematically principled\"}),`\n`,(0,n.jsx)(e.li,{children:\"Fast on small-to-medium graphs\"}),`\n`,(0,n.jsx)(e.li,{children:\"Smooth aggregation good for homogeneous tissue\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Weaknesses\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Fixed (isotropic) weights\\u2014all neighbors treated equally\"}),`\n`,(0,n.jsx)(e.li,{children:\"Transductive (needs full graph at training)\"}),`\n`,(0,n.jsx)(e.li,{children:\"Over-smoothing with many layers\"}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"2-graphsage\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#2-graphsage\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"2. GraphSAGE\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Paper\"}),\": Hamilton et al. (2017)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Core Idea\"}),\": Sample neighbors and use robust aggregators (mean, LSTM, max-pool) to scale to large graphs and enable \",(0,n.jsx)(e.strong,{children:\"inductive learning\"}),\" (generalize to unseen nodes/graphs).\"]}),`\n`,(0,n.jsxs)(e.h4,{id:\"update-rule\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#update-rule\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Update Rule\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"W\"}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsx)(e.mtext,{children:\"CONCAT\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"[\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mtext,{children:\"AGG\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"{\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\":\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"N\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"}\"}),(0,n.jsx)(e.mo,{fence:\"true\",children:\"]\"})]}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"h_i^{(l+1)} = \\\\sigma\\\\left(\\\\mathbf{W} \\\\cdot \\\\text{CONCAT}\\\\left[h_i^{(l)}, \\\\text{AGG}\\\\{h_j^{(l)} : j \\\\in \\\\mathcal{N}(i)\\\\}\\\\right]\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.3217em\",verticalAlign:\"-0.2769em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.8em\",verticalAlign:\"-0.65em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\"(\"})}),(0,n.jsx)(e.span,{className:\"mord mathbf\",style:{marginRight:\"0.01597em\"},children:\"W\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"CONCAT\"})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\"[\"})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"AGG\"})}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"{\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.413em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\":\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mord mathcal\",style:{marginRight:\"0.14736em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")}\"}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\"]\"})})]}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size2\",children:\")\"})})]})]})]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Key differences from GCN:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Concatenate\"}),\" self-feature with aggregated neighbors (preserves identity)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Sample\"}),\" a fixed number of neighbors (e.g., 10) instead of using all\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Aggregator\"}),\" choices: mean, max-pool, LSTM\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h4,{id:\"pytorch-implementation\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#pytorch-implementation\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"PyTorch Implementation\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn.functional \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" SAGEConv\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    GraphSAGE layer with mean aggregation.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, out_channels, normalize\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"True\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".lin_self \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(in_channels, out_channels)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".lin_neigh \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(in_channels, out_channels)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".normalize \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" normalize\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index, num_neighbors_sample\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        N \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x.size(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Sample neighbors (for scalability)\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        src, dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" edge_index\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Group by destination\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {}\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" s, d \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" zip\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(src.tolist(), dst.tolist()):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            neighbors.setdefault(d, []).append(s)\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Sample and aggregate\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        neigh_features \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" []\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(N):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"            if\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"and\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" len\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(neighbors[i]) \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\">\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                sampled \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                    neighbors[i][:num_neighbors_sample],\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"                    device\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"x.device\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                )\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                neigh_features.append(x[sampled].mean(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"))\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"            else\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                neigh_features.append(torch.zeros(x.size(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"), \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"device\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"x.device))\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        neigh_agg \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.stack(neigh_features)  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [N, F]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Combine self and neighbor\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        out \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".lin_self(x) \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".lin_neigh(neigh_agg)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        if\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".normalize:\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            out \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.normalize(out, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"p\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" out\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" GraphSAGE\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, hidden_channels, out_channels, num_layers\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(SAGEConv(in_channels, hidden_channels))\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" _ \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(num_layers \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 2\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"            self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(SAGEConv(hidden_channels, hidden_channels))\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(SAGEConv(hidden_channels, out_channels))\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" layer \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers[:\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]:\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" layer(x, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.relu(x)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.dropout(x, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"p\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"training\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".layers[\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"](x, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Strengths\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Scales to massive graphs via neighbor sampling\"}),`\n`,(0,n.jsx)(e.li,{children:\"Inductive: can generalize to new slides without retraining\"}),`\n`,(0,n.jsx)(e.li,{children:\"Multiple aggregator options\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Weaknesses\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Sampling introduces variance\"}),`\n`,(0,n.jsx)(e.li,{children:\"More hyperparameters (sample size per layer)\"}),`\n`,(0,n.jsx)(e.li,{children:\"Still treats all sampled neighbors equally\"}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"3-graph-attention-network-gat\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#3-graph-attention-network-gat\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3. Graph Attention Network (GAT)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Paper\"}),\": Veli\\u010Dkovi\\u0107 et al. (2018)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Core Idea\"}),\": Learn \",(0,n.jsx)(e.strong,{children:\"per-edge attention weights\"}),\" so the model can focus on important neighbors and ignore noisy ones.\"]}),`\n`,(0,n.jsxs)(e.h4,{id:\"attention-mechanism\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#attention-mechanism\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Attention Mechanism\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"For each edge \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"(i, j)\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]}),\":\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"e\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mtext,{children:\"LeakyReLU\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"a\"}),(0,n.jsx)(e.mi,{children:\"T\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"[\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"W\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"})]}),(0,n.jsx)(e.mtext,{children:\"\\u2009\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,n.jsx)(e.mtext,{children:\"\\u2009\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"W\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"j\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"]\"}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"e_{ij} = \\\\text{LeakyReLU}\\\\left(\\\\mathbf{a}^T [\\\\mathbf{W} h_i \\\\,||\\\\, \\\\mathbf{W} h_j]\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7167em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"e\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.2413em\",verticalAlign:\"-0.35em\"}}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"LeakyReLU\"})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size1\",children:\"(\"})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"a\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8913em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.13889em\"},children:\"T\"})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"mord mathbf\",style:{marginRight:\"0.01597em\"},children:\"W\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"\\u2223\\u2223\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",style:{marginRight:\"0.01597em\"},children:\"W\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size1\",children:\")\"})})]})]})]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Normalize with softmax over all neighbors:\"}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"\\u03B1\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"exp\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"e\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.munder,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"k\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"N\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mi,{children:\"exp\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"e\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"k\"})]})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\alpha_{ij} = \\\\frac{\\\\exp(e_{ij})}{\\\\sum_{k \\\\in \\\\mathcal{N}(i)} \\\\exp(e_{ik})}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7167em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0037em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"2.5877em\",verticalAlign:\"-1.1607em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mopen nulldelimiter\"}),(0,n.jsx)(e.span,{className:\"mfrac\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.427em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.314em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsxs)(e.span,{className:\"mop\",children:[(0,n.jsx)(e.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2253em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"}),(0,n.jsx)(e.span,{className:\"mrel mtight\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mord mathcal mtight\",style:{marginRight:\"0.14736em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.4747em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"e\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"ik\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.23em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.677em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"e\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.1607em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mclose nulldelimiter\"})]})]})]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Aggregate with learned weights:\"}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsxs)(e.munder,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"N\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"\\u03B1\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"W\"}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"h_i^{(l+1)} = \\\\sigma\\\\left(\\\\sum_{j \\\\in \\\\mathcal{N}(i)} \\\\alpha_{ij} \\\\cdot \\\\mathbf{W} \\\\cdot h_j^{(l)}\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.3217em\",verticalAlign:\"-0.2769em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"3.6em\",verticalAlign:\"-1.55em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen\",children:(0,n.jsx)(e.span,{className:\"delimsizing mult\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"2.05em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-4.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"5.6em\"}}),(0,n.jsx)(e.span,{style:{width:\"0.875em\",height:\"3.600em\"},children:(0,n.jsx)(e.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"0.875em\",height:\"3.600em\",viewBox:\"0 0 875 3600\",children:(0,n.jsx)(e.path,{d:`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1\nc-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,\n-36,557 l0,84c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,\n949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9\nc0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,\n-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189\nl0,-92c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,\n-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.55em\"},children:(0,n.jsx)(e.span,{})})})]})})}),(0,n.jsx)(e.span,{className:\"mop op-limits\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-1.809em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mrel mtight\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mord mathcal mtight\",style:{marginRight:\"0.14736em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.516em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0037em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",style:{marginRight:\"0.01597em\"},children:\"W\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.413em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:(0,n.jsx)(e.span,{className:\"delimsizing mult\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"2.05em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-4.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"5.6em\"}}),(0,n.jsx)(e.span,{style:{width:\"0.875em\",height:\"3.600em\"},children:(0,n.jsx)(e.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"0.875em\",height:\"3.600em\",viewBox:\"0 0 875 3600\",children:(0,n.jsx)(e.path,{d:`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,\n63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5\nc11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,9\nc-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664\nc-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11\nc0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17\nc242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558\nl0,-144c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,\n-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.55em\"},children:(0,n.jsx)(e.span,{})})})]})})})]})]})]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Multi-head attention\"}),\" (like Transformers): Run \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"K\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"K\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"K\"})]})})]}),\" independent attention heads and concatenate:\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mo,{fence:\"false\",stretchy:\"true\",minsize:\"1.8em\",maxsize:\"1.8em\",children:\"\\u2223\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mo,{fence:\"false\",stretchy:\"true\",minsize:\"1.8em\",maxsize:\"1.8em\",children:\"\\u2223\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"k\"}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mn,{children:\"1\"})]}),(0,n.jsx)(e.mi,{children:\"K\"})]}),(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsxs)(e.munder,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"N\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"\\u03B1\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]}),(0,n.jsx)(e.mi,{children:\"k\"})]}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"W\"}),(0,n.jsx)(e.mi,{children:\"k\"})]}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"h\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"l\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"h_i^{(l+1)} = \\\\Big|\\\\Big|_{k=1}^K \\\\sigma\\\\left(\\\\sum_{j \\\\in \\\\mathcal{N}(i)} \\\\alpha_{ij}^k \\\\cdot \\\\mathbf{W}^k \\\\cdot h_j^{(l)}\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.3217em\",verticalAlign:\"-0.2769em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"3.6em\",verticalAlign:\"-1.55em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:(0,n.jsx)(e.span,{className:\"delimsizing mult\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.15em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.15em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.8em\"}}),(0,n.jsx)(e.span,{style:{width:\"0.333em\",height:\"1.800em\"},children:(0,n.jsx)(e.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"0.333em\",height:\"1.800em\",viewBox:\"0 0 333 1800\",children:(0,n.jsx)(e.path,{d:`M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z`})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.65em\"},children:(0,n.jsx)(e.span,{})})})]})})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\",children:(0,n.jsx)(e.span,{className:\"delimsizing mult\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.15em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.15em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.8em\"}}),(0,n.jsx)(e.span,{style:{width:\"0.333em\",height:\"1.800em\"},children:(0,n.jsx)(e.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"0.333em\",height:\"1.800em\",viewBox:\"0 0 333 1800\",children:(0,n.jsx)(e.path,{d:`M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z`})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.65em\"},children:(0,n.jsx)(e.span,{})})})]})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.3812em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.0003em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"}),(0,n.jsx)(e.span,{className:\"mrel mtight\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6029em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.07153em\"},children:\"K\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.6997em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen\",children:(0,n.jsx)(e.span,{className:\"delimsizing mult\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"2.05em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-4.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"5.6em\"}}),(0,n.jsx)(e.span,{style:{width:\"0.875em\",height:\"3.600em\"},children:(0,n.jsx)(e.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"0.875em\",height:\"3.600em\",viewBox:\"0 0 875 3600\",children:(0,n.jsx)(e.path,{d:`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1\nc-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,\n-36,557 l0,84c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,\n949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9\nc0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,\n-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189\nl0,-92c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,\n-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.55em\"},children:(0,n.jsx)(e.span,{})})})]})})}),(0,n.jsx)(e.span,{className:\"mop op-limits\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-1.809em\",marginLeft:\"0em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsx)(e.span,{className:\"mrel mtight\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mord mathcal mtight\",style:{marginRight:\"0.14736em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.516em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.453em\",marginLeft:\"-0.0037em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3831em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",style:{marginRight:\"0.01597em\"},children:\"W\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.01968em\"},children:\"l\"}),(0,n.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.413em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:(0,n.jsx)(e.span,{className:\"delimsizing mult\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"2.05em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-4.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"5.6em\"}}),(0,n.jsx)(e.span,{style:{width:\"0.875em\",height:\"3.600em\"},children:(0,n.jsx)(e.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"0.875em\",height:\"3.600em\",viewBox:\"0 0 875 3600\",children:(0,n.jsx)(e.path,{d:`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,\n63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5\nc11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,9\nc-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664\nc-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11\nc0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17\nc242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558\nl0,-144c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,\n-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.55em\"},children:(0,n.jsx)(e.span,{})})})]})})})]})]})]})]})}),`\n`,(0,n.jsxs)(e.h4,{id:\"pytorch-implementation-1\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#pytorch-implementation-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"PyTorch Implementation\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn.functional \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" GATLayer\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Graph Attention Layer (single head).\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, out_channels, dropout\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", alpha\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.2\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".W \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(in_channels, out_channels, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"bias\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"False\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".a \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Parameter(torch.zeros(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"size\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" *\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" out_channels, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")))\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".leakyrelu \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.LeakyReLU(alpha)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".dropout \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" dropout\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        nn.init.xavier_uniform_(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".a.data, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"gain\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1.414\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Linear transformation\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        Wh \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".W(x)  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [N, out_channels]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        N \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Wh.size(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Compute attention coefficients\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        src, dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" edge_index\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Concatenate source and destination features\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        Wh_src \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Wh[src]  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [E, out_channels]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        Wh_dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Wh[dst]  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [E, out_channels]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        concat_features \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.cat([Wh_src, Wh_dst], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [E, 2*out_channels]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Attention mechanism\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        e \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".leakyrelu(concat_features \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"@\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".a).squeeze()  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [E]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Normalize per destination node\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        attention \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.zeros(N, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"device\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"x.device)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        attention_weights \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.zeros_like(e)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(N):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            mask \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"==\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"            if\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" mask.sum() \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\">\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                e_neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" e[mask]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                alpha \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.softmax(e_neighbors, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                attention_weights[mask] \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" alpha\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Apply dropout to attention\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        attention_weights \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.dropout(attention_weights, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".dropout, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"training\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Aggregate\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        out \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.zeros_like(Wh)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(N):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            mask \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"==\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"            if\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" mask.sum() \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\">\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                out[i] \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (attention_weights[mask].unsqueeze(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Wh[src[mask]]).sum(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" out\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" GAT\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, hidden_channels, out_channels,\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"                 num_heads\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"8\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", dropout\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".dropout \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" dropout\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Multi-head first layer\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".attentions \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList([\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            GATLayer(in_channels, hidden_channels, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dropout\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"dropout)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"            for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" _ \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(num_heads)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        ])\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Single-head output layer\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".out_att \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" GATLayer(\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            hidden_channels \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" num_heads,\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            out_channels,\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"            dropout\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"dropout\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        )\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # First layer: concatenate multi-head outputs\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.cat([att(x, edge_index) \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" att \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".attentions], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.dropout(x, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".dropout, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"training\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.elu(x)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Output layer\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".out_att(x, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Strengths\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Learns which neighbors are important (anisotropic)\"}),`\n`,(0,n.jsx)(e.li,{children:\"Better at handling heterogeneous neighborhoods\"}),`\n`,(0,n.jsx)(e.li,{children:\"Respects sharp boundaries (e.g., tumor-stroma)\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Weaknesses\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"More parameters (attention + multi-heads)\"}),`\n`,(0,n.jsx)(e.li,{children:\"Slower than GCN\"}),`\n`,(0,n.jsx)(e.li,{children:\"Can be unstable (needs careful tuning of dropout, LR)\"}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"architecture-comparison-table\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#architecture-comparison-table\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Architecture Comparison Table\"]}),`\n`,(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:\"Model\"}),(0,n.jsx)(e.th,{children:\"Neighbor Weights\"}),(0,n.jsx)(e.th,{children:\"Sampling\"}),(0,n.jsx)(e.th,{children:\"Inductive?\"}),(0,n.jsx)(e.th,{children:\"Best Use Case\"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"GCN\"})}),(0,n.jsx)(e.td,{children:\"Fixed by normalized adjacency\"}),(0,n.jsx)(e.td,{children:\"Full graph (no sampling)\"}),(0,n.jsx)(e.td,{children:\"No (transductive)\"}),(0,n.jsx)(e.td,{children:\"Smooth tissue, clean spatial graphs, small-medium datasets\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"GraphSAGE\"})}),(0,n.jsx)(e.td,{children:\"Fixed aggregator (mean/max/LSTM)\"}),(0,n.jsx)(e.td,{children:\"Neighborhood sampling\"}),(0,n.jsx)(e.td,{children:\"Yes\"}),(0,n.jsx)(e.td,{children:\"Large graphs, multiple slides, production systems\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"GAT\"})}),(0,n.jsx)(e.td,{children:\"Learned per-edge attention\"}),(0,n.jsx)(e.td,{children:\"Full neighborhood (or can sample)\"}),(0,n.jsx)(e.td,{children:\"Often yes\"}),(0,n.jsx)(e.td,{children:\"Heterogeneous tissue, sharp boundaries, variable neighbor quality\"})]})]})]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Visual Comparison\"}),\":\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`GCN:      All neighbors weighted equally (by degree normalization)\n          [Spot] \\u2190 (0.25, 0.25, 0.25, 0.25) \\u2190 [4 neighbors]\n\nGraphSAGE: Sample subset, aggregate with mean/max\n          [Spot] \\u2190 sample 2 \\u2192 mean([n1, n2])\n\nGAT:      Learn attention per edge\n          [Spot] \\u2190 (\\u03B1\\u2081=0.5, \\u03B1\\u2082=0.3, \\u03B1\\u2083=0.15, \\u03B1\\u2084=0.05) \\u2190 [4 neighbors]\n                    \\u2191 Learned weights\n`})}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"graph-construction-strategies\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#graph-construction-strategies\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Graph Construction Strategies\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Critical insight\"}),\": Graph topology often matters more than the GNN architecture.\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"1-spatial-proximity-graphs\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#1-spatial-proximity-graphs\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"1. Spatial Proximity Graphs\"]}),`\n`,(0,n.jsxs)(e.h4,{id:\"k-nearest-neighbors-knn\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#k-nearest-neighbors-knn\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"k-Nearest Neighbors (kNN)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Connect each spot to its \",(0,n.jsx)(e.code,{children:\"k\"}),\" closest spatial neighbors.\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" numpy \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" knn_graph\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords, k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Build kNN graph from spatial coordinates.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Args:\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        coords: [N, 2] array of (x, y) positions\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        k: number of neighbors\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Returns:\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        edge_index: [2, E] tensor in COO format\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    nbrs \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_neighbors\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"algorithm\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'kd_tree'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").fit(coords)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    distances, indices \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nbrs.kneighbors(coords)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Exclude self (first neighbor)\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    src \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.repeat(np.arange(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"len\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords)), k)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" indices[:, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":].reshape(\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Make undirected\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.stack([src, dst], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.concatenate([edge_index, edge_index[::\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.unique(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.as_tensor(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Pros\"}),`: Simple, controllable density\n`,(0,n.jsx)(e.strong,{children:\"Cons\"}),\": Fixed \",(0,n.jsx)(e.code,{children:\"k\"}),\" ignores tissue density variation\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsxs)(e.strong,{children:[\"Effect of \",(0,n.jsx)(e.code,{children:\"k\"}),\" on smoothing\"]}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.strong,{children:[\"Small \",(0,n.jsx)(e.code,{children:\"k\"}),\" (4-6)\"]}),\": Preserves sharp boundaries, less smoothing\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.strong,{children:[\"Large \",(0,n.jsx)(e.code,{children:\"k\"}),\" (12-20)\"]}),\": More smoothing, boundaries blur, risk of over-smoothing\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h4,{id:\"radius-\\u03B5-ball-graph\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#radius-\\u03B5-ball-graph\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Radius (\\u03B5-ball) Graph\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Connect all spots within distance \",(0,n.jsx)(e.code,{children:\"\\u03B5\"}),\".\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" radius_graph\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords, radius\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"100.0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Build radius graph: connect nodes within distance threshold.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" radius_neighbors_graph\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    A \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" radius_neighbors_graph(coords, radius, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"mode\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'connectivity'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.as_tensor(np.array(A.nonzero()), \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" edge_index\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Pros\"}),`: Density-adaptive, physically meaningful\n`,(0,n.jsx)(e.strong,{children:\"Cons\"}),\": Can create disconnected components if \",(0,n.jsx)(e.code,{children:\"\\u03B5\"}),\" too small\"]}),`\n`,(0,n.jsxs)(e.h4,{id:\"delaunay-triangulation\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#delaunay-triangulation\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Delaunay Triangulation\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Build triangles connecting nearest points without overlap\\u2014preserves natural geometry.\"}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" scipy.spatial \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Delaunay\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" numpy \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" delaunay_graph\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Build graph from Delaunay triangulation.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Used in SpaGCN for natural spatial connectivity.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    tri \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" Delaunay(coords)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edges \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" set\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" simplex \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" tri.simplices:\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"3\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            edge \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" tuple\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"sorted\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"([simplex[i], simplex[(i\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"%\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"3\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]]))\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            edges.add(edge)\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edges \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.array(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"list\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(edges)).T\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Make undirected\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.concatenate([edges, edges[::\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.as_tensor(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Pros\"}),`: Natural geometric structure, used in SpaGCN\n`,(0,n.jsx)(e.strong,{children:\"Cons\"}),\": Can create long edges in sparse regions\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"2-expression-similarity-graphs\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#2-expression-similarity-graphs\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"2. Expression Similarity Graphs\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Connect spots with similar gene expression, independent of distance.\"}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" expression_similarity_graph\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(X, k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", metric\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'cosine'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Build kNN graph in expression space.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Args:\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        X: [N, genes] expression matrix\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        k: number of neighbors\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        metric: 'cosine' or 'euclidean'\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    nbrs \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_neighbors\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"metric\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"metric).fit(X)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    distances, indices \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nbrs.kneighbors(X)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    src \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.repeat(np.arange(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"len\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(X)), k)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" indices[:, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":].reshape(\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.stack([src, dst], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Undirected\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.concatenate([edge_index, edge_index[::\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.unique(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.as_tensor(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Pros\"}),`: Captures functional/molecular similarity\n`,(0,n.jsx)(e.strong,{children:\"Cons\"}),\": May connect distant regions; ignores spatial structure\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"3-hybrid-multi-view-graphs\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#3-hybrid-multi-view-graphs\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3. Hybrid (Multi-view) Graphs\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Combine spatial and expression information.\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Weighted combination\"}),\":\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{children:\"\\u03B1\"}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mtext,{children:\"spatial\"})]}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mi,{children:\"\\u03B1\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mtext,{children:\"expression\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbf{A} = \\\\alpha \\\\cdot \\\\mathbf{A}_{\\\\text{spatial}} + (1 - \\\\alpha) \\\\cdot \\\\mathbf{A}_{\\\\text{expression}}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6861em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.4445em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.9722em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"spatial\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.9722em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3175em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"expression\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Learnable weighting\"}),\":\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" MultiViewGNN\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, out_channels):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".gcn_spatial \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" GCNLayer(in_channels, out_channels)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".gcn_expression \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" GCNLayer(in_channels, out_channels)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".alpha \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Parameter(torch.tensor(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"))  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Learnable weight\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index_spatial, edge_index_expr):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        h_spatial \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".gcn_spatial(x, edge_index_spatial)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        h_expr \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".gcn_expression(x, edge_index_expr)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        alpha \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.sigmoid(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".alpha)  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Ensure [0,1]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" alpha \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" h_spatial \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" -\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" alpha) \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" h_expr\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Used in\"}),\": STAGATE, conST, GraphST\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"4-image-based-graphs-histology-integration\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#4-image-based-graphs-histology-integration\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"4. Image-Based Graphs (Histology Integration)\"]}),`\n`,(0,n.jsx)(e.p,{children:\"If H&E images are available, use morphological similarity.\"}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" image_weighted_graph\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords, image_features, k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", alpha\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Weighted graph combining spatial distance and image feature similarity.\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"    Args:\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        coords: [N, 2] spatial positions\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        image_features: [N, D] CNN features from histology patches\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"        alpha: weight between spatial and image (0=spatial only, 1=image only)\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.metrics.pairwise \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" cosine_similarity\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Spatial kNN\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    nbrs_spatial \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_neighbors\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").fit(coords)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    dist_spatial, idx_spatial \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nbrs_spatial.kneighbors(coords)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Image similarity\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    img_sim \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" cosine_similarity(image_features)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edges \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" []\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    weights \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" []\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"len\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords)):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" j_idx, j \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" enumerate\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(idx_spatial[i, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":]):  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Skip self\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            spatial_sim \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 1.0\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" /\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1.0\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" +\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" dist_spatial[i, j_idx\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"])\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            image_sim_val \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" img_sim[i, j]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            combined_weight \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" alpha \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" spatial_sim \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" -\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" alpha) \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" image_sim_val\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            edges.append([i, j])\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            weights.append(combined_weight)\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(edges, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long).T\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_weight \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(weights, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.float)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" edge_index, edge_weight\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Used in\"}),\": SpaGCN, conST, MERGE\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"state-of-the-art-methods-in-spatial-transcriptomics\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#state-of-the-art-methods-in-spatial-transcriptomics\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"State-of-the-Art Methods in Spatial Transcriptomics\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"method-comparison-table\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#method-comparison-table\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Method Comparison Table\"]}),`\n`,(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:\"Method\"}),(0,n.jsx)(e.th,{children:\"Year\"}),(0,n.jsx)(e.th,{children:\"Graph Type\"}),(0,n.jsx)(e.th,{children:\"GNN Architecture\"}),(0,n.jsx)(e.th,{children:\"Key Innovation\"}),(0,n.jsx)(e.th,{children:\"Task\"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"SpaGCN\"})}),(0,n.jsx)(e.td,{children:\"2021\"}),(0,n.jsx)(e.td,{children:\"Spatial + histology weighted\"}),(0,n.jsx)(e.td,{children:\"GCN\"}),(0,n.jsx)(e.td,{children:\"Delaunay + image features, domain detection\"}),(0,n.jsx)(e.td,{children:\"Clustering, SVG detection\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"STAGATE\"})}),(0,n.jsx)(e.td,{children:\"2022\"}),(0,n.jsx)(e.td,{children:\"Spatial kNN\"}),(0,n.jsx)(e.td,{children:\"Graph Attention Autoencoder\"}),(0,n.jsx)(e.td,{children:\"Learned attention, autoencoder framework\"}),(0,n.jsx)(e.td,{children:\"Clustering, denoising, trajectory\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"SEDR\"})}),(0,n.jsx)(e.td,{children:\"2021\"}),(0,n.jsx)(e.td,{children:\"Spatial kNN\"}),(0,n.jsx)(e.td,{children:\"VGAE + deep autoencoder\"}),(0,n.jsx)(e.td,{children:\"Dual embedding (expression + spatial VGAE)\"}),(0,n.jsx)(e.td,{children:\"Clustering, embedding\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"GraphST\"})}),(0,n.jsx)(e.td,{children:\"2023\"}),(0,n.jsx)(e.td,{children:\"Multi-view (spatial + expr)\"}),(0,n.jsx)(e.td,{children:\"GCN + contrastive learning\"}),(0,n.jsx)(e.td,{children:\"Self-supervised contrastive, multi-sample integration\"}),(0,n.jsx)(e.td,{children:\"Clustering, deconvolution\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"STdGCN\"})}),(0,n.jsx)(e.td,{children:\"2023\"}),(0,n.jsx)(e.td,{children:\"Hybrid (spot + pseudo-spot)\"}),(0,n.jsx)(e.td,{children:\"GCN\"}),(0,n.jsx)(e.td,{children:\"Integrate scRNA reference via hybrid graph\"}),(0,n.jsx)(e.td,{children:\"Deconvolution\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"stAA\"})}),(0,n.jsx)(e.td,{children:\"2024\"}),(0,n.jsx)(e.td,{children:\"Spatial kNN\"}),(0,n.jsx)(e.td,{children:\"Adversarial VGAE\"}),(0,n.jsx)(e.td,{children:\"WGAN regularization on embeddings\"}),(0,n.jsx)(e.td,{children:\"Clustering\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"stMCDI\"})}),(0,n.jsx)(e.td,{children:\"2024\"}),(0,n.jsx)(e.td,{children:\"Spatial\"}),(0,n.jsx)(e.td,{children:\"GNN encoder in diffusion model\"}),(0,n.jsx)(e.td,{children:\"Diffusion-based imputation with GNN\"}),(0,n.jsx)(e.td,{children:\"Missing value imputation\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"MERGE\"})}),(0,n.jsx)(e.td,{children:\"2023\"}),(0,n.jsx)(e.td,{children:\"Hierarchical image patches\"}),(0,n.jsx)(e.td,{children:\"Multi-scale GNN\"}),(0,n.jsx)(e.td,{children:\"Image \\u2192 gene prediction via hierarchical graph\"}),(0,n.jsx)(e.td,{children:\"Prediction from histology\"})]})]})]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"deep-dive-spagcn\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#deep-dive-spagcn\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Deep Dive: SpaGCN\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Paper\"}),\": Hu et al., \",(0,n.jsx)(e.em,{children:\"Nature Methods\"}),\" (2021)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Problem\"}),\": Identify spatial domains using both gene expression and tissue morphology.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Graph Construction\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Build Delaunay triangulation from spot coordinates\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"Weight edges by combination of:\",`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Spatial distance\"}),`\n`,(0,n.jsx)(e.li,{children:\"Histology image similarity (compare H&E patches around each spot)\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"w\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mi,{children:\"j\"})]})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mi,{children:\"exp\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"d\"}),(0,n.jsx)(e.mtext,{children:\"spatial\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mn,{children:\"2\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsx)(e.mi,{children:\"d\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]})]}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]}),(0,n.jsx)(e.mo,{children:\"\\xD7\"}),(0,n.jsx)(e.mi,{children:\"exp\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"d\"}),(0,n.jsx)(e.mtext,{children:\"image\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mi,{children:\"j\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mn,{children:\"2\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"\\u03C3\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]})]}),(0,n.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"w_{ij} = \\\\exp\\\\left(-\\\\frac{d_{\\\\text{spatial}}(i,j)^2}{2\\\\sigma_d^2}\\\\right) \\\\times \\\\exp\\\\left(-\\\\frac{d_{\\\\text{image}}(i,j)^2}{2\\\\sigma_i^2}\\\\right)\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7167em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02691em\"},children:\"w\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0269em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"2.4784em\",verticalAlign:\"-0.9873em\"}}),(0,n.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size3\",children:\"(\"})}),(0,n.jsx)(e.span,{className:\"mord\",children:\"\\u2212\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mopen nulldelimiter\"}),(0,n.jsx)(e.span,{className:\"mfrac\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.4911em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.314em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\",children:\"2\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.7959em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.3987em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"d\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.0448em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3013em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.23em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.677em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"d\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"spatial\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsxs)(e.span,{className:\"mclose\",children:[(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})})})})})]})]})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.9873em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mclose nulldelimiter\"})]}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size3\",children:\")\"})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\xD7\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"2.454em\",verticalAlign:\"-0.9629em\"}}),(0,n.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"minner\",children:[(0,n.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size3\",children:\"(\"})}),(0,n.jsx)(e.span,{className:\"mord\",children:\"\\u2212\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mopen nulldelimiter\"}),(0,n.jsx)(e.span,{className:\"mfrac\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.4911em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.314em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord\",children:\"2\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.7959em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.0448em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.23em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.677em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"d\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3175em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"image\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05724em\"},children:\"j\"}),(0,n.jsxs)(e.span,{className:\"mclose\",children:[(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})})})})})]})]})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.9629em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mclose nulldelimiter\"})]}),(0,n.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,n.jsx)(e.span,{className:\"delimsizing size3\",children:\")\"})})]})]})]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"GNN\"}),\": Standard GCN with weighted adjacency\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Loss\"}),\": Combines:\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Clustering loss (Louvain or k-means on embeddings)\"}),`\n`,(0,n.jsx)(e.li,{children:\"Spatial regularization (neighbors should have similar cluster assignments)\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Code Sketch\"}),\":\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Weighted adjacency from spatial + image\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"A_weighted \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" spatial_weight \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" image_weight\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# GCN embedding\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"H \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" gcn_layers(X, A_weighted)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Clustering\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"clusters \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" louvain_clustering(H)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Find spatially variable genes per domain\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"svg_genes \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" differential_expression_per_domain(clusters)\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Strengths\"}),`: Multi-modal, interpretable, works well on Visium data\n`,(0,n.jsx)(e.strong,{children:\"Limitations\"}),\": Static graph, sensitive to weighting hyperparameters\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"deep-dive-stagate\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#deep-dive-stagate\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Deep Dive: STAGATE\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Paper\"}),\": Dong & Chen, \",(0,n.jsx)(e.em,{children:\"Nature Communications\"}),\" (2022)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Problem\"}),\": Learn representations robust to noise, preserve spatial structure, enable downstream tasks (clustering, pseudotime).\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Architecture\"}),\": Graph Attention Autoencoder\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Encoder\"}),\": Multi-layer GAT \\u2192 latent embedding \",(0,n.jsx)(e.code,{children:\"Z\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Decoder\"}),\": Reconstruct both expression \",(0,n.jsx)(e.code,{children:\"X\"}),\" and adjacency \",(0,n.jsx)(e.code,{children:\"A\"})]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Key Innovation\"}),\": Attention mechanism learns which neighbors are relevant, mitigating over-smoothing.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Loss\"}),\":\"]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,n.jsx)(e.mtext,{children:\"recon\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"X\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"X\"}),(0,n.jsx)(e.mo,{children:\"^\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mo,{children:\"+\"}),(0,n.jsx)(e.mi,{children:\"\\u03BB\"}),(0,n.jsx)(e.mo,{children:\"\\u22C5\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,n.jsx)(e.mtext,{children:\"graph\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"^\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{L} = \\\\mathcal{L}_{\\\\text{recon}}(\\\\mathbf{X}, \\\\hat{\\\\mathbf{X}}) + \\\\lambda \\\\cdot \\\\mathcal{L}_{\\\\text{graph}}(\\\\mathbf{A}, \\\\hat{\\\\mathbf{A}})\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,n.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.1995em\",verticalAlign:\"-0.25em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"recon\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"X\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.9495em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"X\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2551em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1667em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"^\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"+\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03BB\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,n.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.2357em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"graph\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.9495em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.2551em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1111em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"^\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Where:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,n.jsx)(e.mtext,{children:\"recon\"})]})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{L}_{\\\\text{recon}}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"recon\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),\" = MSE for expression reconstruction\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,n.jsx)(e.mtext,{children:\"graph\"})]})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{L}_{\\\\text{graph}}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"graph\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),\" = binary cross-entropy for adjacency reconstruction\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Code Outline\"}),\":\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" STAGATE\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, n_genes, hidden_dim, latent_dim):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".encoder \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList([\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            GATLayer(n_genes, hidden_dim),\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            GATLayer(hidden_dim, latent_dim)\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        ])\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".decoder_expr \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(latent_dim, n_genes)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".decoder_graph \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" InnerProductDecoder()\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Encode\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" layer \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".encoder:\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.elu(layer(h, edge_index))\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"        # Decode\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        x_recon \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".decoder_expr(h)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        adj_recon \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.sigmoid(h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"@\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" h.T)  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Inner product for adjacency\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x_recon, adj_recon, h\"})]})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Strengths\"}),`: Adaptive smoothing, rich embeddings for multiple tasks\n`,(0,n.jsx)(e.strong,{children:\"Limitations\"}),\": More hyperparameters, potential overfitting on small datasets\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"deep-dive-graphst-contrastive-learning\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#deep-dive-graphst-contrastive-learning\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Deep Dive: GraphST (Contrastive Learning)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Paper\"}),\": Long et al., \",(0,n.jsx)(e.em,{children:\"Nature Communications\"}),\" (2023)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Problem\"}),\": Integrate multiple tissue sections, perform clustering and deconvolution.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Key Idea\"}),\": Self-supervised contrastive learning on graph embeddings.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Method\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Build two views of the same graph (e.g., different augmentations or spatial vs. expression graphs)\"}),`\n`,(0,n.jsx)(e.li,{children:\"Encode both with GCN\"}),`\n`,(0,n.jsx)(e.li,{children:\"Contrastive loss: pull together embeddings from same spot, push apart different spots\"}),`\n`]}),`\n`,(0,n.jsx)(e.span,{className:\"katex-display\",children:(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,n.jsx)(e.mtext,{children:\"contrast\"})]}),(0,n.jsx)(e.mo,{children:\"=\"}),(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mi,{children:\"log\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"exp\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mtext,{children:\"sim\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"z\"}),(0,n.jsx)(e.mi,{children:\"i\"})]}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"z\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{children:\"+\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mi,{children:\"\\u03C4\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.munder,{children:[(0,n.jsx)(e.mo,{children:\"\\u2211\"}),(0,n.jsx)(e.mi,{children:\"j\"})]}),(0,n.jsx)(e.mi,{children:\"exp\"}),(0,n.jsx)(e.mo,{children:\"\\u2061\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsx)(e.mtext,{children:\"sim\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"z\"}),(0,n.jsx)(e.mi,{children:\"i\"})]}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\"z\"}),(0,n.jsx)(e.mi,{children:\"j\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mi,{children:\"\\u03C4\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{L}_{\\\\text{contrast}} = -\\\\log\\\\frac{\\\\exp(\\\\text{sim}(z_i, z_i^+) / \\\\tau)}{\\\\sum_j \\\\exp(\\\\text{sim}(z_i, z_j) / \\\\tau)}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:(0,n.jsx)(e.span,{className:\"mord text mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"contrast\"})})})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"2.6103em\",verticalAlign:\"-1.1218em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mop\",children:[\"lo\",(0,n.jsx)(e.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mopen nulldelimiter\"}),(0,n.jsx)(e.span,{className:\"mfrac\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.4885em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.314em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsxs)(e.span,{className:\"mop\",children:[(0,n.jsx)(e.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.162em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.4358em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"sim\"})}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,n.jsx)(e.span,{className:\"mord\",children:\"/\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.23em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.677em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"mord text\",children:(0,n.jsx)(e.span,{className:\"mord\",children:\"sim\"})}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.8115em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.1031em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,n.jsx)(e.span,{className:\"mord\",children:\"/\"}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"1.1218em\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\"mclose nulldelimiter\"})]})]})]})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Where \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:\"z\"}),(0,n.jsx)(e.mi,{children:\"i\"}),(0,n.jsx)(e.mo,{children:\"+\"})]})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"z_i^+\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.0883em\",verticalAlign:\"-0.2769em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,n.jsxs)(e.span,{className:\"vlist-r\",children:[(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.8115em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-2.4231em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.1031em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"})})]})]}),(0,n.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),\" is the augmented view of spot \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"i\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"i\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6595em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"i\"})]})})]}),\".\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Benefits\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Learns robust representations without labeled data\"}),`\n`,(0,n.jsx)(e.li,{children:\"Aligns multiple slides in shared embedding space\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Code Sketch\"}),\":\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Create two views\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"edge_index_view1 \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" knn_graph(coords, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"edge_index_view2 \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" expression_similarity_graph(X, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Encode both\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"z1 \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" gnn_encoder(X, edge_index_view1)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"z2 \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" gnn_encoder(X, edge_index_view2)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Contrastive loss (InfoNCE)\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"loss \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" contrastive_loss(z1, z2, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"temperature\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"implementation-guide\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#implementation-guide\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Implementation Guide\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"complete-pipeline-spatial-domain-detection\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#complete-pipeline-spatial-domain-detection\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Complete Pipeline: Spatial Domain Detection\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Here's a complete, runnable pipeline from raw Visium data to domain detection using a GNN.\"}),`\n`,(0,n.jsxs)(e.h4,{id:\"step-1-load-data\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#step-1-load-data\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 1: Load Data\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" scanpy \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sc\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" numpy \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.preprocessing \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" StandardScaler\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Load Visium data (standard scanpy format)\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"adata \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sc.read_visium(\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"path/to/visium/data\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Extract coordinates and expression\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"coords \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" adata.obsm[\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'spatial'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [N, 2]\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"X \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" adata.X.toarray() \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"if\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" hasattr\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(adata.X, \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'toarray'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"else\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" adata.X  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# [N, genes]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Highly variable genes\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"sc.pp.highly_variable_genes(adata, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_top_genes\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2000\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"X \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" X[:, adata.var[\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'highly_variable'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Normalize\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"X \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" StandardScaler().fit_transform(X)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# To tensors\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"X_tensor \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(X, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.float32)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"coords_np \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.array(coords)\"})]})]})})}),`\n`,(0,n.jsxs)(e.h4,{id:\"step-2-build-graph\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#step-2-build-graph\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 2: Build Graph\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" build_spatial_graph\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords, k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    nbrs \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_neighbors\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").fit(coords)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    _, indices \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nbrs.kneighbors(coords)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    src \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.repeat(np.arange(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"len\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(coords)), k)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    dst \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" indices[:, \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":].reshape(\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.stack([src, dst], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Undirected\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.concatenate([edge_index, edge_index[::\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"]], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" np.unique(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(edge_index, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"edge_index \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" build_spatial_graph(coords_np, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"k\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,n.jsxs)(e.h4,{id:\"step-3-define-model\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#step-3-define-model\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 3: Define Model\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" SpatialGNN\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, n_genes, hidden_dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"128\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", latent_dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"32\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", n_clusters\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"7\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".encoder \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList([\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            GCNLayer(n_genes, hidden_dim),\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            GCNLayer(hidden_dim, latent_dim)\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        ])\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".cluster_head \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(latent_dim, n_clusters)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" layer \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".encoder:\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" layer(h, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.relu(h)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"            h \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.dropout(h, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"p\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.3\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"training\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        logits \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\".cluster_head(h)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" h, logits\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"model \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" SpatialGNN(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_genes\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"X.shape[\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"], \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_clusters\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"7\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"optimizer \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.optim.Adam(model.parameters(), \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"lr\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"0.001\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,n.jsxs)(e.h4,{id:\"step-4-training-loop\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#step-4-training-loop\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 4: Training Loop\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.cluster \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" KMeans\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\" train_epoch\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(model, x, edge_index, optimizer):\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    model.train()\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    optimizer.zero_grad()\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Forward\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    embeddings, logits \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" model(x, edge_index)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Pseudo-labels from k-means (self-supervised)\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    with\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.no_grad():\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        kmeans \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" KMeans(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_clusters\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"7\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"random_state\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"42\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        pseudo_labels \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" kmeans.fit_predict(embeddings.cpu().numpy())\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"        pseudo_labels \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(pseudo_labels, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"    # Cross-entropy loss\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    loss \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" F.cross_entropy(logits, pseudo_labels)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    loss.backward()\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    optimizer.step()\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" loss.item()\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Train\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"for\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" epoch \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"100\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    loss \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" train_epoch(model, X_tensor, edge_index, optimizer)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" epoch \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"%\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 10\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\" ==\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"        print\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"f\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"Epoch '}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"epoch\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"}\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\", Loss: \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"loss\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\":.4f\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"}\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,n.jsxs)(e.h4,{id:\"step-5-extract-clusters-and-visualize\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#step-5-extract-clusters-and-visualize\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Step 5: Extract Clusters and Visualize\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"model.eval()\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"with\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" torch.no_grad():\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    embeddings, logits \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" model(X_tensor, edge_index)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"    clusters \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" logits.argmax(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\").cpu().numpy()\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Add to adata\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"adata.obs[\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'gnn_cluster'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" clusters\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Visualize on tissue\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" scanpy \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sc\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"sc.pl.spatial(adata, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"color\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"'gnn_cluster'\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"spot_size\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"150\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"practical-considerations\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#practical-considerations\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Practical Considerations\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"1-over-smoothing-problem\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#1-over-smoothing-problem\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"1. Over-smoothing Problem\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Issue\"}),\": With many GNN layers, all node features converge to the same value.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Why\"}),\": Each layer mixes neighbors' features, leading to exponential diffusion.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Solutions\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Limit layers\"}),\": 2-3 layers often enough for ST (tissue neighborhoods are local)\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Skip connections\"}),\": Add residual connections\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsx)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"h_new \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" gcn_layer(h) \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" h  \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Residual\"})]})})})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Adaptive depth\"}),\" (DropEdge, PairNorm): Randomly drop edges or normalize layer outputs\"]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Rule of thumb for ST\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Small tissue sections: 2 layers\"}),`\n`,(0,n.jsx)(e.li,{children:\"Whole-slide: 3-4 layers max\"}),`\n`,(0,n.jsx)(e.li,{children:\"Multi-sample integration: Consider global pooling instead of deeper GNN\"}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"2-choosing-hyperparameter-k-number-of-neighbors\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#2-choosing-hyperparameter-k-number-of-neighbors\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"2. Choosing Hyperparameter k (Number of Neighbors)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Trade-off\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Low k (4-6)\"}),\": Sharp boundaries, less smoothing, more noise sensitivity\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"High k (12-20)\"}),\": Smoother, more stable, but blurs boundaries\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Guideline\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Delaunay\"}),\": Natural choice, typically \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"k\"}),(0,n.jsx)(e.mo,{children:\"\\u2248\"}),(0,n.jsx)(e.mn,{children:\"6\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"k \\\\approx 6\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03148em\"},children:\"k\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2248\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"6\"})]})]})]})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Brain cortex / layered tissue\"}),\": Lower k to preserve layers\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Tumor heterogeneity\"}),\": Mid-range k (6-8)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Dense spot arrays (Visium HD)\"}),\": Higher k (10-15)\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Experiment\"}),\": Try \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\"k\"}),(0,n.jsx)(e.mo,{children:\"\\u2208\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"{\"}),(0,n.jsx)(e.mn,{children:\"4\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mn,{children:\"6\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mn,{children:\"8\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mn,{children:\"10\"}),(0,n.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,n.jsx)(e.mn,{children:\"12\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"}\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"k \\\\in \\\\{4, 6, 8, 10, 12\\\\}\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7335em\",verticalAlign:\"-0.0391em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03148em\"},children:\"k\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"mord\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"6\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"8\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"12\"}),(0,n.jsx)(e.span,{className:\"mclose\",children:\"}\"})]})]})]}),\" and check:\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Silhouette score on clusters\"}),`\n`,(0,n.jsx)(e.li,{children:\"Agreement with known anatomical regions\"}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"3-normalization-and-preprocessing\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#3-normalization-and-preprocessing\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3. Normalization and Preprocessing\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Critical steps\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Gene selection\"}),\": Use highly variable genes (1000-3000)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Expression normalization\"}),\": Log1p + standard scaling\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Graph normalization\"}),\": Symmetric \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msup,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]}),(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"A\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.msup,{children:[(0,n.jsxs)(e.mover,{accent:\"true\",children:[(0,n.jsx)(e.mi,{mathvariant:\"bold\",children:\"D\"}),(0,n.jsx)(e.mo,{children:\"~\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2212\"}),(0,n.jsx)(e.mn,{children:\"1\"}),(0,n.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,n.jsx)(e.mn,{children:\"2\"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\tilde{\\\\mathbf{D}}^{-1/2} \\\\tilde{\\\\mathbf{A}} \\\\tilde{\\\\mathbf{D}}^{-1/2}\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.923em\"}}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.888em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1/2\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"A\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1111em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord accent\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.923em\"},children:[(0,n.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"mord mathbf\",children:\"D\"})]}),(0,n.jsxs)(e.span,{style:{top:\"-3.6051em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,n.jsx)(e.span,{className:\"accent-body\",style:{left:\"-0.1944em\"},children:(0,n.jsx)(e.span,{className:\"mord\",children:\"~\"})})]})]})})})}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.888em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsxs)(e.span,{className:\"mord mtight\",children:[(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2212\"}),(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"1/2\"})]})})]})})})})})]})]})})]}),\" (built into GCN)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Feature scaling\"}),\": StandardScaler before training\"]}),`\n`]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" scanpy \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sc\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.preprocessing \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" StandardScaler\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Standard pipeline\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"sc.pp.normalize_total(adata, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"target_sum\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"1e4\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"sc.pp.log1p(adata)\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"sc.pp.highly_variable_genes(adata, \"}),(0,n.jsx)(e.span,{style:{color:\"#FFAB70\"},children:\"n_top_genes\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2000\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"adata \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" adata[:, adata.var.highly_variable]\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"X \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" StandardScaler().fit_transform(adata.X.toarray())\"})]})]})})}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"4-evaluation-metrics\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#4-evaluation-metrics\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"4. Evaluation Metrics\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"For \",(0,n.jsx)(e.strong,{children:\"clustering\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Adjusted Rand Index (ARI)\"}),\": Compare with ground-truth annotations\"]}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.strong,{children:\"Normalized Mutual Information (NMI)\"})}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Silhouette score\"}),\": Cluster separation in embedding space\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"For \",(0,n.jsx)(e.strong,{children:\"deconvolution\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"RMSE\"}),\" vs. known proportions (if synthetic data)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Correlation\"}),\" with reference cell-type markers\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"For \",(0,n.jsx)(e.strong,{children:\"imputation\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"RMSE\"}),\" on held-out genes\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Pearson correlation\"}),\" with ground truth\"]}),`\n`]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,n.jsxs)(e.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.metrics \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" adjusted_rand_score, silhouette_score\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"# Clustering evaluation\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"ari \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" adjusted_rand_score(true_labels, predicted_clusters)\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"silhouette \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" silhouette_score(embeddings, predicted_clusters)\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"print\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"f\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"ARI: '}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"ari\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\":.3f\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"}\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\", Silhouette: \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"silhouette\"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\":.3f\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"}\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h3,{id:\"5-common-pitfalls\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#5-common-pitfalls\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"5. Common Pitfalls\"]}),`\n`,(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:\"Problem\"}),(0,n.jsx)(e.th,{children:\"Symptom\"}),(0,n.jsx)(e.th,{children:\"Solution\"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"Over-smoothing\"})}),(0,n.jsx)(e.td,{children:\"All embeddings identical\"}),(0,n.jsx)(e.td,{children:\"Reduce layers, add skip connections\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"Disconnected graph\"})}),(0,n.jsx)(e.td,{children:\"NaN in training\"}),(0,n.jsxs)(e.td,{children:[\"Check graph connectivity, increase k or \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"\\u03B5\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\varepsilon\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03B5\"})]})})]})]})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"Unstable GAT\"})}),(0,n.jsx)(e.td,{children:\"Loss spikes\"}),(0,n.jsx)(e.td,{children:\"Lower learning rate, increase dropout on attention\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"Poor clustering\"})}),(0,n.jsx)(e.td,{children:\"Random assignments\"}),(0,n.jsx)(e.td,{children:\"Better graph construction, tune k, check normalization\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"High memory\"})}),(0,n.jsx)(e.td,{children:\"OOM errors\"}),(0,n.jsx)(e.td,{children:\"Use mini-batching (GraphSAGE), neighbor sampling\"})]})]})]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"advanced-topics\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#advanced-topics\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Advanced Topics\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"1-hypergraph-neural-networks\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#1-hypergraph-neural-networks\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"1. Hypergraph Neural Networks\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Standard GNN\"}),`: Pairwise edges (connects 2 nodes)\n`,(0,n.jsx)(e.strong,{children:\"Hypergraph\"}),\": Hyperedges connect \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\"\\u2265\"}),(0,n.jsx)(e.mn,{children:\"2\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\geq 2\"})]})})}),(0,n.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.7719em\",verticalAlign:\"-0.136em\"}}),(0,n.jsx)(e.span,{className:\"mrel\",children:\"\\u2265\"}),(0,n.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,n.jsx)(e.span,{className:\"mord\",children:\"2\"})]})]})]}),\" nodes simultaneously\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Use case in ST\"}),\": Group of spots in a tissue domain share a hyperedge\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Example\"}),\": \",(0,n.jsx)(e.a,{href:\"https://arxiv.org/abs/2401.12001\",children:\"Hypergraph Neural Networks Reveal Spatial Domains\"})]}),`\n`,(0,n.jsxs)(e.h3,{id:\"2-hierarchical-and-multi-scale-graphs\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#2-hierarchical-and-multi-scale-graphs\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"2. Hierarchical and Multi-Scale Graphs\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Idea\"}),\": Build graphs at multiple resolutions\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Fine-scale: spot-to-spot\"}),`\n`,(0,n.jsx)(e.li,{children:\"Coarse-scale: domain-to-domain (via clustering)\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Benefits\"}),\": Capture both local and global patterns\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Example\"}),\": MERGE builds hierarchical image patch graphs\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"3-graph-transformers\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#3-graph-transformers\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"3. Graph Transformers\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Replace message-passing with full self-attention over all nodes.\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Pros\"}),`: No over-smoothing, long-range dependencies\n`,(0,n.jsx)(e.strong,{children:\"Cons\"}),\": \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:\"script\",children:\"O\"}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:\"N\"}),(0,n.jsx)(e.mn,{children:\"2\"})]}),(0,n.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{O}(N^2)\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"1.0641em\",verticalAlign:\"-0.25em\"}}),(0,n.jsx)(e.span,{className:\"mord mathcal\",style:{marginRight:\"0.02778em\"},children:\"O\"}),(0,n.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"mord\",children:[(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10903em\"},children:\"N\"}),(0,n.jsx)(e.span,{className:\"msupsub\",children:(0,n.jsx)(e.span,{className:\"vlist-t\",children:(0,n.jsx)(e.span,{className:\"vlist-r\",children:(0,n.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:(0,n.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,n.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,n.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,n.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})})})})})]}),(0,n.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]}),\" complexity\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Emerging work\"}),\": Graphormer, GraphGPS\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"resources-and-next-steps\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#resources-and-next-steps\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Resources and Next Steps\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"papers-recommended-reading-order\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#papers-recommended-reading-order\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Papers (Recommended Reading Order)\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"GNN Foundations\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Kipf & Welling (2017): \",(0,n.jsx)(e.a,{href:\"https://arxiv.org/abs/1609.02907\",children:\"Semi-Supervised Classification with GCNs\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Hamilton et al. (2017): \",(0,n.jsx)(e.a,{href:\"https://arxiv.org/abs/1706.02216\",children:\"GraphSAGE\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Veli\\u010Dkovi\\u0107 et al. (2018): \",(0,n.jsx)(e.a,{href:\"https://arxiv.org/abs/1710.10903\",children:\"Graph Attention Networks\"})]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"ST Applications\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"SpaGCN: \",(0,n.jsx)(e.a,{href:\"https://www.nature.com/articles/s41592-021-01255-8\",children:\"Nature Methods 2021\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"STAGATE: \",(0,n.jsx)(e.a,{href:\"https://www.nature.com/articles/s41467-022-29439-6\",children:\"Nature Communications 2022\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"GraphST: \",(0,n.jsx)(e.a,{href:\"https://www.nature.com/articles/s41467-023-36796-3\",children:\"Nature Communications 2023\"})]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Advanced\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"http://web.stanford.edu/class/cs224w/\",children:\"Stanford CS224W course notes\"})}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://www.cs.mcgill.ca/~wlh/grl_book/\",children:\"Graph Representation Learning Book\"}),\" (Hamilton)\"]}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.h3,{id:\"code-repositories\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#code-repositories\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Code Repositories\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"PyTorch Geometric\"}),\": \",(0,n.jsx)(e.a,{href:\"https://pytorch-geometric.readthedocs.io/\",children:\"https://pytorch-geometric.readthedocs.io/\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"DGL (Deep Graph Library)\"}),\": \",(0,n.jsx)(e.a,{href:\"https://www.dgl.ai/\",children:\"https://www.dgl.ai/\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"STAGATE\"}),\": \",(0,n.jsx)(e.a,{href:\"https://github.com/zhanglabtools/STAGATE\",children:\"https://github.com/zhanglabtools/STAGATE\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"GraphST\"}),\": \",(0,n.jsx)(e.a,{href:\"https://github.com/JinmiaoChenLab/GraphST\",children:\"https://github.com/JinmiaoChenLab/GraphST\"})]}),`\n`]}),`\n`,(0,n.jsxs)(e.h3,{id:\"practice-projects\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#practice-projects\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Practice Projects\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Reproduce SpaGCN\"}),\" on a public Visium dataset (e.g., mouse brain)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Compare GCN vs. GAT\"}),\" on your own ST data\\u2014measure ARI, runtime, smoothness\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Build a hybrid graph\"}),\" (spatial + expression) and tune the weighting parameter \",(0,n.jsxs)(e.span,{className:\"katex\",children:[(0,n.jsx)(e.span,{className:\"katex-mathml\",children:(0,n.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\"\\u03B1\"})}),(0,n.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\alpha\"})]})})}),(0,n.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,n.jsxs)(e.span,{className:\"base\",children:[(0,n.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,n.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"})]})})]})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Implement contrastive learning\"}),\" for multi-sample integration\"]}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"conclusion\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#conclusion\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Graph Neural Networks provide a powerful, principled framework for spatial transcriptomics analysis by:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Respecting spatial structure\"}),\" through graph topology\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Learning adaptive representations\"}),\" via message passing\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Integrating multi-modal data\"}),\" (expression, coordinates, images)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Scaling to large datasets\"}),\" with sampling and mini-batching\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"The key to success is:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Graph construction\"}),\": Choose topology that reflects your biology\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Architecture selection\"}),\": Match model complexity to data size and task\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Regularization\"}),\": Prevent over-smoothing and overfitting\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Evaluation\"}),\": Use domain-relevant metrics and biological validation\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"As spatial omics technologies advance (Visium HD, Xenium, CosMx), GNNs will remain essential tools for discovering tissue organization, cell-cell interactions, and disease mechanisms.\"}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:\"Happy graph learning!\"})})]})}function o(l={}){let{wrapper:e}=l.components||{};return e?(0,n.jsx)(e,{...l,children:(0,n.jsx)(d,{...l})}):d(l)}return v(b);})();\n;return Component;"
    },
    "_id": "projects/gnn-spatial-transcriptomics.mdx",
    "_raw": {
      "sourceFilePath": "projects/gnn-spatial-transcriptomics.mdx",
      "sourceFileName": "gnn-spatial-transcriptomics.mdx",
      "sourceFileDir": "projects",
      "contentType": "mdx",
      "flattenedPath": "projects/gnn-spatial-transcriptomics"
    },
    "type": "Project",
    "url": "/projects/gnn-spatial-transcriptomics",
    "slug": "gnn-spatial-transcriptomics"
  },
  {
    "title": "Comparing Self-Supervised Learning Methods for Spatial Transcriptomics",
    "summary": "A systematic evaluation of 8 SSL methods with 3 GNN architectures on mouse brain spatial transcriptomics data",
    "status": "completed",
    "role": "Research & Analysis",
    "stack": [
      "PyTorch",
      "PyTorch Geometric",
      "Python",
      "Self-Supervised Learning",
      "Graph Neural Networks",
      "Spatial Transcriptomics"
    ],
    "images": [],
    "tags": [
      "deep learning",
      "self-supervised learning",
      "bioinformatics",
      "spatial transcriptomics",
      "representation learning"
    ],
    "featured": true,
    "startDate": "2025-09-16T00:00:00.000Z",
    "body": {
      "raw": "\n# Comparing Self-Supervised Learning Methods for Spatial Transcriptomics\n\nA systematic evaluation exploring how different self-supervised learning approaches perform when combined with graph neural networks for learning spatial transcriptomics representations.\n\n## Table of Contents\n\n1. [Introduction](#introduction)\n2. [Methods](#methods)\n3. [Results](#results)\n4. [Key Findings](#key-findings)\n5. [Future Directions](#future-directions)\n\n---\n\n## Introduction\n\n### The Data and Problem\n\nAnalyzed spatial transcriptomics data from the **SiT Mouse Brain dataset** (CBS1_illu) by [Lebrigand et al., 2023](https://doi.org/10.1093/nar/gkad169), which captures gene expression patterns with spatial context from mouse brain samples. The dataset comprises:\n\n- **2,560 spatial spots** representing distinct tissue locations\n- **31,053 genes**, filtered to **3,000 highly variable genes (HVGs)**\n- **Spatial coordinates** preserving tissue architecture\n- **13 annotated cell types/regions** including CA1/CA2, CA3, DG, Hippocampus, Hypothalamus, Isocortex, and others\n\n![SiT CBS1_illu_anno](/projects/sit_explore/CBS1_anno.jpg)\n\n**Research Question**: How do different self-supervised learning (SSL) approaches perform when combined with graph neural networks (GNNs) for learning spatial transcriptomics representations?\n\n### Graph Construction\n\nAs detailed in my [previous work on GNNs for spatial transcriptomics](/projects/gnn-spatial-transcriptomics), I constructed a **k-nearest neighbor spatial graph** (k=8) based on Euclidean distances between spot coordinates, resulting in **2,560 nodes** and **40,960 edges**.\n\n---\n\n## Methods\n\n### GNN Architectures\n\nThree GNN architectures were evaluated as encoder backbones:\n\n1. **GraphSAGE (SAGEConv)**: Samples and aggregates features from neighbors using mean pooling\n2. **Graph Attention Networks (GATConv)**: Learns attention weights to weigh neighbor importance (4 attention heads)\n3. **Graph Convolutional Networks (GCNConv)**: Applies spectral graph convolutions for feature aggregation\n\n**Architecture specifications**:\n- 2 GNN layers\n- Hidden dimension: 256\n- Projection dimension: 64\n- Batch normalization and dropout (0.1) between layers\n\n### Self-Supervised Learning Methods\n\nEight state-of-the-art SSL methods were compared across different families:\n\n**Contrastive Learning**:\n- **SimCLR**: Contrastive learning using NT-Xent loss (temperature=0.2)\n- **SwAV**: Swapping assignments between views using optimal transport (512 prototypes)\n\n**Momentum-based Methods**:\n- **BYOL**: Bootstrap Your Own Latent without negative pairs (momentum=0.99)\n- **MoCo**: Momentum contrast with a queue of negative samples (queue size=4096, momentum=0.99)\n- **SimSiam**: Simple Siamese Networks with stop-gradient\n\n**Reconstruction-based**:\n- **MAE**: Masked Autoencoder reconstructing masked gene expressions (mask ratio=0.75)\n\n**Redundancy Reduction**:\n- **Barlow Twins**: Self-supervised learning via redundancy reduction (λ=0.005)\n- **VICReg**: Variance-Invariance-Covariance Regularization (λ_inv=25, λ_var=25, λ_cov=1)\n\n**Data Augmentation**: Gene dropout (10%) and Gaussian noise addition (scale=0.005)\n\n**Training**: 20 epochs, batch size 256, AdamW optimizer (lr=1e-4, weight decay=1e-5)\n\n### Evaluation Metrics\n\nFive complementary metrics were used to evaluate **24 method-backbone combinations**:\n\n- **AMI/NMI (Adjusted/Normalized Mutual Information)**: Clustering agreement with ground truth annotations\n- **Silhouette Score**: Internal cluster cohesion and separation\n- **Moran's I**: Global spatial autocorrelation (higher = stronger spatial coherence)\n- **Geary's C**: Alternative spatial autocorrelation measure (lower = stronger spatial coherence)\n\n**Important Note**: These metrics provide a **partial view** of model performance. They don't capture robustness to batch effects, transferability to downstream tasks, biological interpretability, or performance on rare cell types.\n\n---\n\n## Results\n\n### Clustering Visualizations by Backbone\n\nThe spatial clustering results reveal substantial qualitative differences across methods and backbones:\n\n![SAGEConv Clustering Results](/projects/sit_explore/SAGEConv.jpg)\n*Figure 1: Leiden clustering results for all SSL methods using SAGEConv backbone. SAGEConv-based methods tend to produce more fragmented spatial patterns with sharper local transitions, potentially preserving fine-grained local heterogeneity.*\n\n![GATConv Clustering Results](/projects/sit_explore/GATConc.jpg)\n*Figure 2: Leiden clustering results for all SSL methods using GATConv backbone. GATConv shows intermediate behavior with learned attention weights adding flexibility to adapt to local structure.*\n\n![GCNConv Clustering Results](/projects/sit_explore/GCNConv.jpg)\n*Figure 3: Leiden clustering results for all SSL methods using GCNConv backbone. GCNConv-based methods generally show more spatially contiguous clusters with smoother boundaries and stronger delineation along major anatomical boundaries.*\n\n### Quantitative Performance Metrics\n\n![Method Comparison](/projects/sit_explore/method_comparison.png)\n*Figure 4: Average performance by SSL method across clustering and spatial metrics. Redundancy reduction methods (VICReg, Barlow Twins) show higher clustering agreement, while methods vary substantially in spatial autocorrelation.*\n\n![Backbone Comparison](/projects/sit_explore/backbone_comparison.png)\n*Figure 5: Average performance by GNN backbone. GCNConv shows very low variance in spatial metrics, suggesting strong spatial smoothing. SAGEConv exhibits highest variance across methods, indicating SSL objective matters more for this backbone.*\n\n### Method Performance Summary\n\nAverage behavior across all three GNN backbones (mean ± std):\n\n| Method | AMI | NMI | Silhouette | Moran's I | Geary's C |\n|--------|---------|---------|----------------|---------------|---------------|\n| VICReg | 0.566±0.095 | 0.572±0.094 | 0.283±0.023 | 0.847±0.072 | 0.153±0.070 |\n| Barlow Twins | 0.558±0.036 | 0.563±0.036 | 0.266±0.024 | 0.855±0.092 | 0.145±0.091 |\n| SwAV | 0.529±0.047 | 0.536±0.046 | 0.269±0.042 | 0.830±0.108 | 0.172±0.106 |\n| **BYOL** | **0.524±0.023** | **0.531±0.023** | **0.271±0.027** | **0.819±0.121** | **0.184±0.116** |\n| MoCo | 0.515±0.067 | 0.522±0.066 | 0.184±0.027 | 0.781±0.151 | 0.224±0.148 |\n| SimCLR | 0.506±0.022 | 0.513±0.022 | 0.186±0.033 | 0.791±0.130 | 0.210±0.129 |\n| SimSiam | 0.479±0.016 | 0.486±0.016 | 0.247±0.018 | 0.809±0.120 | 0.187±0.119 |\n| MAE | 0.256±0.018 | 0.265±0.018 | 0.328±0.006 | 0.806±0.097 | 0.189±0.096 |\n\n### Metric Relationships\n\n![Metric Scatter Plots](/projects/sit_explore/metrics_scatterplots.png)\n*Figure 6: Relationships between clustering quality and spatial coherence metrics. AMI vs. Moran's I show positive correlation (ρ≈0.75), though this may reflect GCNConv's strong influence on both metrics.*\n\n---\n\n## Key Findings\n\n### Observed Patterns\n\n**BYOL with SAGEConv shows promise**: This combination achieves balanced performance across metrics (AMI=0.510, NMI=0.516, Silhouette=0.254, Moran's I=0.683) without over-optimizing for any single one, suggesting potential for further investigation.\n\n**Redundancy reduction methods show consistency**: VICReg and Barlow Twins exhibit higher AMI/NMI values and more consistent behavior across backbones (lower std), suggesting robust learning dynamics.\n\n**BYOL demonstrates remarkable consistency**: With std=0.023 for AMI across different GNN architectures, BYOL's momentum-based approach appears robust to architectural choices.\n\n**MAE exhibits a paradox**: Highest Silhouette scores (0.328) but lowest clustering agreement (AMI=0.256). This suggests it learns internally coherent representations that don't align with the provided annotations. It maybe suffering from the \"noise\"?\n\n**Strong method-backbone interactions**: The same SSL method behaves very differently depending on GNN backbone, with variance up to 0.124 in AMI, indicating that architecture choice significantly influences representation learning.\n\n### GNN Backbone Trade-offs\n\n**GCNConv**: Shows very low variance in spatial metrics (std=0.007 for Moran's I), suggesting spectral operations impose strong spatial smoothing regardless of SSL method. This high spatial coherence may be desirable or may indicate over-smoothing.\n\n**SAGEConv**: Exhibits comparable AMI to GCNConv (0.510 vs. 0.507) but lower spatial autocorrelation (Moran's I=0.695). **Highest variance across methods** (std=0.124) indicates SSL objective matters more for this backbone, potentially preserving local heterogeneity (can also be observed from Figure 1~3).\n\n**GATConv**: Shows intermediate values across all metrics with learned attention weights providing flexibility to adapt to local structure. As a side project, I experimented with adding regional attention mechanisms that provide the model with global spatial relationships, which significantly improved GAT's performance across all metrics.\n\n---\n\n## Key Findings\n\n### Critical Limitations\n\nThis exploratory study has important limitations that constrain conclusions:\n\n**Evaluation Limitations**:\n- Metrics are proxies, not ground truth—AMI/NMI assume the 13 annotated regions are \"correct,\" but annotations may be incomplete or subjective\n- Single dataset from mouse brain may not generalize to other tissues or organisms\n- Limited hyperparameter exploration (only 20 epochs, fixed augmentation parameters)\n- No downstream task evaluation for actual biological utility\n- Small dataset (2,560 spots) may not reveal scalability issues\n\n**Interpretation Challenges**: High Moran's I could reflect beneficial spatial structure or excessive smoothing. High Silhouette doesn't guarantee biological relevance. Therefore, these metrics primarily identify differences in learned representations rather than definitively ranking method quality.\n\n### Potential Hybrid Approaches\n\nGiven different strengths of each method family, combining approaches may be promising:\n\n**SimCLR + Barlow Twins**: Combine discriminative learning through contrastive loss with decorrelation to prevent feature redundancy. This may achieve both strong discrimination and feature diversity without collapse.\n\n**BYOL + VICReg**: Add VICReg's variance/covariance terms to BYOL's predictor objective to provide explicit collapse prevention mechanism while maintaining momentum-based stability.\n\n**Spatial-aware SSL**: Add explicit spatial regularization term to existing methods to test whether explicit spatial terms improve over implicit (GNN-based) spatial encoding.\n\n---\n\n## Future Directions\n\n### Next Steps\n\n**Cross-tissue validation**: The single-dataset limitation is this study's most critical weakness. Evaluation on diverse tissues (liver, heart, tumor microenvironments) and larger datasets (10,000+ spots) is essential to assess generalizability and scalability.\n\n**Biological validation**: Beyond clustering metrics, I plan to evaluate differential gene expression, pathway enrichment, rare cell type recovery, and spatial trajectory inference quality to assess actual biological utility.\n\n**Hybrid method development**: Systematic investigation of combined approaches (SimCLR+Barlow Twins, BYOL+VICReg) with careful hyperparameter tuning may leverage complementary strengths.\n\n**Downstream task evaluation**: Test representations on actual biological questions including differential expression analysis, cell-cell communication, and trajectory inference.\n\n### Open Questions\n\n1. Why does BYOL-SAGEConv show such balanced behavior across metrics?\n2. Can we design metrics that better reflect biological utility rather than statistical properties?\n3. How do methods perform on rare cell types not well-represented in the dataset?\n4. What is the minimal dataset size needed for each method to perform effectively?\n5. Can we predict which method suits a given tissue type a priori?\n6. Can we treat gene expression patterns as samples instead of spots? Currently, each spot (with its gene expression vector) is treated as a sample. An alternative approach would be to treat each gene's expression pattern across all spots as a sample—essentially viewing each gene as an \"image\" where pixel intensities represent expression levels at different spatial locations. This gene-centric perspective might reveal different biological insights about co-expression patterns and spatial gene regulatory networks.\n\n---\n\n## Conclusion\n\nThis systematic comparison of 8 self-supervised learning methods across 3 GNN architectures reveals substantial differences in how representations are learned for spatial transcriptomics data. While definitive conclusions about method superiority require more comprehensive evaluation, several patterns emerged:\n\n- **Substantial method-backbone interactions** with the same SSL method behaving very differently depending on GNN backbone\n- **BYOL-SAGEConv shows balanced performance** across diverse metrics without over-optimizing for any single one\n- **Redundancy reduction methods** (VICReg, Barlow Twins) demonstrate consistency across architectures\n- **Evaluation challenges** highlight the difficulty of assessing representation quality through clustering and spatial metrics alone\n\nFuture work will focus on cross-tissue validation, biological validation through downstream tasks, and development of hybrid approaches that combine complementary strengths of different SSL families.\n\n---\n\n## Acknowledgments\n\nThis analysis leveraged:\n- **SiT Mouse Brain dataset** for spatial transcriptomics data\n- **PyTorch Geometric** for GNN implementations\n- **Scanpy** for preprocessing and visualization\n- **Scikit-learn** for evaluation metrics\n\n## References\n\n**SSL Methods**:\n- Chen et al. (2020) - SimCLR: A Simple Framework for Contrastive Learning\n- He et al. (2020) - MoCo: Momentum Contrast for Unsupervised Visual Representation Learning\n- Grill et al. (2020) - BYOL: Bootstrap Your Own Latent\n- Caron et al. (2020) - SwAV: Unsupervised Learning of Visual Features by Contrasting Cluster Assignments\n- Chen & He (2021) - SimSiam: Exploring Simple Siamese Representation Learning\n- He et al. (2022) - MAE: Masked Autoencoders Are Scalable Vision Learners\n- Zbontar et al. (2021) - Barlow Twins: Self-Supervised Learning via Redundancy Reduction\n- Bardes et al. (2022) - VICReg: Variance-Invariance-Covariance Regularization\n\n**GNN Architectures**:\n- Hamilton et al. (2017) - GraphSAGE: Inductive Representation Learning on Large Graphs\n- Veličković et al. (2018) - GAT: Graph Attention Networks\n- Kipf & Welling (2017) - GCN: Semi-Supervised Classification with Graph Convolutional Networks\n\n**Spatial Transcriptomics**:\n- Lebrigand et al. (2023) - The spatial landscape of gene expression isoforms in tissue sections\n\n\n",
      "code": "var Component=(()=>{var p=Object.create;var a=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty;var v=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),b=(i,e)=>{for(var r in e)a(i,r,{get:e[r],enumerable:!0})},o=(i,e,r,s)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let t of g(e))!f.call(i,t)&&t!==r&&a(i,t,{get:()=>e[t],enumerable:!(s=m(e,t))||s.enumerable});return i};var y=(i,e,r)=>(r=i!=null?p(u(i)):{},o(e||!i||!i.__esModule?a(r,\"default\",{value:i,enumerable:!0}):r,i)),w=i=>o(a({},\"__esModule\",{value:!0}),i);var c=v((k,l)=>{l.exports=_jsx_runtime});var S={};b(S,{default:()=>d,frontmatter:()=>N});var n=y(c()),N={title:\"Comparing Self-Supervised Learning Methods for Spatial Transcriptomics\",summary:\"A systematic evaluation of 8 SSL methods with 3 GNN architectures on mouse brain spatial transcriptomics data\",status:\"completed\",role:\"Research & Analysis\",stack:[\"PyTorch\",\"PyTorch Geometric\",\"Python\",\"Self-Supervised Learning\",\"Graph Neural Networks\",\"Spatial Transcriptomics\"],tags:[\"deep learning\",\"self-supervised learning\",\"bioinformatics\",\"spatial transcriptomics\",\"representation learning\"],featured:!0,startDate:\"2025-09-16\"};function h(i){let e={a:\"a\",em:\"em\",h1:\"h1\",h2:\"h2\",h3:\"h3\",hr:\"hr\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",span:\"span\",strong:\"strong\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...i.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"comparing-self-supervised-learning-methods-for-spatial-transcriptomics\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#comparing-self-supervised-learning-methods-for-spatial-transcriptomics\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Comparing Self-Supervised Learning Methods for Spatial Transcriptomics\"]}),`\n`,(0,n.jsx)(e.p,{children:\"A systematic evaluation exploring how different self-supervised learning approaches perform when combined with graph neural networks for learning spatial transcriptomics representations.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"table-of-contents\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#table-of-contents\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Table of Contents\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#introduction\",children:\"Introduction\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#methods\",children:\"Methods\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#results\",children:\"Results\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#key-findings\",children:\"Key Findings\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"#future-directions\",children:\"Future Directions\"})}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"introduction\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#introduction\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Introduction\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"the-data-and-problem\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#the-data-and-problem\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"The Data and Problem\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Analyzed spatial transcriptomics data from the \",(0,n.jsx)(e.strong,{children:\"SiT Mouse Brain dataset\"}),\" (CBS1_illu) by \",(0,n.jsx)(e.a,{href:\"https://doi.org/10.1093/nar/gkad169\",children:\"Lebrigand et al., 2023\"}),\", which captures gene expression patterns with spatial context from mouse brain samples. The dataset comprises:\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"2,560 spatial spots\"}),\" representing distinct tissue locations\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"31,053 genes\"}),\", filtered to \",(0,n.jsx)(e.strong,{children:\"3,000 highly variable genes (HVGs)\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Spatial coordinates\"}),\" preserving tissue architecture\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"13 annotated cell types/regions\"}),\" including CA1/CA2, CA3, DG, Hippocampus, Hypothalamus, Isocortex, and others\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"/projects/sit_explore/CBS1_anno.jpg\",alt:\"SiT CBS1_illu_anno\"})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Research Question\"}),\": How do different self-supervised learning (SSL) approaches perform when combined with graph neural networks (GNNs) for learning spatial transcriptomics representations?\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"graph-construction\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#graph-construction\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Graph Construction\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"As detailed in my \",(0,n.jsx)(e.a,{href:\"/projects/gnn-spatial-transcriptomics\",children:\"previous work on GNNs for spatial transcriptomics\"}),\", I constructed a \",(0,n.jsx)(e.strong,{children:\"k-nearest neighbor spatial graph\"}),\" (k=8) based on Euclidean distances between spot coordinates, resulting in \",(0,n.jsx)(e.strong,{children:\"2,560 nodes\"}),\" and \",(0,n.jsx)(e.strong,{children:\"40,960 edges\"}),\".\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"methods\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#methods\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Methods\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"gnn-architectures\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#gnn-architectures\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"GNN Architectures\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Three GNN architectures were evaluated as encoder backbones:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"GraphSAGE (SAGEConv)\"}),\": Samples and aggregates features from neighbors using mean pooling\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Graph Attention Networks (GATConv)\"}),\": Learns attention weights to weigh neighbor importance (4 attention heads)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Graph Convolutional Networks (GCNConv)\"}),\": Applies spectral graph convolutions for feature aggregation\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Architecture specifications\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"2 GNN layers\"}),`\n`,(0,n.jsx)(e.li,{children:\"Hidden dimension: 256\"}),`\n`,(0,n.jsx)(e.li,{children:\"Projection dimension: 64\"}),`\n`,(0,n.jsx)(e.li,{children:\"Batch normalization and dropout (0.1) between layers\"}),`\n`]}),`\n`,(0,n.jsxs)(e.h3,{id:\"self-supervised-learning-methods\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#self-supervised-learning-methods\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Self-Supervised Learning Methods\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Eight state-of-the-art SSL methods were compared across different families:\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Contrastive Learning\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"SimCLR\"}),\": Contrastive learning using NT-Xent loss (temperature=0.2)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"SwAV\"}),\": Swapping assignments between views using optimal transport (512 prototypes)\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Momentum-based Methods\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"BYOL\"}),\": Bootstrap Your Own Latent without negative pairs (momentum=0.99)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"MoCo\"}),\": Momentum contrast with a queue of negative samples (queue size=4096, momentum=0.99)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"SimSiam\"}),\": Simple Siamese Networks with stop-gradient\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Reconstruction-based\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"MAE\"}),\": Masked Autoencoder reconstructing masked gene expressions (mask ratio=0.75)\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Redundancy Reduction\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Barlow Twins\"}),\": Self-supervised learning via redundancy reduction (\\u03BB=0.005)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"VICReg\"}),\": Variance-Invariance-Covariance Regularization (\\u03BB_inv=25, \\u03BB_var=25, \\u03BB_cov=1)\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Data Augmentation\"}),\": Gene dropout (10%) and Gaussian noise addition (scale=0.005)\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Training\"}),\": 20 epochs, batch size 256, AdamW optimizer (lr=1e-4, weight decay=1e-5)\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"evaluation-metrics\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#evaluation-metrics\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Evaluation Metrics\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Five complementary metrics were used to evaluate \",(0,n.jsx)(e.strong,{children:\"24 method-backbone combinations\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"AMI/NMI (Adjusted/Normalized Mutual Information)\"}),\": Clustering agreement with ground truth annotations\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Silhouette Score\"}),\": Internal cluster cohesion and separation\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Moran's I\"}),\": Global spatial autocorrelation (higher = stronger spatial coherence)\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Geary's C\"}),\": Alternative spatial autocorrelation measure (lower = stronger spatial coherence)\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Important Note\"}),\": These metrics provide a \",(0,n.jsx)(e.strong,{children:\"partial view\"}),\" of model performance. They don't capture robustness to batch effects, transferability to downstream tasks, biological interpretability, or performance on rare cell types.\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"results\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#results\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Results\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"clustering-visualizations-by-backbone\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#clustering-visualizations-by-backbone\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Clustering Visualizations by Backbone\"]}),`\n`,(0,n.jsx)(e.p,{children:\"The spatial clustering results reveal substantial qualitative differences across methods and backbones:\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.img,{src:\"/projects/sit_explore/SAGEConv.jpg\",alt:\"SAGEConv Clustering Results\"}),`\n`,(0,n.jsx)(e.em,{children:\"Figure 1: Leiden clustering results for all SSL methods using SAGEConv backbone. SAGEConv-based methods tend to produce more fragmented spatial patterns with sharper local transitions, potentially preserving fine-grained local heterogeneity.\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.img,{src:\"/projects/sit_explore/GATConc.jpg\",alt:\"GATConv Clustering Results\"}),`\n`,(0,n.jsx)(e.em,{children:\"Figure 2: Leiden clustering results for all SSL methods using GATConv backbone. GATConv shows intermediate behavior with learned attention weights adding flexibility to adapt to local structure.\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.img,{src:\"/projects/sit_explore/GCNConv.jpg\",alt:\"GCNConv Clustering Results\"}),`\n`,(0,n.jsx)(e.em,{children:\"Figure 3: Leiden clustering results for all SSL methods using GCNConv backbone. GCNConv-based methods generally show more spatially contiguous clusters with smoother boundaries and stronger delineation along major anatomical boundaries.\"})]}),`\n`,(0,n.jsxs)(e.h3,{id:\"quantitative-performance-metrics\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#quantitative-performance-metrics\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Quantitative Performance Metrics\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.img,{src:\"/projects/sit_explore/method_comparison.png\",alt:\"Method Comparison\"}),`\n`,(0,n.jsx)(e.em,{children:\"Figure 4: Average performance by SSL method across clustering and spatial metrics. Redundancy reduction methods (VICReg, Barlow Twins) show higher clustering agreement, while methods vary substantially in spatial autocorrelation.\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.img,{src:\"/projects/sit_explore/backbone_comparison.png\",alt:\"Backbone Comparison\"}),`\n`,(0,n.jsx)(e.em,{children:\"Figure 5: Average performance by GNN backbone. GCNConv shows very low variance in spatial metrics, suggesting strong spatial smoothing. SAGEConv exhibits highest variance across methods, indicating SSL objective matters more for this backbone.\"})]}),`\n`,(0,n.jsxs)(e.h3,{id:\"method-performance-summary\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#method-performance-summary\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Method Performance Summary\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Average behavior across all three GNN backbones (mean \\xB1 std):\"}),`\n`,(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:\"Method\"}),(0,n.jsx)(e.th,{children:\"AMI\"}),(0,n.jsx)(e.th,{children:\"NMI\"}),(0,n.jsx)(e.th,{children:\"Silhouette\"}),(0,n.jsx)(e.th,{children:\"Moran's I\"}),(0,n.jsx)(e.th,{children:\"Geary's C\"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"VICReg\"}),(0,n.jsx)(e.td,{children:\"0.566\\xB10.095\"}),(0,n.jsx)(e.td,{children:\"0.572\\xB10.094\"}),(0,n.jsx)(e.td,{children:\"0.283\\xB10.023\"}),(0,n.jsx)(e.td,{children:\"0.847\\xB10.072\"}),(0,n.jsx)(e.td,{children:\"0.153\\xB10.070\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"Barlow Twins\"}),(0,n.jsx)(e.td,{children:\"0.558\\xB10.036\"}),(0,n.jsx)(e.td,{children:\"0.563\\xB10.036\"}),(0,n.jsx)(e.td,{children:\"0.266\\xB10.024\"}),(0,n.jsx)(e.td,{children:\"0.855\\xB10.092\"}),(0,n.jsx)(e.td,{children:\"0.145\\xB10.091\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"SwAV\"}),(0,n.jsx)(e.td,{children:\"0.529\\xB10.047\"}),(0,n.jsx)(e.td,{children:\"0.536\\xB10.046\"}),(0,n.jsx)(e.td,{children:\"0.269\\xB10.042\"}),(0,n.jsx)(e.td,{children:\"0.830\\xB10.108\"}),(0,n.jsx)(e.td,{children:\"0.172\\xB10.106\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"BYOL\"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"0.524\\xB10.023\"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"0.531\\xB10.023\"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"0.271\\xB10.027\"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"0.819\\xB10.121\"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.strong,{children:\"0.184\\xB10.116\"})})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"MoCo\"}),(0,n.jsx)(e.td,{children:\"0.515\\xB10.067\"}),(0,n.jsx)(e.td,{children:\"0.522\\xB10.066\"}),(0,n.jsx)(e.td,{children:\"0.184\\xB10.027\"}),(0,n.jsx)(e.td,{children:\"0.781\\xB10.151\"}),(0,n.jsx)(e.td,{children:\"0.224\\xB10.148\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"SimCLR\"}),(0,n.jsx)(e.td,{children:\"0.506\\xB10.022\"}),(0,n.jsx)(e.td,{children:\"0.513\\xB10.022\"}),(0,n.jsx)(e.td,{children:\"0.186\\xB10.033\"}),(0,n.jsx)(e.td,{children:\"0.791\\xB10.130\"}),(0,n.jsx)(e.td,{children:\"0.210\\xB10.129\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"SimSiam\"}),(0,n.jsx)(e.td,{children:\"0.479\\xB10.016\"}),(0,n.jsx)(e.td,{children:\"0.486\\xB10.016\"}),(0,n.jsx)(e.td,{children:\"0.247\\xB10.018\"}),(0,n.jsx)(e.td,{children:\"0.809\\xB10.120\"}),(0,n.jsx)(e.td,{children:\"0.187\\xB10.119\"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:\"MAE\"}),(0,n.jsx)(e.td,{children:\"0.256\\xB10.018\"}),(0,n.jsx)(e.td,{children:\"0.265\\xB10.018\"}),(0,n.jsx)(e.td,{children:\"0.328\\xB10.006\"}),(0,n.jsx)(e.td,{children:\"0.806\\xB10.097\"}),(0,n.jsx)(e.td,{children:\"0.189\\xB10.096\"})]})]})]}),`\n`,(0,n.jsxs)(e.h3,{id:\"metric-relationships\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#metric-relationships\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Metric Relationships\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.img,{src:\"/projects/sit_explore/metrics_scatterplots.png\",alt:\"Metric Scatter Plots\"}),`\n`,(0,n.jsx)(e.em,{children:\"Figure 6: Relationships between clustering quality and spatial coherence metrics. AMI vs. Moran's I show positive correlation (\\u03C1\\u22480.75), though this may reflect GCNConv's strong influence on both metrics.\"})]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"key-findings\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#key-findings\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Key Findings\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"observed-patterns\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#observed-patterns\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Observed Patterns\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"BYOL with SAGEConv shows promise\"}),\": This combination achieves balanced performance across metrics (AMI=0.510, NMI=0.516, Silhouette=0.254, Moran's I=0.683) without over-optimizing for any single one, suggesting potential for further investigation.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Redundancy reduction methods show consistency\"}),\": VICReg and Barlow Twins exhibit higher AMI/NMI values and more consistent behavior across backbones (lower std), suggesting robust learning dynamics.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"BYOL demonstrates remarkable consistency\"}),\": With std=0.023 for AMI across different GNN architectures, BYOL's momentum-based approach appears robust to architectural choices.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"MAE exhibits a paradox\"}),`: Highest Silhouette scores (0.328) but lowest clustering agreement (AMI=0.256). This suggests it learns internally coherent representations that don't align with the provided annotations. It maybe suffering from the \"noise\"?`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Strong method-backbone interactions\"}),\": The same SSL method behaves very differently depending on GNN backbone, with variance up to 0.124 in AMI, indicating that architecture choice significantly influences representation learning.\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"gnn-backbone-trade-offs\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#gnn-backbone-trade-offs\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"GNN Backbone Trade-offs\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"GCNConv\"}),\": Shows very low variance in spatial metrics (std=0.007 for Moran's I), suggesting spectral operations impose strong spatial smoothing regardless of SSL method. This high spatial coherence may be desirable or may indicate over-smoothing.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"SAGEConv\"}),\": Exhibits comparable AMI to GCNConv (0.510 vs. 0.507) but lower spatial autocorrelation (Moran's I=0.695). \",(0,n.jsx)(e.strong,{children:\"Highest variance across methods\"}),\" (std=0.124) indicates SSL objective matters more for this backbone, potentially preserving local heterogeneity (can also be observed from Figure 1~3).\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"GATConv\"}),\": Shows intermediate values across all metrics with learned attention weights providing flexibility to adapt to local structure. As a side project, I experimented with adding regional attention mechanisms that provide the model with global spatial relationships, which significantly improved GAT's performance across all metrics.\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"key-findings-1\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#key-findings-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Key Findings\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"critical-limitations\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#critical-limitations\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Critical Limitations\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This exploratory study has important limitations that constrain conclusions:\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Evaluation Limitations\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:'Metrics are proxies, not ground truth\\u2014AMI/NMI assume the 13 annotated regions are \"correct,\" but annotations may be incomplete or subjective'}),`\n`,(0,n.jsx)(e.li,{children:\"Single dataset from mouse brain may not generalize to other tissues or organisms\"}),`\n`,(0,n.jsx)(e.li,{children:\"Limited hyperparameter exploration (only 20 epochs, fixed augmentation parameters)\"}),`\n`,(0,n.jsx)(e.li,{children:\"No downstream task evaluation for actual biological utility\"}),`\n`,(0,n.jsx)(e.li,{children:\"Small dataset (2,560 spots) may not reveal scalability issues\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Interpretation Challenges\"}),\": High Moran's I could reflect beneficial spatial structure or excessive smoothing. High Silhouette doesn't guarantee biological relevance. Therefore, these metrics primarily identify differences in learned representations rather than definitively ranking method quality.\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"potential-hybrid-approaches\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#potential-hybrid-approaches\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Potential Hybrid Approaches\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Given different strengths of each method family, combining approaches may be promising:\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"SimCLR + Barlow Twins\"}),\": Combine discriminative learning through contrastive loss with decorrelation to prevent feature redundancy. This may achieve both strong discrimination and feature diversity without collapse.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"BYOL + VICReg\"}),\": Add VICReg's variance/covariance terms to BYOL's predictor objective to provide explicit collapse prevention mechanism while maintaining momentum-based stability.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Spatial-aware SSL\"}),\": Add explicit spatial regularization term to existing methods to test whether explicit spatial terms improve over implicit (GNN-based) spatial encoding.\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"future-directions\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#future-directions\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Future Directions\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"next-steps\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#next-steps\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Next Steps\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Cross-tissue validation\"}),\": The single-dataset limitation is this study's most critical weakness. Evaluation on diverse tissues (liver, heart, tumor microenvironments) and larger datasets (10,000+ spots) is essential to assess generalizability and scalability.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Biological validation\"}),\": Beyond clustering metrics, I plan to evaluate differential gene expression, pathway enrichment, rare cell type recovery, and spatial trajectory inference quality to assess actual biological utility.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Hybrid method development\"}),\": Systematic investigation of combined approaches (SimCLR+Barlow Twins, BYOL+VICReg) with careful hyperparameter tuning may leverage complementary strengths.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Downstream task evaluation\"}),\": Test representations on actual biological questions including differential expression analysis, cell-cell communication, and trajectory inference.\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"open-questions\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#open-questions\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Open Questions\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Why does BYOL-SAGEConv show such balanced behavior across metrics?\"}),`\n`,(0,n.jsx)(e.li,{children:\"Can we design metrics that better reflect biological utility rather than statistical properties?\"}),`\n`,(0,n.jsx)(e.li,{children:\"How do methods perform on rare cell types not well-represented in the dataset?\"}),`\n`,(0,n.jsx)(e.li,{children:\"What is the minimal dataset size needed for each method to perform effectively?\"}),`\n`,(0,n.jsx)(e.li,{children:\"Can we predict which method suits a given tissue type a priori?\"}),`\n`,(0,n.jsx)(e.li,{children:`Can we treat gene expression patterns as samples instead of spots? Currently, each spot (with its gene expression vector) is treated as a sample. An alternative approach would be to treat each gene's expression pattern across all spots as a sample\\u2014essentially viewing each gene as an \"image\" where pixel intensities represent expression levels at different spatial locations. This gene-centric perspective might reveal different biological insights about co-expression patterns and spatial gene regulatory networks.`}),`\n`]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"conclusion\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#conclusion\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This systematic comparison of 8 self-supervised learning methods across 3 GNN architectures reveals substantial differences in how representations are learned for spatial transcriptomics data. While definitive conclusions about method superiority require more comprehensive evaluation, several patterns emerged:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Substantial method-backbone interactions\"}),\" with the same SSL method behaving very differently depending on GNN backbone\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"BYOL-SAGEConv shows balanced performance\"}),\" across diverse metrics without over-optimizing for any single one\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Redundancy reduction methods\"}),\" (VICReg, Barlow Twins) demonstrate consistency across architectures\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Evaluation challenges\"}),\" highlight the difficulty of assessing representation quality through clustering and spatial metrics alone\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Future work will focus on cross-tissue validation, biological validation through downstream tasks, and development of hybrid approaches that combine complementary strengths of different SSL families.\"}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsxs)(e.h2,{id:\"acknowledgments\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#acknowledgments\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Acknowledgments\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This analysis leveraged:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"SiT Mouse Brain dataset\"}),\" for spatial transcriptomics data\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"PyTorch Geometric\"}),\" for GNN implementations\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Scanpy\"}),\" for preprocessing and visualization\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Scikit-learn\"}),\" for evaluation metrics\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"references\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#references\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"References\"]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"SSL Methods\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Chen et al. (2020) - SimCLR: A Simple Framework for Contrastive Learning\"}),`\n`,(0,n.jsx)(e.li,{children:\"He et al. (2020) - MoCo: Momentum Contrast for Unsupervised Visual Representation Learning\"}),`\n`,(0,n.jsx)(e.li,{children:\"Grill et al. (2020) - BYOL: Bootstrap Your Own Latent\"}),`\n`,(0,n.jsx)(e.li,{children:\"Caron et al. (2020) - SwAV: Unsupervised Learning of Visual Features by Contrasting Cluster Assignments\"}),`\n`,(0,n.jsx)(e.li,{children:\"Chen & He (2021) - SimSiam: Exploring Simple Siamese Representation Learning\"}),`\n`,(0,n.jsx)(e.li,{children:\"He et al. (2022) - MAE: Masked Autoencoders Are Scalable Vision Learners\"}),`\n`,(0,n.jsx)(e.li,{children:\"Zbontar et al. (2021) - Barlow Twins: Self-Supervised Learning via Redundancy Reduction\"}),`\n`,(0,n.jsx)(e.li,{children:\"Bardes et al. (2022) - VICReg: Variance-Invariance-Covariance Regularization\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"GNN Architectures\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Hamilton et al. (2017) - GraphSAGE: Inductive Representation Learning on Large Graphs\"}),`\n`,(0,n.jsx)(e.li,{children:\"Veli\\u010Dkovi\\u0107 et al. (2018) - GAT: Graph Attention Networks\"}),`\n`,(0,n.jsx)(e.li,{children:\"Kipf & Welling (2017) - GCN: Semi-Supervised Classification with Graph Convolutional Networks\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"Spatial Transcriptomics\"}),\":\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Lebrigand et al. (2023) - The spatial landscape of gene expression isoforms in tissue sections\"}),`\n`]})]})}function d(i={}){let{wrapper:e}=i.components||{};return e?(0,n.jsx)(e,{...i,children:(0,n.jsx)(h,{...i})}):h(i)}return w(S);})();\n;return Component;"
    },
    "_id": "projects/gnn-ssl-sit.mdx",
    "_raw": {
      "sourceFilePath": "projects/gnn-ssl-sit.mdx",
      "sourceFileName": "gnn-ssl-sit.mdx",
      "sourceFileDir": "projects",
      "contentType": "mdx",
      "flattenedPath": "projects/gnn-ssl-sit"
    },
    "type": "Project",
    "url": "/projects/gnn-ssl-sit",
    "slug": "gnn-ssl-sit"
  },
  {
    "title": "Personal Website Project",
    "summary": "A modern personal website with AI-powered content search and interactive knowledge graphs",
    "status": "in-progress",
    "role": "Full-stack Developer",
    "stack": [
      "Next.js",
      "TypeScript",
      "Tailwind CSS",
      "Supabase",
      "Contentlayer"
    ],
    "repoUrl": "https://github.com/sample/personal-website",
    "demoUrl": "https://sample-website.vercel.app",
    "images": [],
    "tags": [
      "web development",
      "AI",
      "full-stack"
    ],
    "featured": false,
    "startDate": "2025-01-12T00:00:00.000Z",
    "body": {
      "raw": "\n# Personal Website Project\n\nThis project showcases a modern approach to building personal academic websites with integrated AI capabilities.\n\n## Overview\n\nThe website features:\n- Git-based content management\n- AI-powered search and chat\n- Interactive knowledge graphs\n- Responsive design with dark mode\n\n## Technology Stack\n\n- **Frontend**: Next.js with App Router, React, TypeScript\n- **Styling**: Tailwind CSS, shadcn/ui components  \n- **Content**: MDX with Contentlayer for static generation\n- **Database**: Supabase with pgvector for embeddings\n- **Deployment**: Vercel for automatic deployments\n\n## Key Features\n\n### Content Management\n- Markdown/MDX files in Git for publications and projects\n- Automatic content indexing and embedding generation\n- Support for rich media including images, videos, and PDFs\n\n### AI Agent\n- Context-aware chat interface on every page\n- Semantic search across all content\n- Graph visualization tools\n- Media preview capabilities\n\n## Architecture\n\nThe application follows a modern JAMstack approach with:\n1. Static generation for optimal performance\n2. Dynamic API routes for search and AI features  \n3. Edge functions for content processing\n4. CDN distribution for global availability",
      "code": "var Component=(()=>{var p=Object.create;var t=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty;var w=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),b=(i,e)=>{for(var a in e)t(i,a,{get:e[a],enumerable:!0})},l=(i,e,a,c)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let r of g(e))!f.call(i,r)&&r!==a&&t(i,r,{get:()=>e[r],enumerable:!(c=m(e,r))||c.enumerable});return i};var k=(i,e,a)=>(a=i!=null?p(u(i)):{},l(e||!i||!i.__esModule?t(a,\"default\",{value:i,enumerable:!0}):a,i)),v=i=>l(t({},\"__esModule\",{value:!0}),i);var s=w((x,o)=>{o.exports=_jsx_runtime});var N={};b(N,{default:()=>d,frontmatter:()=>y});var n=k(s()),y={title:\"Personal Website Project\",summary:\"A modern personal website with AI-powered content search and interactive knowledge graphs\",status:\"in-progress\",role:\"Full-stack Developer\",stack:[\"Next.js\",\"TypeScript\",\"Tailwind CSS\",\"Supabase\",\"Contentlayer\"],repoUrl:\"https://github.com/sample/personal-website\",demoUrl:\"https://sample-website.vercel.app\",tags:[\"web development\",\"AI\",\"full-stack\"],featured:!1,startDate:\"2025-01-12\"};function h(i){let e={a:\"a\",h1:\"h1\",h2:\"h2\",h3:\"h3\",li:\"li\",ol:\"ol\",p:\"p\",span:\"span\",strong:\"strong\",ul:\"ul\",...i.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"personal-website-project\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#personal-website-project\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Personal Website Project\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This project showcases a modern approach to building personal academic websites with integrated AI capabilities.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"overview\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#overview\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Overview\"]}),`\n`,(0,n.jsx)(e.p,{children:\"The website features:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Git-based content management\"}),`\n`,(0,n.jsx)(e.li,{children:\"AI-powered search and chat\"}),`\n`,(0,n.jsx)(e.li,{children:\"Interactive knowledge graphs\"}),`\n`,(0,n.jsx)(e.li,{children:\"Responsive design with dark mode\"}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"technology-stack\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#technology-stack\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Technology Stack\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Frontend\"}),\": Next.js with App Router, React, TypeScript\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Styling\"}),\": Tailwind CSS, shadcn/ui components\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Content\"}),\": MDX with Contentlayer for static generation\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Database\"}),\": Supabase with pgvector for embeddings\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Deployment\"}),\": Vercel for automatic deployments\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"key-features\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#key-features\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Key Features\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"content-management\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#content-management\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Content Management\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Markdown/MDX files in Git for publications and projects\"}),`\n`,(0,n.jsx)(e.li,{children:\"Automatic content indexing and embedding generation\"}),`\n`,(0,n.jsx)(e.li,{children:\"Support for rich media including images, videos, and PDFs\"}),`\n`]}),`\n`,(0,n.jsxs)(e.h3,{id:\"ai-agent\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#ai-agent\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"AI Agent\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Context-aware chat interface on every page\"}),`\n`,(0,n.jsx)(e.li,{children:\"Semantic search across all content\"}),`\n`,(0,n.jsx)(e.li,{children:\"Graph visualization tools\"}),`\n`,(0,n.jsx)(e.li,{children:\"Media preview capabilities\"}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"architecture\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#architecture\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Architecture\"]}),`\n`,(0,n.jsx)(e.p,{children:\"The application follows a modern JAMstack approach with:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Static generation for optimal performance\"}),`\n`,(0,n.jsx)(e.li,{children:\"Dynamic API routes for search and AI features\"}),`\n`,(0,n.jsx)(e.li,{children:\"Edge functions for content processing\"}),`\n`,(0,n.jsx)(e.li,{children:\"CDN distribution for global availability\"}),`\n`]})]})}function d(i={}){let{wrapper:e}=i.components||{};return e?(0,n.jsx)(e,{...i,children:(0,n.jsx)(h,{...i})}):h(i)}return v(N);})();\n;return Component;"
    },
    "_id": "projects/personal-website.mdx",
    "_raw": {
      "sourceFilePath": "projects/personal-website.mdx",
      "sourceFileName": "personal-website.mdx",
      "sourceFileDir": "projects",
      "contentType": "mdx",
      "flattenedPath": "projects/personal-website"
    },
    "type": "Project",
    "url": "/projects/personal-website",
    "slug": "personal-website"
  },
  {
    "title": "Self-Supervised Learning Methods",
    "summary": "An exploration of modern self-supervised learning methods including SimCLR, BYOL, SimSiam, Barlow Twins, DINO, etc, with mathematical foundations and mutual information theory",
    "status": "completed",
    "role": "Research Documentation",
    "stack": [
      "Machine Learning",
      "Computer Vision",
      "Deep Learning",
      "PyTorch"
    ],
    "images": [],
    "tags": [
      "self-supervised learning",
      "contrastive learning",
      "representation learning",
      "computer vision",
      "deep learning"
    ],
    "featured": true,
    "startDate": "2025-06-12T07:00:00.000Z",
    "body": {
      "raw": "\n# Self-Supervised Learning Methods: A Comprehensive Introduction\n\nSelf-supervised learning (SSL) has revolutionized deep learning by enabling models to learn powerful representations without labeled data. This note provides a deep dive into five major SSL paradigms and their representative methods.\n\n## Table of Contents\n\n1. [Introduction](#introduction)\n2. [Core Concepts](#core-concepts)\n3. [Contrastive Learning](#contrastive-learning)\n4. [Predictive/Bootstrap Learning](#predictive-bootstrap-learning)\n5. [Redundancy Reduction](#redundancy-reduction)\n6. [Clustering-based SSL](#clustering-based-ssl)\n7. [Generative SSL](#generative-ssl)\n8. [Mathematical Foundations](#mathematical-foundations)\n9. [Summary](#summary)\n\n## Introduction\n\nSelf-supervised learning addresses a fundamental question: **Can we learn good representations without labels?**\n\nMy first impression of SSL came from Dr. Yann LeCun's lecture, where I first heard about the fascinating idea of **joint embedding** (highly recommend [Alfredo Canziani's notes](https://atcold.github.io/NYU-DLSP21/en/week15/15-1/)).\n\n### What \"Joint Embedding\" Means\n\n**Embedding** = mapping an input (image, sentence, etc.) into a vector representation $z \\in \\mathbb{R}^d$.\n\n**Joint** = you learn two (or more) embeddings of the same underlying object — usually two augmented views — and train the system so that these embeddings are related in a desired way.\n\nSo a joint embedding method learns a function $f_\\theta(\\cdot)$ such that for two correlated inputs $x, y$:\n\n$$h_x = f_\\theta(x), \\quad h_y = f_\\theta(y)$$\n\nand the training objective makes $x$ and $y$ similar (while keeping them informative).\n\n![Joint Embedding Method](/projects/ssl/joint_embedding.png)\n*Joint Embedding Method, by Alfredo Canziani and Jiachen Zhu* \n\n\nAll SSL methods balance two competing forces:\n- **Invariance**: Make representations stable under data augmentations\n- **Information preservation**: Avoid trivial constant outputs (collapse)\n\nDifferent SSL families handle this trade-off in unique ways.\n\n## Core Concepts\n\n### Mutual Information (MI)\n\nFor two random variables $X$ and $Y$:\n\n$$I(X;Y) = H(X) - H(X|Y) = H(Y) - H(Y|X)$$\n\nIn SSL, we want embeddings $z_1 = f(X)$, $z_2 = f(Y)$ (from two augmented views) that share semantic information (high MI).\n\n### The Collapse Problem\n\nIf we only minimize $\\|z_1 - z_2\\|^2$ without constraints, the network collapses to outputting constants, resulting in $I = 0$.\n\n### SSL Family Comparison\n\nDifferent SSL families use different mechanisms to prevent collapse and estimate mutual information:\n\nAll modern SSL objectives can be written conceptually as:\n\n$$\\text{Maximize } I(z_1; z_2) - \\alpha R(z)$$\n\nwhere $R(z)$ regularizes representations (avoid trivial solutions).\n\n| Family | Representative Models | Core Objective | $R(z)$ Regularizer | MI Estimation Mechanism |\n|--------|----------------------|----------------|-------------------|-------------------------|\n| Contrastive | SimCLR, MoCo, SwAV | Discriminate positives vs negatives | implicit via negatives | InfoNCE lower bound |\n| Predictive / Bootstrap | BYOL, SimSiam, DINO, iBOT | Predict target view (teacher/student) | asymmetry (EMA / stop-grad) | alignment loss |\n| Redundancy Reduction | Barlow Twins, VICReg | Decorrelate and keep variance | variance & covariance penalties | decorrelation |\n| Clustering | SwAV, SeLa | Maintain consistent cluster assignment | entropy balancing of prototypes | categorical MI |\n| Generative | MAE, BEiT, SimMIM | Reconstruct masked input | reconstruction constraint | $I(z_1; z_2)$ |\n\n\n## Contrastive Learning\n\n**Core Idea**: Learn by discriminating positive (same instance) vs. negative (different instance) pairs.\n\n### SimCLR (2020)\n\n![SimCLR Illustration](/projects/ssl/simclr.gif)\n*SimCLR Illustration, by https://research.google/blog/advancing-self-supervised-and-semi-supervised-learning-with-simclr/* \n\n**Pipeline**:\n1. Generate two augmentations of the same image\n2. Pass through encoder $f_\\theta$ → embeddings $h_1, h_2$\n3. Add projection MLP $g_\\theta$: $z_1 = g(h_1)$, $z_2 = g(h_2)$\n4. Apply InfoNCE loss:\n\n$$L_{\\text{InfoNCE}} = -\\log \\frac{\\exp(\\text{sim}(z_1, z_2)/\\tau)}{\\sum_{k=1}^{2N} \\exp(\\text{sim}(z_1, z_k)/\\tau)}$$\n\n**Key Insight**: Needs large batches or memory banks for good negatives.\n\n**Connection to MI**: Oord et al. (2018) proved:\n\n$$I(z_1; z_2) \\geq \\log(N) - L_{\\text{InfoNCE}}$$\n\nSo minimizing InfoNCE maximizes a lower bound on MI.\n\n### MoCo (Momentum Contrast)\n\n![MoCo Illustration](/projects/ssl/moco.png)\n*MoCo Illustration, by https://doi.org/10.48550/arXiv.1911.05722* \n\n**Innovation**:\n- Maintains a momentum encoder and queue of old embeddings as negatives\n- Online encoder updates quickly; momentum encoder updates slowly through [Exponential Moving Average (EMA)](/projects/ssl/ema.html)\n- Works with smaller batches\n\n**Effect**: Stabilizes contrastive training without requiring large batches.\n\n## Predictive Bootstrap Learning\n\n**Core Idea**: Predict one view from another without negatives using asymmetry.\n\n### BYOL (Bootstrap Your Own Latent, 2020)\n\n![BYOL Illustration](/projects/ssl/byol.png)\n*BYOL Illustration, by https://doi.org/10.48550/arXiv.2006.07733* \n\n**Architecture**:\n- **Online network**: encoder $f_\\theta$, projector $g_\\theta$, predictor $q_\\theta$\n- **Target network**: encoder $f_\\xi$, projector $g_\\xi$\n- Parameters $\\xi$ update via EMA: $\\xi \\leftarrow m\\xi + (1-m)\\theta$\n\n**Loss**:\n\n$$L = \\|q_\\theta(g_\\theta(f_\\theta(x_1))) - g_\\xi(f_\\xi(x_2))\\|^2$$\n\n**Why It Works**: The slow-moving target stabilizes learning and preserves variance.\n\n### SimSiam (2021)\n\n![SimSiam Illustration](/projects/ssl/simsiam.png)\n*SimSiam Illustration, by https://doi.org/10.48550/arXiv.2011.10566* \n\n**Simplification**: No momentum encoder!\n\n**Mechanism**:\n- Two identical branches (same encoder + projector)\n- One has a predictor on top\n- **Crucially**: stop-gradient on one branch\n\n**Loss**:\n\n$$L = -\\cos(p_1, \\text{stopgrad}(z_2)) - \\cos(p_2, \\text{stopgrad}(z_1))$$\n\n**Key Insight**: Stop-gradient breaks symmetry and prevents collapse by creating asymmetric gradient flow.\n\n### DINO (2021)\n\n![DINO Illustration](/projects/ssl/dino.gif)\n*DINO Illustration, by https://doi.org/10.48550/arXiv.2104.14294* \n\n**Extension**: Scales BYOL-style training to Vision Transformers.\n\n**Mechanism**:\n- Teacher-student setup with EMA teacher\n- Both output soft probability distributions (after softmax)\n- Loss: cross-entropy between student and teacher outputs\n- Uses centering and sharpening on teacher outputs\n\n**Emergence**: DINO's embeddings show emergent segmentation—ViTs attend to semantic regions without labels!\n\n### iBOT (2022)\n\n![iBOT Illustration](/projects/ssl/ibot.png)\n*iBOT Illustration, by https://doi.org/10.48550/arXiv.2111.07832* \n\n**Hybrid**: Combines DINO + masked prediction.\n\n**Innovation**:\n- Mask random patches of ViT input\n- Predict their teacher-assigned tokens\n- Unifies predictive and generative principles\n\n## Redundancy Reduction\n\n**Core Idea**: Encourage invariant, diverse, and decorrelated representations.\n\n### Barlow Twins (2021)\n\n![Barlow Twins Illustration](/projects/ssl/barlow_twins.png)\n*Barlow Twins Illustration, by https://doi.org/10.48550/arXiv.2103.03230* \n\n**Mechanism**:\n\nCompute cross-correlation matrix $C_{ij} = \\frac{1}{N}\\sum_n \\frac{z_{1,i}^{(n)} z_{2,j}^{(n)}}{\\sigma(z_{1,i})\\sigma(z_{2,j})}$\n\n**Loss**:\n\n$$L_{BT} = \\sum_i (1 - C_{ii})^2 + \\lambda \\sum_{i \\neq j} C_{ij}^2$$\n\n- **Diagonal terms → 1**: High per-dimension agreement (↑ MI)\n- **Off-diagonal → 0**: Decorrelate features (prevent collapse)\n\n**Interpretation**: Under Gaussianity, this approximates maximizing per-dimension MI while preventing \"all-info-in-one-dim\" collapse.\n\n### VICReg (2022)\n\n![VICReg Twins Illustration](/projects/ssl/vicreg.png)\n*VICReg Twins Illustration, by https://doi.org/10.48550/arXiv.2105.04906* \n\n**Explicit Decomposition**:\n\n$$L = \\lambda_{\\text{inv}} \\|z_1 - z_2\\|^2 + \\lambda_{\\text{var}} L_{\\text{var}} + \\lambda_{\\text{cov}} L_{\\text{cov}}$$\n\n**Three Terms**:\n\n1. **Invariance**: $L_{\\text{inv}} = \\|z_1 - z_2\\|^2$ (alignment)\n2. **Variance**: $L_{\\text{var}} = \\frac{1}{d}\\sum_j \\max(0, \\gamma - \\text{Std}(z_{\\cdot j}))$ (keeps $H(z)$ high)\n3. **Covariance**: $L_{\\text{cov}} = \\frac{1}{d}\\sum_{i \\neq j} \\text{Cov}(z)_{ij}^2$ (redundancy reduction)\n\n**Advantage**: Easier to reason about mathematically; no momentum, stop-grad, or large batches needed.\n\n## Clustering-based SSL\n\n**Core Idea**: Group similar embeddings into prototypes and enforce consistent cluster assignments.\n\n### SwAV (2020)\n\n![SwAV Illustration](/projects/ssl/swav.gif)\n*SwAV Illustration, by https://doi.org/10.48550/arXiv.2006.09882* \n\n**Hybrid Approach**: Merges contrastive and clustering learning.\n\n**Mechanism**:\n1. Maintain learnable prototype vectors $C = \\{c_1, \\ldots, c_K\\}$\n2. For each augmented view $x^{(a)}$, encode to feature $z^{(a)}$ using shared encoder\n3. Compute soft assignments $q^{(a)}$ of features to prototypes using Sinkhorn-Knopp algorithm (enforces balanced cluster usage across batch)\n4. Predict one view's prototype assignments from another—swap assignments between augmentations\n\n**Loss**:\nCross-entropy between predicted prototype distribution of one view and balanced assignment of the other:\n\n$$L = -\\sum_i q_i^{(1)} \\log p_i^{(2)} - \\sum_i q_i^{(2)} \\log p_i^{(1)}$$\n\n**Benefits**:\n- No explicit negative pairs needed\n- Encourages semantic grouping through prototype consistency\n- Balanced clustering stabilizes training and accelerates convergence\n- Works well even with small batch sizes\n\n## Generative SSL\n\n**Core Idea**: Learn by reconstructing input (or missing parts).\n\n### Masked Autoencoder (MAE, 2021)\n\n![MAE Twins Illustration](/projects/ssl/mae.png)\n*MAE Twins Illustration, by https://doi.org/10.48550/arXiv.2111.06377* \n\n**Mechanism**:\n- Mask 75% of ViT patches\n- Encoder sees only unmasked patches\n- Lightweight decoder reconstructs masked pixels\n- Loss: MSE on masked patches\n\n**Why Effective**: Forces encoder to learn global structure without contrastive signals.\n\n**Connection to MI**: If the decoder models $p_\\theta(x_m | x_v)$,\n\n$$\\mathbb{E}[-\\log p_\\theta(x_m | x_v)] \\approx H(x_m | x_v)$$\n\nMinimizing reconstruction ≈ minimizing $H(x_m | x_v)$, thus maximizing $I(x_v; x_m) = H(x_m) - H(x_m | x_v)$.\n\n\n## Mathematical Foundations\n\n### Unified Framework\n\nAll SSL methods can be viewed as:\n\n$$\\max_f \\underbrace{I(z_1; z_2)}_{\\text{alignment}} - \\alpha \\underbrace{R_{\\text{entropy}}(z)}_{\\text{avoid collapse}} - \\beta \\underbrace{R_{\\text{redundancy}}(z)}_{\\text{spread info}}$$\n\n### Loss-to-MI Connections\n\n#### InfoNCE → MI Lower Bound\n\nWith similarity score $s(z_1, z_2) = \\frac{1}{\\tau}\\cos(z_1, z_2)$:\n\n$$I(z_1; z_2) \\geq \\log N - L_{\\text{InfoNCE}}$$\n\nThe numerator estimates joint $p(z_1, z_2)$; negatives approximate marginals $p(z_1)p(z_2)$.\n\n#### Cosine/MSE → MI (Gaussian Assumption)\n\nFor whitened, approximately Gaussian representations:\n\n$$\\cos(z_1, z_2) = 1 - \\frac{1}{2}\\|z_1 - z_2\\|^2 \\text{ (first-order on unit sphere)}$$\n\nIf $(z_1, z_2)$ are jointly Gaussian with correlation $\\Sigma$:\n\n$$I(z_1; z_2) = -\\frac{1}{2}\\log\\det(I - \\Sigma_{12}\\Sigma_{21})$$\n\nIncreasing correlation (reducing $\\|z_1 - z_2\\|$) monotonically increases MI.\n\n#### Reconstruction → Conditional Entropy\n\n$$\\mathbb{E}[-\\log p_\\theta(x_m | x_v)] \\approx H(x_m | x_v)$$\n\nSince $I(x_v; x_m) = H(x_m) - H(x_m | x_v)$, reconstruction maximizes MI.\n\n#### Barlow Twins → Decorrelated MI\n\nPushing $C_{ii} \\to 1$ (high per-dimension MI) and $C_{ij} \\to 0$ (decorrelation) prevents redundancy while maximizing information.\n\n#### VICReg → Explicit Regularization\n\n- Invariance raises $I(z_1; z_2)$\n- Variance prevents degenerate low-entropy $z$\n- Covariance spreads information across dimensions\n\nUnder Gaussianity, these terms are direct surrogates for \"maximize MI while preventing collapse and redundancy.\"\n\n### Collapse Prevention Mechanisms\n\n| Method | Mechanism |\n|--------|-----------|\n| SimCLR | Negatives estimate marginal $p(z_2)$ |\n| BYOL | EMA teacher provides stable target |\n| SimSiam | Stop-gradient creates asymmetry |\n| DINO | Temperature sharpening + centering |\n| Barlow Twins | Off-diagonal penalty → decorrelation |\n| VICReg | Explicit variance regularization |\n| SwAV | Entropy balancing of prototypes |\n| MAE | Reconstruction constraint |\n\n## Summary\n\n### Key Insights\n\n1. **All methods maximize MI** between augmented views while preventing collapse\n2. **Negatives are not necessary** — asymmetry (EMA/stop-grad) or explicit regularization suffices\n3. **Mathematical elegance** varies: VICReg is most interpretable, InfoNCE has strongest theoretical foundation\n4. **Emergence in ViTs**: DINO/MAE show that SSL enables semantic understanding without labels\n5. **Hybrid approaches** (iBOT, MSN) combine strengths of multiple paradigms\n\n\n## References\n\n1. Chen et al. (2020). \"A Simple Framework for Contrastive Learning of Visual Representations\" (SimCLR)\n2. Grill et al. (2020). \"Bootstrap Your Own Latent\" (BYOL)\n3. Chen & He (2021). \"Exploring Simple Siamese Representation Learning\" (SimSiam)\n4. Zbontar et al. (2021). \"Barlow Twins: Self-Supervised Learning via Redundancy Reduction\"\n5. Bardes et al. (2022). \"VICReg: Variance-Invariance-Covariance Regularization\"\n6. Caron et al. (2021). \"Emerging Properties in Self-Supervised Vision Transformers\" (DINO)\n7. He et al. (2021). \"Masked Autoencoders Are Scalable Vision Learners\" (MAE)\n8. Zhou et al. (2022). \"iBOT: Image BERT Pre-Training with Online Tokenizer\"\n\n## Conclusion\n\nSelf-supervised learning has matured from requiring large batches of negatives (SimCLR) to elegant formulations based on redundancy reduction (VICReg) and masked prediction (DINO). The key insight is that **meaningful representations emerge when models balance invariance to augmentations with preservation of information diversity**.\n\nThe field continues to evolve, with recent work focusing on:\n- Scaling to billion-image datasets (DINOv2, SEER)\n- Multi-modal learning (CLIP, Data2Vec)\n- Efficient training (faster convergence, lower compute)\n- Theoretical understanding (why does stop-gradient work?)\n\nUnderstanding these fundamentals provides a strong foundation for both using and extending self-supervised learning methods.\n",
      "code": "var Component=(()=>{var p=Object.create;var i=Object.defineProperty;var o=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty;var v=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),u=(a,s)=>{for(var l in s)i(a,l,{get:s[l],enumerable:!0})},t=(a,s,l,m)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of g(s))!y.call(a,n)&&n!==l&&i(a,n,{get:()=>s[n],enumerable:!(m=o(s,n))||m.enumerable});return a};var z=(a,s,l)=>(l=a!=null?p(N(a)):{},t(s||!a||!a.__esModule?i(l,\"default\",{value:a,enumerable:!0}):l,a)),x=a=>t(i({},\"__esModule\",{value:!0}),a);var r=v((w,c)=>{c.exports=_jsx_runtime});var R={};u(R,{default:()=>d,frontmatter:()=>b});var e=z(r()),b={title:\"Self-Supervised Learning Methods\",summary:\"An exploration of modern self-supervised learning methods including SimCLR, BYOL, SimSiam, Barlow Twins, DINO, etc, with mathematical foundations and mutual information theory\",status:\"completed\",role:\"Research Documentation\",stack:[\"Machine Learning\",\"Computer Vision\",\"Deep Learning\",\"PyTorch\"],tags:[\"self-supervised learning\",\"contrastive learning\",\"representation learning\",\"computer vision\",\"deep learning\"],featured:!0,startDate:\"2025-6-12\"};function h(a){let s={a:\"a\",annotation:\"annotation\",em:\"em\",h1:\"h1\",h2:\"h2\",h3:\"h3\",h4:\"h4\",img:\"img\",li:\"li\",math:\"math\",mfrac:\"mfrac\",mi:\"mi\",mn:\"mn\",mo:\"mo\",mrow:\"mrow\",mspace:\"mspace\",msub:\"msub\",msubsup:\"msubsup\",msup:\"msup\",mtext:\"mtext\",munder:\"munder\",ol:\"ol\",p:\"p\",path:\"path\",semantics:\"semantics\",span:\"span\",strong:\"strong\",svg:\"svg\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...a.components};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(s.h1,{id:\"self-supervised-learning-methods-a-comprehensive-introduction\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#self-supervised-learning-methods-a-comprehensive-introduction\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Self-Supervised Learning Methods: A Comprehensive Introduction\"]}),`\n`,(0,e.jsx)(s.p,{children:\"Self-supervised learning (SSL) has revolutionized deep learning by enabling models to learn powerful representations without labeled data. This note provides a deep dive into five major SSL paradigms and their representative methods.\"}),`\n`,(0,e.jsxs)(s.h2,{id:\"table-of-contents\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#table-of-contents\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Table of Contents\"]}),`\n`,(0,e.jsxs)(s.ol,{children:[`\n`,(0,e.jsx)(s.li,{children:(0,e.jsx)(s.a,{href:\"#introduction\",children:\"Introduction\"})}),`\n`,(0,e.jsx)(s.li,{children:(0,e.jsx)(s.a,{href:\"#core-concepts\",children:\"Core Concepts\"})}),`\n`,(0,e.jsx)(s.li,{children:(0,e.jsx)(s.a,{href:\"#contrastive-learning\",children:\"Contrastive Learning\"})}),`\n`,(0,e.jsx)(s.li,{children:(0,e.jsx)(s.a,{href:\"#predictive-bootstrap-learning\",children:\"Predictive/Bootstrap Learning\"})}),`\n`,(0,e.jsx)(s.li,{children:(0,e.jsx)(s.a,{href:\"#redundancy-reduction\",children:\"Redundancy Reduction\"})}),`\n`,(0,e.jsx)(s.li,{children:(0,e.jsx)(s.a,{href:\"#clustering-based-ssl\",children:\"Clustering-based SSL\"})}),`\n`,(0,e.jsx)(s.li,{children:(0,e.jsx)(s.a,{href:\"#generative-ssl\",children:\"Generative SSL\"})}),`\n`,(0,e.jsx)(s.li,{children:(0,e.jsx)(s.a,{href:\"#mathematical-foundations\",children:\"Mathematical Foundations\"})}),`\n`,(0,e.jsx)(s.li,{children:(0,e.jsx)(s.a,{href:\"#summary\",children:\"Summary\"})}),`\n`]}),`\n`,(0,e.jsxs)(s.h2,{id:\"introduction\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#introduction\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Introduction\"]}),`\n`,(0,e.jsxs)(s.p,{children:[\"Self-supervised learning addresses a fundamental question: \",(0,e.jsx)(s.strong,{children:\"Can we learn good representations without labels?\"})]}),`\n`,(0,e.jsxs)(s.p,{children:[\"My first impression of SSL came from Dr. Yann LeCun's lecture, where I first heard about the fascinating idea of \",(0,e.jsx)(s.strong,{children:\"joint embedding\"}),\" (highly recommend \",(0,e.jsx)(s.a,{href:\"https://atcold.github.io/NYU-DLSP21/en/week15/15-1/\",children:\"Alfredo Canziani's notes\"}),\").\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"what-joint-embedding-means\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#what-joint-embedding-means\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),'What \"Joint Embedding\" Means']}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Embedding\"}),\" = mapping an input (image, sentence, etc.) into a vector representation \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mo,{children:\"\\u2208\"}),(0,e.jsxs)(s.msup,{children:[(0,e.jsx)(s.mi,{mathvariant:\"double-struck\",children:\"R\"}),(0,e.jsx)(s.mi,{children:\"d\"})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"z \\\\in \\\\mathbb{R}^d\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.5782em\",verticalAlign:\"-0.0391em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"\\u2208\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8491em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathbb\",children:\"R\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsx)(s.span,{className:\"vlist-t\",children:(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.8491em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"d\"})})]})})})})})]})]})]})]}),\".\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Joint\"}),\" = you learn two (or more) embeddings of the same underlying object \\u2014 usually two augmented views \\u2014 and train the system so that these embeddings are related in a desired way.\"]}),`\n`,(0,e.jsxs)(s.p,{children:[\"So a joint embedding method learns a function \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"f\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mo,{children:\"\\u22C5\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"f_\\\\theta(\\\\cdot)\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10764em\"},children:\"f\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1076em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u22C5\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})})]}),\" such that for two correlated inputs \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsx)(s.mi,{children:\"y\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"x, y\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"y\"})]})})]}),\":\"]}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"h\"}),(0,e.jsx)(s.mi,{children:\"x\"})]}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"f\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsx)(s.mspace,{width:\"1em\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"h\"}),(0,e.jsx)(s.mi,{children:\"y\"})]}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"f\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"y\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"h_x = f_\\\\theta(x), \\\\quad h_y = f_\\\\theta(y)\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8444em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"h\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"x\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10764em\"},children:\"f\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1076em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"1em\"}}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"h\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"y\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10764em\"},children:\"f\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1076em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"y\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]})}),`\n`,(0,e.jsxs)(s.p,{children:[\"and the training objective makes \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsx)(s.mi,{children:\"x\"})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"x\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"})]})})]}),\" and \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsx)(s.mi,{children:\"y\"})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"y\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"y\"})]})})]}),\" similar (while keeping them informative).\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.img,{src:\"/projects/ssl/joint_embedding.png\",alt:\"Joint Embedding Method\"}),`\n`,(0,e.jsx)(s.em,{children:\"Joint Embedding Method, by Alfredo Canziani and Jiachen Zhu\"})]}),`\n`,(0,e.jsx)(s.p,{children:\"All SSL methods balance two competing forces:\"}),`\n`,(0,e.jsxs)(s.ul,{children:[`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Invariance\"}),\": Make representations stable under data augmentations\"]}),`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Information preservation\"}),\": Avoid trivial constant outputs (collapse)\"]}),`\n`]}),`\n`,(0,e.jsx)(s.p,{children:\"Different SSL families handle this trade-off in unique ways.\"}),`\n`,(0,e.jsxs)(s.h2,{id:\"core-concepts\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#core-concepts\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Core Concepts\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"mutual-information-mi\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#mutual-information-mi\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Mutual Information (MI)\"]}),`\n`,(0,e.jsxs)(s.p,{children:[\"For two random variables \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsx)(s.mi,{children:\"X\"})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"X\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"X\"})]})})]}),\" and \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsx)(s.mi,{children:\"Y\"})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"Y\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.22222em\"},children:\"Y\"})]})})]}),\":\"]}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"I\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"X\"}),(0,e.jsx)(s.mo,{separator:\"true\",children:\";\"}),(0,e.jsx)(s.mi,{children:\"Y\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mi,{children:\"H\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"X\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mi,{children:\"H\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"X\"}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,e.jsx)(s.mi,{children:\"Y\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mi,{children:\"H\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"Y\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mi,{children:\"H\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"Y\"}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,e.jsx)(s.mi,{children:\"X\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"I(X;Y) = H(X) - H(X|Y) = H(Y) - H(Y|X)\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"I\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"X\"}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\";\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.22222em\"},children:\"Y\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"X\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"X\"}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2223\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.22222em\"},children:\"Y\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.22222em\"},children:\"Y\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.22222em\"},children:\"Y\"}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2223\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"X\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]})}),`\n`,(0,e.jsxs)(s.p,{children:[\"In SSL, we want embeddings \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mi,{children:\"f\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"X\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"z_1 = f(X)\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10764em\"},children:\"f\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"X\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]}),\", \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mi,{children:\"f\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"Y\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"z_2 = f(Y)\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10764em\"},children:\"f\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.22222em\"},children:\"Y\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]}),\" (from two augmented views) that share semantic information (high MI).\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"the-collapse-problem\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#the-collapse-problem\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"The Collapse Problem\"]}),`\n`,(0,e.jsxs)(s.p,{children:[\"If we only minimize \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2225\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsxs)(s.msup,{children:[(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2225\"}),(0,e.jsx)(s.mn,{children:\"2\"})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"\\\\|z_1 - z_2\\\\|^2\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2225\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.0641em\",verticalAlign:\"-0.25em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2225\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsx)(s.span,{className:\"vlist-t\",children:(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})})})})})]})]})]})]}),\" without constraints, the network collapses to outputting constants, resulting in \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"I\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mn,{children:\"0\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"I = 0\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"I\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,e.jsx)(s.span,{className:\"mord\",children:\"0\"})]})]})]}),\".\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"ssl-family-comparison\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#ssl-family-comparison\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"SSL Family Comparison\"]}),`\n`,(0,e.jsx)(s.p,{children:\"Different SSL families use different mechanisms to prevent collapse and estimate mutual information:\"}),`\n`,(0,e.jsx)(s.p,{children:\"All modern SSL objectives can be written conceptually as:\"}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mtext,{children:\"Maximize\\xA0\"}),(0,e.jsx)(s.mi,{children:\"I\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\";\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mi,{children:\"\\u03B1\"}),(0,e.jsx)(s.mi,{children:\"R\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"\\\\text{Maximize } I(z_1; z_2) - \\\\alpha R(z)\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord text\",children:(0,e.jsx)(s.span,{className:\"mord\",children:\"Maximize\\xA0\"})}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"I\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\";\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]})}),`\n`,(0,e.jsxs)(s.p,{children:[\"where \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"R\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"R(z)\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})})]}),\" regularizes representations (avoid trivial solutions).\"]}),`\n`,(0,e.jsxs)(s.table,{children:[(0,e.jsx)(s.thead,{children:(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.th,{children:\"Family\"}),(0,e.jsx)(s.th,{children:\"Representative Models\"}),(0,e.jsx)(s.th,{children:\"Core Objective\"}),(0,e.jsxs)(s.th,{children:[(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"R\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"R(z)\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})})]}),\" Regularizer\"]}),(0,e.jsx)(s.th,{children:\"MI Estimation Mechanism\"})]})}),(0,e.jsxs)(s.tbody,{children:[(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.td,{children:\"Contrastive\"}),(0,e.jsx)(s.td,{children:\"SimCLR, MoCo, SwAV\"}),(0,e.jsx)(s.td,{children:\"Discriminate positives vs negatives\"}),(0,e.jsx)(s.td,{children:\"implicit via negatives\"}),(0,e.jsx)(s.td,{children:\"InfoNCE lower bound\"})]}),(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.td,{children:\"Predictive / Bootstrap\"}),(0,e.jsx)(s.td,{children:\"BYOL, SimSiam, DINO, iBOT\"}),(0,e.jsx)(s.td,{children:\"Predict target view (teacher/student)\"}),(0,e.jsx)(s.td,{children:\"asymmetry (EMA / stop-grad)\"}),(0,e.jsx)(s.td,{children:\"alignment loss\"})]}),(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.td,{children:\"Redundancy Reduction\"}),(0,e.jsx)(s.td,{children:\"Barlow Twins, VICReg\"}),(0,e.jsx)(s.td,{children:\"Decorrelate and keep variance\"}),(0,e.jsx)(s.td,{children:\"variance & covariance penalties\"}),(0,e.jsx)(s.td,{children:\"decorrelation\"})]}),(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.td,{children:\"Clustering\"}),(0,e.jsx)(s.td,{children:\"SwAV, SeLa\"}),(0,e.jsx)(s.td,{children:\"Maintain consistent cluster assignment\"}),(0,e.jsx)(s.td,{children:\"entropy balancing of prototypes\"}),(0,e.jsx)(s.td,{children:\"categorical MI\"})]}),(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.td,{children:\"Generative\"}),(0,e.jsx)(s.td,{children:\"MAE, BEiT, SimMIM\"}),(0,e.jsx)(s.td,{children:\"Reconstruct masked input\"}),(0,e.jsx)(s.td,{children:\"reconstruction constraint\"}),(0,e.jsx)(s.td,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"I\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\";\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"I(z_1; z_2)\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"I\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\";\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})})]})})]})]})]}),`\n`,(0,e.jsxs)(s.h2,{id:\"contrastive-learning\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#contrastive-learning\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Contrastive Learning\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Core Idea\"}),\": Learn by discriminating positive (same instance) vs. negative (different instance) pairs.\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"simclr-2020\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#simclr-2020\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"SimCLR (2020)\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.img,{src:\"/projects/ssl/simclr.gif\",alt:\"SimCLR Illustration\"}),`\n`,(0,e.jsxs)(s.em,{children:[\"SimCLR Illustration, by \",(0,e.jsx)(s.a,{href:\"https://research.google/blog/advancing-self-supervised-and-semi-supervised-learning-with-simclr/\",children:\"https://research.google/blog/advancing-self-supervised-and-semi-supervised-learning-with-simclr/\"})]})]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Pipeline\"}),\":\"]}),`\n`,(0,e.jsxs)(s.ol,{children:[`\n`,(0,e.jsx)(s.li,{children:\"Generate two augmentations of the same image\"}),`\n`,(0,e.jsxs)(s.li,{children:[\"Pass through encoder \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"f\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"f_\\\\theta\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10764em\"},children:\"f\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1076em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})})]}),\" \\u2192 embeddings \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"h\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"h\"}),(0,e.jsx)(s.mn,{children:\"2\"})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"h_1, h_2\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"h\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"h\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})})]})]}),`\n`,(0,e.jsxs)(s.li,{children:[\"Add projection MLP \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"g\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"g_\\\\theta\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"g\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})})]}),\": \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mi,{children:\"g\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"h\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"z_1 = g(h_1)\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"g\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"h\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]}),\", \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mi,{children:\"g\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"h\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"z_2 = g(h_2)\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"g\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"h\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]})]}),`\n`,(0,e.jsx)(s.li,{children:\"Apply InfoNCE loss:\"}),`\n`]}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"L\"}),(0,e.jsx)(s.mtext,{children:\"InfoNCE\"})]}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mi,{children:\"log\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsxs)(s.mfrac,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"exp\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mtext,{children:\"sim\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"/\"}),(0,e.jsx)(s.mi,{children:\"\\u03C4\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msubsup,{children:[(0,e.jsx)(s.mo,{children:\"\\u2211\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"k\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mn,{children:\"2\"}),(0,e.jsx)(s.mi,{children:\"N\"})]})]}),(0,e.jsx)(s.mi,{children:\"exp\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mtext,{children:\"sim\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mi,{children:\"k\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"/\"}),(0,e.jsx)(s.mi,{children:\"\\u03C4\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"L_{\\\\text{InfoNCE}} = -\\\\log \\\\frac{\\\\exp(\\\\text{sim}(z_1, z_2)/\\\\tau)}{\\\\sum_{k=1}^{2N} \\\\exp(\\\\text{sim}(z_1, z_k)/\\\\tau)}\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"L\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"InfoNCE\"})})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.6647em\",verticalAlign:\"-0.6547em\"}}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[\"lo\",(0,e.jsx)(s.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mopen nulldelimiter\"}),(0,e.jsx)(s.span,{className:\"mfrac\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"1.01em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.5703em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsxs)(s.span,{className:\"mop mtight\",children:[(0,e.jsx)(s.span,{className:\"mop op-symbol small-op mtight\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.8852em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.1786em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"}),(0,e.jsx)(s.span,{className:\"mrel mtight\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})]})})]}),(0,e.jsxs)(s.span,{style:{top:\"-2.8971em\",marginRight:\"0.0714em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.10903em\"},children:\"N\"})]})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3214em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace mtight\",style:{marginRight:\"0.1952em\"}}),(0,e.jsxs)(s.span,{className:\"mop mtight\",children:[(0,e.jsx)(s.span,{className:\"mtight\",children:\"e\"}),(0,e.jsx)(s.span,{className:\"mtight\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"mtight\",children:\"p\"})]}),(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"sim\"})}),(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3173em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.357em\",marginLeft:\"-0.044em\",marginRight:\"0.0714em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct mtight\",children:\",\"}),(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.3488em\",marginLeft:\"-0.044em\",marginRight:\"0.0714em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1512em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"/\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"})]})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.23em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.485em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsxs)(s.span,{className:\"mop mtight\",children:[(0,e.jsx)(s.span,{className:\"mtight\",children:\"e\"}),(0,e.jsx)(s.span,{className:\"mtight\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"mtight\",children:\"p\"})]}),(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"sim\"})}),(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3173em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.357em\",marginLeft:\"-0.044em\",marginRight:\"0.0714em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct mtight\",children:\",\"}),(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3173em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.357em\",marginLeft:\"-0.044em\",marginRight:\"0.0714em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"/\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.6547em\"},children:(0,e.jsx)(s.span,{})})})]})}),(0,e.jsx)(s.span,{className:\"mclose nulldelimiter\"})]})]})]})]})}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Key Insight\"}),\": Needs large batches or memory banks for good negatives.\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Connection to MI\"}),\": Oord et al. (2018) proved:\"]}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"I\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\";\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"\\u2265\"}),(0,e.jsx)(s.mi,{children:\"log\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"N\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"L\"}),(0,e.jsx)(s.mtext,{children:\"InfoNCE\"})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"I(z_1; z_2) \\\\geq \\\\log(N) - L_{\\\\text{InfoNCE}}\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"I\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\";\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"\\u2265\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[\"lo\",(0,e.jsx)(s.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10903em\"},children:\"N\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"L\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"InfoNCE\"})})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})]})]})}),`\n`,(0,e.jsx)(s.p,{children:\"So minimizing InfoNCE maximizes a lower bound on MI.\"}),`\n`,(0,e.jsxs)(s.h3,{id:\"moco-momentum-contrast\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#moco-momentum-contrast\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"MoCo (Momentum Contrast)\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.img,{src:\"/projects/ssl/moco.png\",alt:\"MoCo Illustration\"}),`\n`,(0,e.jsxs)(s.em,{children:[\"MoCo Illustration, by \",(0,e.jsx)(s.a,{href:\"https://doi.org/10.48550/arXiv.1911.05722\",children:\"https://doi.org/10.48550/arXiv.1911.05722\"})]})]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Innovation\"}),\":\"]}),`\n`,(0,e.jsxs)(s.ul,{children:[`\n`,(0,e.jsx)(s.li,{children:\"Maintains a momentum encoder and queue of old embeddings as negatives\"}),`\n`,(0,e.jsxs)(s.li,{children:[\"Online encoder updates quickly; momentum encoder updates slowly through \",(0,e.jsx)(s.a,{href:\"/projects/ssl/ema.html\",children:\"Exponential Moving Average (EMA)\"})]}),`\n`,(0,e.jsx)(s.li,{children:\"Works with smaller batches\"}),`\n`]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Effect\"}),\": Stabilizes contrastive training without requiring large batches.\"]}),`\n`,(0,e.jsxs)(s.h2,{id:\"predictive-bootstrap-learning\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#predictive-bootstrap-learning\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Predictive Bootstrap Learning\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Core Idea\"}),\": Predict one view from another without negatives using asymmetry.\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"byol-bootstrap-your-own-latent-2020\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#byol-bootstrap-your-own-latent-2020\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"BYOL (Bootstrap Your Own Latent, 2020)\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.img,{src:\"/projects/ssl/byol.png\",alt:\"BYOL Illustration\"}),`\n`,(0,e.jsxs)(s.em,{children:[\"BYOL Illustration, by \",(0,e.jsx)(s.a,{href:\"https://doi.org/10.48550/arXiv.2006.07733\",children:\"https://doi.org/10.48550/arXiv.2006.07733\"})]})]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Architecture\"}),\":\"]}),`\n`,(0,e.jsxs)(s.ul,{children:[`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Online network\"}),\": encoder \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"f\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"f_\\\\theta\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10764em\"},children:\"f\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1076em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})})]}),\", projector \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"g\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"g_\\\\theta\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"g\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})})]}),\", predictor \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"q\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"q_\\\\theta\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})})]})]}),`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Target network\"}),\": encoder \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"f\"}),(0,e.jsx)(s.mi,{children:\"\\u03BE\"})]})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"f_\\\\xi\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.9805em\",verticalAlign:\"-0.2861em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10764em\"},children:\"f\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1076em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.04601em\"},children:\"\\u03BE\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})})]}),\", projector \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"g\"}),(0,e.jsx)(s.mi,{children:\"\\u03BE\"})]})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"g_\\\\xi\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.7167em\",verticalAlign:\"-0.2861em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"g\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.04601em\"},children:\"\\u03BE\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})})]})]}),`\n`,(0,e.jsxs)(s.li,{children:[\"Parameters \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsx)(s.mi,{children:\"\\u03BE\"})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"\\\\xi\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04601em\"},children:\"\\u03BE\"})]})})]}),\" update via EMA: \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"\\u03BE\"}),(0,e.jsx)(s.mo,{children:\"\\u2190\"}),(0,e.jsx)(s.mi,{children:\"m\"}),(0,e.jsx)(s.mi,{children:\"\\u03BE\"}),(0,e.jsx)(s.mo,{children:\"+\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mn,{children:\"1\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mi,{children:\"m\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"\\\\xi \\\\leftarrow m\\\\xi + (1-m)\\\\theta\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04601em\"},children:\"\\u03BE\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"\\u2190\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"m\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04601em\"},children:\"\\u03BE\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"+\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord\",children:\"1\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"m\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})]})]})]})]}),`\n`]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Loss\"}),\":\"]}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"L\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2225\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"q\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"g\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"f\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"g\"}),(0,e.jsx)(s.mi,{children:\"\\u03BE\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"f\"}),(0,e.jsx)(s.mi,{children:\"\\u03BE\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsxs)(s.msup,{children:[(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2225\"}),(0,e.jsx)(s.mn,{children:\"2\"})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"L = \\\\|q_\\\\theta(g_\\\\theta(f_\\\\theta(x_1))) - g_\\\\xi(f_\\\\xi(x_2))\\\\|^2\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"L\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2225\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"g\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10764em\"},children:\"f\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1076em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")))\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.1002em\",verticalAlign:\"-0.2861em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"g\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.04601em\"},children:\"\\u03BE\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10764em\"},children:\"f\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1076em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.04601em\"},children:\"\\u03BE\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\"))\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2225\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsx)(s.span,{className:\"vlist-t\",children:(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})})})})})]})]})]})]})}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Why It Works\"}),\": The slow-moving target stabilizes learning and preserves variance.\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"simsiam-2021\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#simsiam-2021\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"SimSiam (2021)\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.img,{src:\"/projects/ssl/simsiam.png\",alt:\"SimSiam Illustration\"}),`\n`,(0,e.jsxs)(s.em,{children:[\"SimSiam Illustration, by \",(0,e.jsx)(s.a,{href:\"https://doi.org/10.48550/arXiv.2011.10566\",children:\"https://doi.org/10.48550/arXiv.2011.10566\"})]})]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Simplification\"}),\": No momentum encoder!\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Mechanism\"}),\":\"]}),`\n`,(0,e.jsxs)(s.ul,{children:[`\n`,(0,e.jsx)(s.li,{children:\"Two identical branches (same encoder + projector)\"}),`\n`,(0,e.jsx)(s.li,{children:\"One has a predictor on top\"}),`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Crucially\"}),\": stop-gradient on one branch\"]}),`\n`]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Loss\"}),\":\"]}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"L\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mi,{children:\"cos\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"p\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsx)(s.mtext,{children:\"stopgrad\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mi,{children:\"cos\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"p\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsx)(s.mtext,{children:\"stopgrad\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"L = -\\\\cos(p_1, \\\\text{stopgrad}(z_2)) - \\\\cos(p_2, \\\\text{stopgrad}(z_1))\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"L\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"mop\",children:\"cos\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"mord text\",children:(0,e.jsx)(s.span,{className:\"mord\",children:\"stopgrad\"})}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\"))\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mop\",children:\"cos\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"mord text\",children:(0,e.jsx)(s.span,{className:\"mord\",children:\"stopgrad\"})}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\"))\"})]})]})]})}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Key Insight\"}),\": Stop-gradient breaks symmetry and prevents collapse by creating asymmetric gradient flow.\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"dino-2021\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#dino-2021\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"DINO (2021)\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.img,{src:\"/projects/ssl/dino.gif\",alt:\"DINO Illustration\"}),`\n`,(0,e.jsxs)(s.em,{children:[\"DINO Illustration, by \",(0,e.jsx)(s.a,{href:\"https://doi.org/10.48550/arXiv.2104.14294\",children:\"https://doi.org/10.48550/arXiv.2104.14294\"})]})]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Extension\"}),\": Scales BYOL-style training to Vision Transformers.\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Mechanism\"}),\":\"]}),`\n`,(0,e.jsxs)(s.ul,{children:[`\n`,(0,e.jsx)(s.li,{children:\"Teacher-student setup with EMA teacher\"}),`\n`,(0,e.jsx)(s.li,{children:\"Both output soft probability distributions (after softmax)\"}),`\n`,(0,e.jsx)(s.li,{children:\"Loss: cross-entropy between student and teacher outputs\"}),`\n`,(0,e.jsx)(s.li,{children:\"Uses centering and sharpening on teacher outputs\"}),`\n`]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Emergence\"}),\": DINO's embeddings show emergent segmentation\\u2014ViTs attend to semantic regions without labels!\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"ibot-2022\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#ibot-2022\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"iBOT (2022)\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.img,{src:\"/projects/ssl/ibot.png\",alt:\"iBOT Illustration\"}),`\n`,(0,e.jsxs)(s.em,{children:[\"iBOT Illustration, by \",(0,e.jsx)(s.a,{href:\"https://doi.org/10.48550/arXiv.2111.07832\",children:\"https://doi.org/10.48550/arXiv.2111.07832\"})]})]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Hybrid\"}),\": Combines DINO + masked prediction.\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Innovation\"}),\":\"]}),`\n`,(0,e.jsxs)(s.ul,{children:[`\n`,(0,e.jsx)(s.li,{children:\"Mask random patches of ViT input\"}),`\n`,(0,e.jsx)(s.li,{children:\"Predict their teacher-assigned tokens\"}),`\n`,(0,e.jsx)(s.li,{children:\"Unifies predictive and generative principles\"}),`\n`]}),`\n`,(0,e.jsxs)(s.h2,{id:\"redundancy-reduction\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#redundancy-reduction\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Redundancy Reduction\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Core Idea\"}),\": Encourage invariant, diverse, and decorrelated representations.\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"barlow-twins-2021\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#barlow-twins-2021\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Barlow Twins (2021)\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.img,{src:\"/projects/ssl/barlow_twins.png\",alt:\"Barlow Twins Illustration\"}),`\n`,(0,e.jsxs)(s.em,{children:[\"Barlow Twins Illustration, by \",(0,e.jsx)(s.a,{href:\"https://doi.org/10.48550/arXiv.2103.03230\",children:\"https://doi.org/10.48550/arXiv.2103.03230\"})]})]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Mechanism\"}),\":\"]}),`\n`,(0,e.jsxs)(s.p,{children:[\"Compute cross-correlation matrix \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"C\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"i\"}),(0,e.jsx)(s.mi,{children:\"j\"})]})]}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsxs)(s.mfrac,{children:[(0,e.jsx)(s.mn,{children:\"1\"}),(0,e.jsx)(s.mi,{children:\"N\"})]}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mo,{children:\"\\u2211\"}),(0,e.jsx)(s.mi,{children:\"n\"})]}),(0,e.jsxs)(s.mfrac,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msubsup,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mn,{children:\"1\"}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsx)(s.mi,{children:\"i\"})]}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"n\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,e.jsxs)(s.msubsup,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mn,{children:\"2\"}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsx)(s.mi,{children:\"j\"})]}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"n\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]})]})]}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"\\u03C3\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mn,{children:\"1\"}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsx)(s.mi,{children:\"i\"})]})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mi,{children:\"\\u03C3\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mn,{children:\"2\"}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsx)(s.mi,{children:\"j\"})]})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"C_{ij} = \\\\frac{1}{N}\\\\sum_n \\\\frac{z_{1,i}^{(n)} z_{2,j}^{(n)}}{\\\\sigma(z_{1,i})\\\\sigma(z_{2,j})}\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"C\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.9165em\",verticalAlign:\"-0.5423em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mopen nulldelimiter\"}),(0,e.jsx)(s.span,{className:\"mfrac\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.8451em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.655em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.10903em\"},children:\"N\"})})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.23em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.394em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.345em\"},children:(0,e.jsx)(s.span,{})})})]})}),(0,e.jsx)(s.span,{className:\"mclose nulldelimiter\"})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[(0,e.jsx)(s.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.0017em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"n\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2997em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mopen nulldelimiter\"}),(0,e.jsx)(s.span,{className:\"mfrac\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"1.3742em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.655em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.357em\",marginLeft:\"-0.044em\",marginRight:\"0.0714em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"}),(0,e.jsx)(s.span,{className:\"mpunct mtight\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"i\"})]})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C3\"}),(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.357em\",marginLeft:\"-0.044em\",marginRight:\"0.0714em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"}),(0,e.jsx)(s.span,{className:\"mpunct mtight\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})]})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"})]})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.23em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.6328em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"1.0591em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.2134em\",marginLeft:\"-0.044em\",marginRight:\"0.0714em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.5357em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"}),(0,e.jsx)(s.span,{className:\"mpunct mtight\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"i\"})]})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.0591em\",marginRight:\"0.0714em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.5357em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"n\"}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.4612em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"1.0591em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.2134em\",marginLeft:\"-0.044em\",marginRight:\"0.0714em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.5357em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"}),(0,e.jsx)(s.span,{className:\"mpunct mtight\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})]})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.0591em\",marginRight:\"0.0714em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.5357em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"n\"}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.4612em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.5423em\"},children:(0,e.jsx)(s.span,{})})})]})}),(0,e.jsx)(s.span,{className:\"mclose nulldelimiter\"})]})]})]})]})]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Loss\"}),\":\"]}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"L\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"B\"}),(0,e.jsx)(s.mi,{children:\"T\"})]})]}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mo,{children:\"\\u2211\"}),(0,e.jsx)(s.mi,{children:\"i\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mn,{children:\"1\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"C\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"i\"}),(0,e.jsx)(s.mi,{children:\"i\"})]})]}),(0,e.jsxs)(s.msup,{children:[(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{children:\"+\"}),(0,e.jsx)(s.mi,{children:\"\\u03BB\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mo,{children:\"\\u2211\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"i\"}),(0,e.jsx)(s.mo,{mathvariant:\"normal\",children:\"\\u2260\"}),(0,e.jsx)(s.mi,{children:\"j\"})]})]}),(0,e.jsxs)(s.msubsup,{children:[(0,e.jsx)(s.mi,{children:\"C\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"i\"}),(0,e.jsx)(s.mi,{children:\"j\"})]}),(0,e.jsx)(s.mn,{children:\"2\"})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"L_{BT} = \\\\sum_i (1 - C_{ii})^2 + \\\\lambda \\\\sum_{i \\\\neq j} C_{ij}^2\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"L\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.13889em\"},children:\"BT\"})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.0497em\",verticalAlign:\"-0.2997em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[(0,e.jsx)(s.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.162em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2997em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord\",children:\"1\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.0641em\",verticalAlign:\"-0.25em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"C\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"ii\"})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsxs)(s.span,{className:\"mclose\",children:[(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsx)(s.span,{className:\"vlist-t\",children:(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})})})})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"+\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.2499em\",verticalAlign:\"-0.4358em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"\\u03BB\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[(0,e.jsx)(s.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1864em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,e.jsxs)(s.span,{className:\"mrel mtight\",children:[(0,e.jsx)(s.span,{className:\"mrel mtight\",children:(0,e.jsx)(s.span,{className:\"mord vbox mtight\",children:(0,e.jsx)(s.span,{className:\"thinbox mtight\",children:(0,e.jsxs)(s.span,{className:\"rlap mtight\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsx)(s.span,{className:\"inner\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mrel mtight\",children:\"\\uE020\"})})}),(0,e.jsx)(s.span,{className:\"fix\"})]})})})}),(0,e.jsx)(s.span,{className:\"mrel mtight\",children:\"=\"})]}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})]})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.4358em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"C\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.4413em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3948em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})]})]})}),`\n`,(0,e.jsxs)(s.ul,{children:[`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Diagonal terms \\u2192 1\"}),\": High per-dimension agreement (\\u2191 MI)\"]}),`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Off-diagonal \\u2192 0\"}),\": Decorrelate features (prevent collapse)\"]}),`\n`]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Interpretation\"}),': Under Gaussianity, this approximates maximizing per-dimension MI while preventing \"all-info-in-one-dim\" collapse.']}),`\n`,(0,e.jsxs)(s.h3,{id:\"vicreg-2022\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#vicreg-2022\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"VICReg (2022)\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.img,{src:\"/projects/ssl/vicreg.png\",alt:\"VICReg Twins Illustration\"}),`\n`,(0,e.jsxs)(s.em,{children:[\"VICReg Twins Illustration, by \",(0,e.jsx)(s.a,{href:\"https://doi.org/10.48550/arXiv.2105.04906\",children:\"https://doi.org/10.48550/arXiv.2105.04906\"})]})]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Explicit Decomposition\"}),\":\"]}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"L\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"\\u03BB\"}),(0,e.jsx)(s.mtext,{children:\"inv\"})]}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2225\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsxs)(s.msup,{children:[(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2225\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{children:\"+\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"\\u03BB\"}),(0,e.jsx)(s.mtext,{children:\"var\"})]}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"L\"}),(0,e.jsx)(s.mtext,{children:\"var\"})]}),(0,e.jsx)(s.mo,{children:\"+\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"\\u03BB\"}),(0,e.jsx)(s.mtext,{children:\"cov\"})]}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"L\"}),(0,e.jsx)(s.mtext,{children:\"cov\"})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"L = \\\\lambda_{\\\\text{inv}} \\\\|z_1 - z_2\\\\|^2 + \\\\lambda_{\\\\text{var}} L_{\\\\text{var}} + \\\\lambda_{\\\\text{cov}} L_{\\\\text{cov}}\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"L\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"\\u03BB\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3175em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"inv\"})})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2225\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.0641em\",verticalAlign:\"-0.25em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2225\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsx)(s.span,{className:\"vlist-t\",children:(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})})})})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"+\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8444em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"\\u03BB\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"var\"})})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"L\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"var\"})})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"+\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8444em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"\\u03BB\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"cov\"})})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"L\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"cov\"})})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})]})]})}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Three Terms\"}),\":\"]}),`\n`,(0,e.jsxs)(s.ol,{children:[`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Invariance\"}),\": \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"L\"}),(0,e.jsx)(s.mtext,{children:\"inv\"})]}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2225\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsxs)(s.msup,{children:[(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2225\"}),(0,e.jsx)(s.mn,{children:\"2\"})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"L_{\\\\text{inv}} = \\\\|z_1 - z_2\\\\|^2\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"L\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3175em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"inv\"})})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2225\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.0641em\",verticalAlign:\"-0.25em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2225\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsx)(s.span,{className:\"vlist-t\",children:(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})})})})})]})]})]})]}),\" (alignment)\"]}),`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Variance\"}),\": \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"L\"}),(0,e.jsx)(s.mtext,{children:\"var\"})]}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsxs)(s.mfrac,{children:[(0,e.jsx)(s.mn,{children:\"1\"}),(0,e.jsx)(s.mi,{children:\"d\"})]}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mo,{children:\"\\u2211\"}),(0,e.jsx)(s.mi,{children:\"j\"})]}),(0,e.jsx)(s.mi,{children:\"max\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mn,{children:\"0\"}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsx)(s.mi,{children:\"\\u03B3\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mtext,{children:\"Std\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mo,{children:\"\\u22C5\"}),(0,e.jsx)(s.mi,{children:\"j\"})]})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"L_{\\\\text{var}} = \\\\frac{1}{d}\\\\sum_j \\\\max(0, \\\\gamma - \\\\text{Std}(z_{\\\\cdot j}))\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"L\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"var\"})})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.2809em\",verticalAlign:\"-0.4358em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mopen nulldelimiter\"}),(0,e.jsx)(s.span,{className:\"mfrac\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.8451em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.655em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"d\"})})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.23em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.394em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.345em\"},children:(0,e.jsx)(s.span,{})})})]})}),(0,e.jsx)(s.span,{className:\"mclose nulldelimiter\"})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[(0,e.jsx)(s.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.162em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.4358em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"mop\",children:\"max\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord\",children:\"0\"}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05556em\"},children:\"\\u03B3\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),(0,e.jsx)(s.span,{className:\"mord text\",children:(0,e.jsx)(s.span,{className:\"mord\",children:\"Std\"})}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"\\u22C5\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})]})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\"))\"})]})]})]}),\" (keeps \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"H\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"H(z)\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})})]}),\" high)\"]}),`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Covariance\"}),\": \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"L\"}),(0,e.jsx)(s.mtext,{children:\"cov\"})]}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsxs)(s.mfrac,{children:[(0,e.jsx)(s.mn,{children:\"1\"}),(0,e.jsx)(s.mi,{children:\"d\"})]}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mo,{children:\"\\u2211\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"i\"}),(0,e.jsx)(s.mo,{mathvariant:\"normal\",children:\"\\u2260\"}),(0,e.jsx)(s.mi,{children:\"j\"})]})]}),(0,e.jsx)(s.mtext,{children:\"Cov\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsxs)(s.msubsup,{children:[(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"i\"}),(0,e.jsx)(s.mi,{children:\"j\"})]}),(0,e.jsx)(s.mn,{children:\"2\"})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"L_{\\\\text{cov}} = \\\\frac{1}{d}\\\\sum_{i \\\\neq j} \\\\text{Cov}(z)_{ij}^2\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"L\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"cov\"})})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.2809em\",verticalAlign:\"-0.4358em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mopen nulldelimiter\"}),(0,e.jsx)(s.span,{className:\"mfrac\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.8451em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.655em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"d\"})})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.23em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.394em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.345em\"},children:(0,e.jsx)(s.span,{})})})]})}),(0,e.jsx)(s.span,{className:\"mclose nulldelimiter\"})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[(0,e.jsx)(s.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1864em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,e.jsxs)(s.span,{className:\"mrel mtight\",children:[(0,e.jsx)(s.span,{className:\"mrel mtight\",children:(0,e.jsx)(s.span,{className:\"mord vbox mtight\",children:(0,e.jsx)(s.span,{className:\"thinbox mtight\",children:(0,e.jsxs)(s.span,{className:\"rlap mtight\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsx)(s.span,{className:\"inner\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mrel mtight\",children:\"\\uE020\"})})}),(0,e.jsx)(s.span,{className:\"fix\"})]})})})}),(0,e.jsx)(s.span,{className:\"mrel mtight\",children:\"=\"})]}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})]})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.4358em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"mord text\",children:(0,e.jsx)(s.span,{className:\"mord\",children:\"Cov\"})}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsxs)(s.span,{className:\"mclose\",children:[(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.4413em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3948em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})]})]}),\" (redundancy reduction)\"]}),`\n`]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Advantage\"}),\": Easier to reason about mathematically; no momentum, stop-grad, or large batches needed.\"]}),`\n`,(0,e.jsxs)(s.h2,{id:\"clustering-based-ssl\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#clustering-based-ssl\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Clustering-based SSL\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Core Idea\"}),\": Group similar embeddings into prototypes and enforce consistent cluster assignments.\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"swav-2020\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#swav-2020\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"SwAV (2020)\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.img,{src:\"/projects/ssl/swav.gif\",alt:\"SwAV Illustration\"}),`\n`,(0,e.jsxs)(s.em,{children:[\"SwAV Illustration, by \",(0,e.jsx)(s.a,{href:\"https://doi.org/10.48550/arXiv.2006.09882\",children:\"https://doi.org/10.48550/arXiv.2006.09882\"})]})]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Hybrid Approach\"}),\": Merges contrastive and clustering learning.\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Mechanism\"}),\":\"]}),`\n`,(0,e.jsxs)(s.ol,{children:[`\n`,(0,e.jsxs)(s.li,{children:[\"Maintain learnable prototype vectors \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"C\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"{\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"c\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsx)(s.mo,{children:\"\\u2026\"}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"c\"}),(0,e.jsx)(s.mi,{children:\"K\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"}\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"C = \\\\{c_1, \\\\ldots, c_K\\\\}\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"C\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"{\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"c\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"minner\",children:\"\\u2026\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"c\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.07153em\"},children:\"K\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\"}\"})]})]})]})]}),`\n`,(0,e.jsxs)(s.li,{children:[\"For each augmented view \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsxs)(s.msup,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"a\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]})]})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"x^{(a)}\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.888em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsx)(s.span,{className:\"vlist-t\",children:(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.888em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"})]})})]})})})})})]})]})})]}),\", encode to feature \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsxs)(s.msup,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"a\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]})]})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"z^{(a)}\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.888em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsx)(s.span,{className:\"vlist-t\",children:(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.888em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"})]})})]})})})})})]})]})})]}),\" using shared encoder\"]}),`\n`,(0,e.jsxs)(s.li,{children:[\"Compute soft assignments \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsxs)(s.msup,{children:[(0,e.jsx)(s.mi,{children:\"q\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"a\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]})]})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"q^{(a)}\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.0824em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsx)(s.span,{className:\"vlist-t\",children:(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.888em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"})]})})]})})})})})]})]})})]}),\" of features to prototypes using Sinkhorn-Knopp algorithm (enforces balanced cluster usage across batch)\"]}),`\n`,(0,e.jsx)(s.li,{children:\"Predict one view's prototype assignments from another\\u2014swap assignments between augmentations\"}),`\n`]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Loss\"}),`:\nCross-entropy between predicted prototype distribution of one view and balanced assignment of the other:`]}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"L\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mo,{children:\"\\u2211\"}),(0,e.jsx)(s.mi,{children:\"i\"})]}),(0,e.jsxs)(s.msubsup,{children:[(0,e.jsx)(s.mi,{children:\"q\"}),(0,e.jsx)(s.mi,{children:\"i\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mn,{children:\"1\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,e.jsx)(s.mi,{children:\"log\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsxs)(s.msubsup,{children:[(0,e.jsx)(s.mi,{children:\"p\"}),(0,e.jsx)(s.mi,{children:\"i\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mn,{children:\"2\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mo,{children:\"\\u2211\"}),(0,e.jsx)(s.mi,{children:\"i\"})]}),(0,e.jsxs)(s.msubsup,{children:[(0,e.jsx)(s.mi,{children:\"q\"}),(0,e.jsx)(s.mi,{children:\"i\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mn,{children:\"2\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,e.jsx)(s.mi,{children:\"log\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsxs)(s.msubsup,{children:[(0,e.jsx)(s.mi,{children:\"p\"}),(0,e.jsx)(s.mi,{children:\"i\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mn,{children:\"1\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"L = -\\\\sum_i q_i^{(1)} \\\\log p_i^{(2)} - \\\\sum_i q_i^{(2)} \\\\log p_i^{(1)}\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"L\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.3445em\",verticalAlign:\"-0.2997em\"}}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[(0,e.jsx)(s.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.162em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2997em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.4231em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[\"lo\",(0,e.jsx)(s.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.3445em\",verticalAlign:\"-0.2997em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[(0,e.jsx)(s.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.162em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2997em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.4231em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[\"lo\",(0,e.jsx)(s.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"1.0448em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.4231em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.2198em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsxs)(s.span,{className:\"mord mtight\",children:[(0,e.jsx)(s.span,{className:\"mopen mtight\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"}),(0,e.jsx)(s.span,{className:\"mclose mtight\",children:\")\"})]})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2769em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})]})]})}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Benefits\"}),\":\"]}),`\n`,(0,e.jsxs)(s.ul,{children:[`\n`,(0,e.jsx)(s.li,{children:\"No explicit negative pairs needed\"}),`\n`,(0,e.jsx)(s.li,{children:\"Encourages semantic grouping through prototype consistency\"}),`\n`,(0,e.jsx)(s.li,{children:\"Balanced clustering stabilizes training and accelerates convergence\"}),`\n`,(0,e.jsx)(s.li,{children:\"Works well even with small batch sizes\"}),`\n`]}),`\n`,(0,e.jsxs)(s.h2,{id:\"generative-ssl\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#generative-ssl\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Generative SSL\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Core Idea\"}),\": Learn by reconstructing input (or missing parts).\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"masked-autoencoder-mae-2021\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#masked-autoencoder-mae-2021\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Masked Autoencoder (MAE, 2021)\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.img,{src:\"/projects/ssl/mae.png\",alt:\"MAE Twins Illustration\"}),`\n`,(0,e.jsxs)(s.em,{children:[\"MAE Twins Illustration, by \",(0,e.jsx)(s.a,{href:\"https://doi.org/10.48550/arXiv.2111.06377\",children:\"https://doi.org/10.48550/arXiv.2111.06377\"})]})]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Mechanism\"}),\":\"]}),`\n`,(0,e.jsxs)(s.ul,{children:[`\n`,(0,e.jsx)(s.li,{children:\"Mask 75% of ViT patches\"}),`\n`,(0,e.jsx)(s.li,{children:\"Encoder sees only unmasked patches\"}),`\n`,(0,e.jsx)(s.li,{children:\"Lightweight decoder reconstructs masked pixels\"}),`\n`,(0,e.jsx)(s.li,{children:\"Loss: MSE on masked patches\"}),`\n`]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Why Effective\"}),\": Forces encoder to learn global structure without contrastive signals.\"]}),`\n`,(0,e.jsxs)(s.p,{children:[(0,e.jsx)(s.strong,{children:\"Connection to MI\"}),\": If the decoder models \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"p\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"m\"})]}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"v\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"p_\\\\theta(x_m | x_v)\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"m\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2223\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"v\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})})]}),\",\"]}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{mathvariant:\"double-struck\",children:\"E\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"[\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mi,{children:\"log\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"p\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"m\"})]}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"v\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"]\"}),(0,e.jsx)(s.mo,{children:\"\\u2248\"}),(0,e.jsx)(s.mi,{children:\"H\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"m\"})]}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"v\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbb{E}[-\\\\log p_\\\\theta(x_m | x_v)] \\\\approx H(x_m | x_v)\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathbb\",children:\"E\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"[\"}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[\"lo\",(0,e.jsx)(s.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"m\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2223\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"v\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")]\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"\\u2248\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"m\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2223\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"v\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]})}),`\n`,(0,e.jsxs)(s.p,{children:[\"Minimizing reconstruction \\u2248 minimizing \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"H\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"m\"})]}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"v\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"H(x_m | x_v)\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"m\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2223\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"v\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})})]}),\", thus maximizing \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"I\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"v\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\";\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"m\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mi,{children:\"H\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"m\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mi,{children:\"H\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"m\"})]}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"v\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"I(x_v; x_m) = H(x_m) - H(x_m | x_v)\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"I\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"v\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\";\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"m\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"m\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"m\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2223\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"v\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]}),\".\"]}),`\n`,(0,e.jsxs)(s.h2,{id:\"mathematical-foundations\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#mathematical-foundations\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Mathematical Foundations\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"unified-framework\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#unified-framework\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Unified Framework\"]}),`\n`,(0,e.jsx)(s.p,{children:\"All SSL methods can be viewed as:\"}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"max\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"})]}),(0,e.jsx)(s.mi,{children:\"f\"})]}),(0,e.jsxs)(s.munder,{children:[(0,e.jsxs)(s.munder,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"I\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\";\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.mo,{stretchy:\"true\",children:\"\\u23DF\"})]}),(0,e.jsx)(s.mtext,{children:\"alignment\"})]}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mi,{children:\"\\u03B1\"}),(0,e.jsxs)(s.munder,{children:[(0,e.jsxs)(s.munder,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"R\"}),(0,e.jsx)(s.mtext,{children:\"entropy\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.mo,{stretchy:\"true\",children:\"\\u23DF\"})]}),(0,e.jsx)(s.mtext,{children:\"avoid\\xA0collapse\"})]}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mi,{children:\"\\u03B2\"}),(0,e.jsxs)(s.munder,{children:[(0,e.jsxs)(s.munder,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"R\"}),(0,e.jsx)(s.mtext,{children:\"redundancy\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.mo,{stretchy:\"true\",children:\"\\u23DF\"})]}),(0,e.jsx)(s.mtext,{children:\"spread\\xA0info\"})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"\\\\max_f \\\\underbrace{I(z_1; z_2)}_{\\\\text{alignment}} - \\\\alpha \\\\underbrace{R_{\\\\text{entropy}}(z)}_{\\\\text{avoid collapse}} - \\\\beta \\\\underbrace{R_{\\\\text{redundancy}}(z)}_{\\\\text{spread info}}\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"2.4702em\",verticalAlign:\"-1.7202em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[(0,e.jsx)(s.span,{className:\"mop\",children:\"max\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.10764em\"},children:\"f\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"mord munder\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.75em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-1.4159em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"alignment\"})})})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"mord munder\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.75em\"},children:[(0,e.jsxs)(s.span,{className:\"svg-align\",style:{top:\"-2.102em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsxs)(s.span,{className:\"stretchy\",style:{height:\"0.548em\",minWidth:\"1.6em\"},children:[(0,e.jsx)(s.span,{className:\"brace-left\",style:{height:\"0.548em\"},children:(0,e.jsx)(s.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"400em\",height:\"0.548em\",viewBox:\"0 0 400000 548\",preserveAspectRatio:\"xMinYMin slice\",children:(0,e.jsx)(s.path,{d:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`})})}),(0,e.jsx)(s.span,{className:\"brace-center\",style:{height:\"0.548em\"},children:(0,e.jsx)(s.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"400em\",height:\"0.548em\",viewBox:\"0 0 400000 548\",preserveAspectRatio:\"xMidYMin slice\",children:(0,e.jsx)(s.path,{d:`M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`})})}),(0,e.jsx)(s.span,{className:\"brace-right\",style:{height:\"0.548em\"},children:(0,e.jsx)(s.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"400em\",height:\"0.548em\",viewBox:\"0 0 400000 548\",preserveAspectRatio:\"xMaxYMin slice\",children:(0,e.jsx)(s.path,{d:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`})})})]})]}),(0,e.jsxs)(s.span,{style:{top:\"-3em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"I\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\";\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.898em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"1.7202em\"},children:(0,e.jsx)(s.span,{})})})]})}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"2.5063em\",verticalAlign:\"-1.7563em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.0037em\"},children:\"\\u03B1\"}),(0,e.jsx)(s.span,{className:\"mord munder\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.75em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-1.3798em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"avoid\\xA0collapse\"})})})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"mord munder\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.75em\"},children:[(0,e.jsxs)(s.span,{className:\"svg-align\",style:{top:\"-2.0659em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsxs)(s.span,{className:\"stretchy\",style:{height:\"0.548em\",minWidth:\"1.6em\"},children:[(0,e.jsx)(s.span,{className:\"brace-left\",style:{height:\"0.548em\"},children:(0,e.jsx)(s.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"400em\",height:\"0.548em\",viewBox:\"0 0 400000 548\",preserveAspectRatio:\"xMinYMin slice\",children:(0,e.jsx)(s.path,{d:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`})})}),(0,e.jsx)(s.span,{className:\"brace-center\",style:{height:\"0.548em\"},children:(0,e.jsx)(s.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"400em\",height:\"0.548em\",viewBox:\"0 0 400000 548\",preserveAspectRatio:\"xMidYMin slice\",children:(0,e.jsx)(s.path,{d:`M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`})})}),(0,e.jsx)(s.span,{className:\"brace-right\",style:{height:\"0.548em\"},children:(0,e.jsx)(s.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"400em\",height:\"0.548em\",viewBox:\"0 0 400000 548\",preserveAspectRatio:\"xMaxYMin slice\",children:(0,e.jsx)(s.path,{d:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`})})})]})]}),(0,e.jsxs)(s.span,{style:{top:\"-3em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"entropy\"})})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.9341em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"1.7563em\"},children:(0,e.jsx)(s.span,{})})})]})}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"2.5063em\",verticalAlign:\"-1.7563em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05278em\"},children:\"\\u03B2\"}),(0,e.jsx)(s.span,{className:\"mord munder\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.75em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-1.3798em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"spread\\xA0info\"})})})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"mord munder\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.75em\"},children:[(0,e.jsxs)(s.span,{className:\"svg-align\",style:{top:\"-2.0659em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsxs)(s.span,{className:\"stretchy\",style:{height:\"0.548em\",minWidth:\"1.6em\"},children:[(0,e.jsx)(s.span,{className:\"brace-left\",style:{height:\"0.548em\"},children:(0,e.jsx)(s.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"400em\",height:\"0.548em\",viewBox:\"0 0 400000 548\",preserveAspectRatio:\"xMinYMin slice\",children:(0,e.jsx)(s.path,{d:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`})})}),(0,e.jsx)(s.span,{className:\"brace-center\",style:{height:\"0.548em\"},children:(0,e.jsx)(s.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"400em\",height:\"0.548em\",viewBox:\"0 0 400000 548\",preserveAspectRatio:\"xMidYMin slice\",children:(0,e.jsx)(s.path,{d:`M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`})})}),(0,e.jsx)(s.span,{className:\"brace-right\",style:{height:\"0.548em\"},children:(0,e.jsx)(s.svg,{xmlns:\"http://www.w3.org/2000/svg\",width:\"400em\",height:\"0.548em\",viewBox:\"0 0 400000 548\",preserveAspectRatio:\"xMaxYMin slice\",children:(0,e.jsx)(s.path,{d:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`})})})]})]}),(0,e.jsxs)(s.span,{style:{top:\"-3em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0077em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"redundancy\"})})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.9341em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"1.7563em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})]})}),`\n`,(0,e.jsxs)(s.h3,{id:\"loss-to-mi-connections\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#loss-to-mi-connections\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Loss-to-MI Connections\"]}),`\n`,(0,e.jsxs)(s.h4,{id:\"infonce--mi-lower-bound\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#infonce--mi-lower-bound\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"InfoNCE \\u2192 MI Lower Bound\"]}),`\n`,(0,e.jsxs)(s.p,{children:[\"With similarity score \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"s\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsxs)(s.mfrac,{children:[(0,e.jsx)(s.mn,{children:\"1\"}),(0,e.jsx)(s.mi,{children:\"\\u03C4\"})]}),(0,e.jsx)(s.mi,{children:\"cos\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"s(z_1, z_2) = \\\\frac{1}{\\\\tau}\\\\cos(z_1, z_2)\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"s\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.1901em\",verticalAlign:\"-0.345em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mopen nulldelimiter\"}),(0,e.jsx)(s.span,{className:\"mfrac\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.8451em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.655em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"})})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.23em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.394em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.345em\"},children:(0,e.jsx)(s.span,{})})})]})}),(0,e.jsx)(s.span,{className:\"mclose nulldelimiter\"})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"mop\",children:\"cos\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]}),\":\"]}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"I\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\";\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"\\u2265\"}),(0,e.jsx)(s.mi,{children:\"log\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsx)(s.mi,{children:\"N\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"L\"}),(0,e.jsx)(s.mtext,{children:\"InfoNCE\"})]})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"I(z_1; z_2) \\\\geq \\\\log N - L_{\\\\text{InfoNCE}}\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"I\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\";\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"\\u2265\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[\"lo\",(0,e.jsx)(s.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.10903em\"},children:\"N\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"L\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord text mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"InfoNCE\"})})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]})]})]})]})}),`\n`,(0,e.jsxs)(s.p,{children:[\"The numerator estimates joint \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"p\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"p(z_1, z_2)\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})})]}),\"; negatives approximate marginals \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"p\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mi,{children:\"p\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"p(z_1)p(z_2)\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})})]}),\".\"]}),`\n`,(0,e.jsxs)(s.h4,{id:\"cosinemse--mi-gaussian-assumption\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#cosinemse--mi-gaussian-assumption\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Cosine/MSE \\u2192 MI (Gaussian Assumption)\"]}),`\n`,(0,e.jsx)(s.p,{children:\"For whitened, approximately Gaussian representations:\"}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"cos\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mn,{children:\"1\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.mfrac,{children:[(0,e.jsx)(s.mn,{children:\"1\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2225\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsxs)(s.msup,{children:[(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2225\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mtext,{children:\"\\xA0(first-order\\xA0on\\xA0unit\\xA0sphere)\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"\\\\cos(z_1, z_2) = 1 - \\\\frac{1}{2}\\\\|z_1 - z_2\\\\|^2 \\\\text{ (first-order on unit sphere)}\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mop\",children:\"cos\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.7278em\",verticalAlign:\"-0.0833em\"}}),(0,e.jsx)(s.span,{className:\"mord\",children:\"1\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.1901em\",verticalAlign:\"-0.345em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mopen nulldelimiter\"}),(0,e.jsx)(s.span,{className:\"mfrac\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.8451em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.655em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.23em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.394em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.345em\"},children:(0,e.jsx)(s.span,{})})})]})}),(0,e.jsx)(s.span,{className:\"mclose nulldelimiter\"})]}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2225\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.0641em\",verticalAlign:\"-0.25em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2225\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsx)(s.span,{className:\"vlist-t\",children:(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.8141em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})})})})})]}),(0,e.jsx)(s.span,{className:\"mord text\",children:(0,e.jsx)(s.span,{className:\"mord\",children:\"\\xA0(first-order\\xA0on\\xA0unit\\xA0sphere)\"})})]})]})]})}),`\n`,(0,e.jsxs)(s.p,{children:[\"If \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\",\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"(z_1, z_2)\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})})]}),\" are jointly Gaussian with correlation \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u03A3\"})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"\\\\Sigma\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u03A3\"})]})})]}),\":\"]}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"I\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\";\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.mfrac,{children:[(0,e.jsx)(s.mn,{children:\"1\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mi,{children:\"log\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsx)(s.mi,{children:\"det\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsx)(s.mi,{children:\"I\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u03A3\"}),(0,e.jsx)(s.mn,{children:\"12\"})]}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u03A3\"}),(0,e.jsx)(s.mn,{children:\"21\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"I(z_1; z_2) = -\\\\frac{1}{2}\\\\log\\\\det(I - \\\\Sigma_{12}\\\\Sigma_{21})\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"I\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\";\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1.1901em\",verticalAlign:\"-0.345em\"}}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2212\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mopen nulldelimiter\"}),(0,e.jsx)(s.span,{className:\"mfrac\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsxs)(s.span,{className:\"vlist\",style:{height:\"0.8451em\"},children:[(0,e.jsxs)(s.span,{style:{top:\"-2.655em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.23em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,e.jsxs)(s.span,{style:{top:\"-3.394em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})})]})]}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.345em\"},children:(0,e.jsx)(s.span,{})})})]})}),(0,e.jsx)(s.span,{className:\"mclose nulldelimiter\"})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[\"lo\",(0,e.jsx)(s.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsx)(s.span,{className:\"mop\",children:\"det\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"I\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u03A3\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"12\"})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u03A3\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"21\"})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]})}),`\n`,(0,e.jsxs)(s.p,{children:[\"Increasing correlation (reducing \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2225\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2225\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"\\\\|z_1 - z_2\\\\|\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2225\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2225\"})]})]})]}),\") monotonically increases MI.\"]}),`\n`,(0,e.jsxs)(s.h4,{id:\"reconstruction--conditional-entropy\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#reconstruction--conditional-entropy\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Reconstruction \\u2192 Conditional Entropy\"]}),`\n`,(0,e.jsx)(s.p,{children:(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{mathvariant:\"double-struck\",children:\"E\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"[\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mi,{children:\"log\"}),(0,e.jsx)(s.mo,{children:\"\\u2061\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"p\"}),(0,e.jsx)(s.mi,{children:\"\\u03B8\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"m\"})]}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"v\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"]\"}),(0,e.jsx)(s.mo,{children:\"\\u2248\"}),(0,e.jsx)(s.mi,{children:\"H\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"m\"})]}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"v\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbb{E}[-\\\\log p_\\\\theta(x_m | x_v)] \\\\approx H(x_m | x_v)\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathbb\",children:\"E\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"[\"}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mop\",children:[\"lo\",(0,e.jsx)(s.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.02778em\"},children:\"\\u03B8\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"m\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2223\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"v\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")]\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"\\u2248\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"m\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2223\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"v\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]})}),`\n`,(0,e.jsxs)(s.p,{children:[\"Since \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"I\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"v\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\";\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"m\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"=\"}),(0,e.jsx)(s.mi,{children:\"H\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"m\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"}),(0,e.jsx)(s.mo,{children:\"\\u2212\"}),(0,e.jsx)(s.mi,{children:\"H\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"m\"})]}),(0,e.jsx)(s.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"x\"}),(0,e.jsx)(s.mi,{children:\"v\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"I(x_v; x_m) = H(x_m) - H(x_m | x_v)\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"I\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"v\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\";\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"m\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"=\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"m\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,e.jsx)(s.span,{className:\"mbin\",children:\"\\u2212\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"m\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mord\",children:\"\\u2223\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"x\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"v\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})]})]}),\", reconstruction maximizes MI.\"]}),`\n`,(0,e.jsxs)(s.h4,{id:\"barlow-twins--decorrelated-mi\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#barlow-twins--decorrelated-mi\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Barlow Twins \\u2192 Decorrelated MI\"]}),`\n`,(0,e.jsxs)(s.p,{children:[\"Pushing \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"C\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"i\"}),(0,e.jsx)(s.mi,{children:\"i\"})]})]}),(0,e.jsx)(s.mo,{children:\"\\u2192\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"C_{ii} \\\\to 1\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.8333em\",verticalAlign:\"-0.15em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"C\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",children:\"ii\"})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"\\u2192\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,e.jsx)(s.span,{className:\"mord\",children:\"1\"})]})]})]}),\" (high per-dimension MI) and \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"C\"}),(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"i\"}),(0,e.jsx)(s.mi,{children:\"j\"})]})]}),(0,e.jsx)(s.mo,{children:\"\\u2192\"}),(0,e.jsx)(s.mn,{children:\"0\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"C_{ij} \\\\to 0\"})]})})}),(0,e.jsxs)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"C\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:(0,e.jsx)(s.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"ij\"})})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,e.jsx)(s.span,{className:\"mrel\",children:\"\\u2192\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,e.jsx)(s.span,{className:\"mord\",children:\"0\"})]})]})]}),\" (decorrelation) prevents redundancy while maximizing information.\"]}),`\n`,(0,e.jsxs)(s.h4,{id:\"vicreg--explicit-regularization\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#vicreg--explicit-regularization\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"VICReg \\u2192 Explicit Regularization\"]}),`\n`,(0,e.jsxs)(s.ul,{children:[`\n`,(0,e.jsxs)(s.li,{children:[\"Invariance raises \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"I\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"1\"})]}),(0,e.jsx)(s.mo,{separator:\"true\",children:\";\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"I(z_1; z_2)\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"I\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mpunct\",children:\";\"}),(0,e.jsx)(s.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})})]})]}),`\n`,(0,e.jsxs)(s.li,{children:[\"Variance prevents degenerate low-entropy \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsx)(s.mrow,{children:(0,e.jsx)(s.mi,{children:\"z\"})}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"z\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"})]})})]})]}),`\n`,(0,e.jsx)(s.li,{children:\"Covariance spreads information across dimensions\"}),`\n`]}),`\n`,(0,e.jsx)(s.p,{children:'Under Gaussianity, these terms are direct surrogates for \"maximize MI while preventing collapse and redundancy.\"'}),`\n`,(0,e.jsxs)(s.h3,{id:\"collapse-prevention-mechanisms\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#collapse-prevention-mechanisms\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Collapse Prevention Mechanisms\"]}),`\n`,(0,e.jsxs)(s.table,{children:[(0,e.jsx)(s.thead,{children:(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.th,{children:\"Method\"}),(0,e.jsx)(s.th,{children:\"Mechanism\"})]})}),(0,e.jsxs)(s.tbody,{children:[(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.td,{children:\"SimCLR\"}),(0,e.jsxs)(s.td,{children:[\"Negatives estimate marginal \",(0,e.jsxs)(s.span,{className:\"katex\",children:[(0,e.jsx)(s.span,{className:\"katex-mathml\",children:(0,e.jsx)(s.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(s.semantics,{children:[(0,e.jsxs)(s.mrow,{children:[(0,e.jsx)(s.mi,{children:\"p\"}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\"(\"}),(0,e.jsxs)(s.msub,{children:[(0,e.jsx)(s.mi,{children:\"z\"}),(0,e.jsx)(s.mn,{children:\"2\"})]}),(0,e.jsx)(s.mo,{stretchy:\"false\",children:\")\"})]}),(0,e.jsx)(s.annotation,{encoding:\"application/x-tex\",children:\"p(z_2)\"})]})})}),(0,e.jsx)(s.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(s.span,{className:\"base\",children:[(0,e.jsx)(s.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,e.jsx)(s.span,{className:\"mord mathnormal\",children:\"p\"}),(0,e.jsx)(s.span,{className:\"mopen\",children:\"(\"}),(0,e.jsxs)(s.span,{className:\"mord\",children:[(0,e.jsx)(s.span,{className:\"mord mathnormal\",style:{marginRight:\"0.04398em\"},children:\"z\"}),(0,e.jsx)(s.span,{className:\"msupsub\",children:(0,e.jsxs)(s.span,{className:\"vlist-t vlist-t2\",children:[(0,e.jsxs)(s.span,{className:\"vlist-r\",children:[(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,e.jsxs)(s.span,{style:{top:\"-2.55em\",marginLeft:\"-0.044em\",marginRight:\"0.05em\"},children:[(0,e.jsx)(s.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,e.jsx)(s.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,e.jsx)(s.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,e.jsx)(s.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,e.jsx)(s.span,{className:\"vlist-r\",children:(0,e.jsx)(s.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,e.jsx)(s.span,{})})})]})})]}),(0,e.jsx)(s.span,{className:\"mclose\",children:\")\"})]})})]})]})]}),(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.td,{children:\"BYOL\"}),(0,e.jsx)(s.td,{children:\"EMA teacher provides stable target\"})]}),(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.td,{children:\"SimSiam\"}),(0,e.jsx)(s.td,{children:\"Stop-gradient creates asymmetry\"})]}),(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.td,{children:\"DINO\"}),(0,e.jsx)(s.td,{children:\"Temperature sharpening + centering\"})]}),(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.td,{children:\"Barlow Twins\"}),(0,e.jsx)(s.td,{children:\"Off-diagonal penalty \\u2192 decorrelation\"})]}),(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.td,{children:\"VICReg\"}),(0,e.jsx)(s.td,{children:\"Explicit variance regularization\"})]}),(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.td,{children:\"SwAV\"}),(0,e.jsx)(s.td,{children:\"Entropy balancing of prototypes\"})]}),(0,e.jsxs)(s.tr,{children:[(0,e.jsx)(s.td,{children:\"MAE\"}),(0,e.jsx)(s.td,{children:\"Reconstruction constraint\"})]})]})]}),`\n`,(0,e.jsxs)(s.h2,{id:\"summary\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#summary\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Summary\"]}),`\n`,(0,e.jsxs)(s.h3,{id:\"key-insights\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#key-insights\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Key Insights\"]}),`\n`,(0,e.jsxs)(s.ol,{children:[`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"All methods maximize MI\"}),\" between augmented views while preventing collapse\"]}),`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Negatives are not necessary\"}),\" \\u2014 asymmetry (EMA/stop-grad) or explicit regularization suffices\"]}),`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Mathematical elegance\"}),\" varies: VICReg is most interpretable, InfoNCE has strongest theoretical foundation\"]}),`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Emergence in ViTs\"}),\": DINO/MAE show that SSL enables semantic understanding without labels\"]}),`\n`,(0,e.jsxs)(s.li,{children:[(0,e.jsx)(s.strong,{children:\"Hybrid approaches\"}),\" (iBOT, MSN) combine strengths of multiple paradigms\"]}),`\n`]}),`\n`,(0,e.jsxs)(s.h2,{id:\"references\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#references\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"References\"]}),`\n`,(0,e.jsxs)(s.ol,{children:[`\n`,(0,e.jsx)(s.li,{children:'Chen et al. (2020). \"A Simple Framework for Contrastive Learning of Visual Representations\" (SimCLR)'}),`\n`,(0,e.jsx)(s.li,{children:'Grill et al. (2020). \"Bootstrap Your Own Latent\" (BYOL)'}),`\n`,(0,e.jsx)(s.li,{children:'Chen & He (2021). \"Exploring Simple Siamese Representation Learning\" (SimSiam)'}),`\n`,(0,e.jsx)(s.li,{children:'Zbontar et al. (2021). \"Barlow Twins: Self-Supervised Learning via Redundancy Reduction\"'}),`\n`,(0,e.jsx)(s.li,{children:'Bardes et al. (2022). \"VICReg: Variance-Invariance-Covariance Regularization\"'}),`\n`,(0,e.jsx)(s.li,{children:'Caron et al. (2021). \"Emerging Properties in Self-Supervised Vision Transformers\" (DINO)'}),`\n`,(0,e.jsx)(s.li,{children:'He et al. (2021). \"Masked Autoencoders Are Scalable Vision Learners\" (MAE)'}),`\n`,(0,e.jsx)(s.li,{children:'Zhou et al. (2022). \"iBOT: Image BERT Pre-Training with Online Tokenizer\"'}),`\n`]}),`\n`,(0,e.jsxs)(s.h2,{id:\"conclusion\",children:[(0,e.jsx)(s.a,{className:\"anchor\",href:\"#conclusion\",children:(0,e.jsx)(s.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,e.jsxs)(s.p,{children:[\"Self-supervised learning has matured from requiring large batches of negatives (SimCLR) to elegant formulations based on redundancy reduction (VICReg) and masked prediction (DINO). The key insight is that \",(0,e.jsx)(s.strong,{children:\"meaningful representations emerge when models balance invariance to augmentations with preservation of information diversity\"}),\".\"]}),`\n`,(0,e.jsx)(s.p,{children:\"The field continues to evolve, with recent work focusing on:\"}),`\n`,(0,e.jsxs)(s.ul,{children:[`\n`,(0,e.jsx)(s.li,{children:\"Scaling to billion-image datasets (DINOv2, SEER)\"}),`\n`,(0,e.jsx)(s.li,{children:\"Multi-modal learning (CLIP, Data2Vec)\"}),`\n`,(0,e.jsx)(s.li,{children:\"Efficient training (faster convergence, lower compute)\"}),`\n`,(0,e.jsx)(s.li,{children:\"Theoretical understanding (why does stop-gradient work?)\"}),`\n`]}),`\n`,(0,e.jsx)(s.p,{children:\"Understanding these fundamentals provides a strong foundation for both using and extending self-supervised learning methods.\"})]})}function d(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,{...a,children:(0,e.jsx)(h,{...a})}):h(a)}return x(R);})();\n;return Component;"
    },
    "_id": "projects/self-supervised-learning.mdx",
    "_raw": {
      "sourceFilePath": "projects/self-supervised-learning.mdx",
      "sourceFileName": "self-supervised-learning.mdx",
      "sourceFileDir": "projects",
      "contentType": "mdx",
      "flattenedPath": "projects/self-supervised-learning"
    },
    "type": "Project",
    "url": "/projects/self-supervised-learning",
    "slug": "self-supervised-learning"
  }
]