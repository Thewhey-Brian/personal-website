{
  "cacheItemsMap": {
    "publications/CSTWAS.mdx": {
      "document": {
        "title": "Subset-based method for cross-tissue transcriptome-wide association studies improves power and interpretability",
        "abstract": "Integrating results from genome-wide association studies (GWASs) and studies of molecular phenotypes such as gene expressions can improve our understanding of the biological functions of trait-associated variants and can help prioritize candidate genes for downstream analysis. Using reference expression quantitative trait locus (eQTL) studies, several methods have been proposed to identify gene-trait associations, primarily based on gene expression imputation. To increase the statistical power by leveraging substantial eQTL sharing across tissues, meta-analysis methods aggregating such gene-based test results across multiple tissues or contexts have been developed as well. However, most existing meta-analysis methods have limited power to identify associations when the gene has weaker associations in only a few tissues and cannot identify the subset of tissues in which the gene is “activated.” For this, we developed a cross-tissue subset-based transcriptome-wide association study (CSTWAS) meta-analysis method that improves power under such scenarios and can extract the set of potentially associated tissues. To improve applicability, CSTWAS uses only GWAS summary statistics and pre-computed correlation matrices to identify a subset of tissues that have the maximal evidence of gene-trait association. Through numerical simulations, we found that CSTWAS can maintain a well-calibrated type-I error rate, improves power especially when there is a small number of associated tissues for a gene-trait association, and identifies an accurate associated tissue set. By analyzing GWAS summary statistics of three complex traits and diseases, we demonstrate that CSTWAS could identify biological meaningful signals while providing an interpretation of disease etiology by extracting a set of potentially associated tissues.",
        "year": 2024,
        "venue": "Human Genetics and Genomics Advances",
        "doi": "https://doi.org/10.1016/j.xhgg.2024.100283",
        "pdfUrl": "https://www.cell.com/action/showPdf?pii=S2666-2477(24)00022-8",
        "slidesUrl": "/slides/sample-publication.pdf",
        "videoUrl": "https://youtu.be/wSmjzx9Q3fY",
        "tags": [
          "TWAS",
          "Meta-analysis"
        ],
        "featured": false,
        "body": {
          "raw": "\n# Sample Research Publication\n\nThis is the main content of the publication. You can include detailed explanations, methodology, results, and conclusions here.\n\n## Abstract\n\nIntegrating results from genome-wide association studies (GWASs) and studies of molecular phenotypes such as gene expressions can improve our understanding of the biological functions of trait-associated variants and can help prioritize candidate genes for downstream analysis.\n\n## Methodology\n\nDescribe your research methodology here...\n\n## Results\n\nPresent your findings and results...\n\n## Conclusion\n\nSummarize the key takeaways and future work...",
          "code": "var Component=(()=>{var u=Object.create;var n=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var y=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),b=(a,e)=>{for(var t in e)n(a,t,{get:e[t],enumerable:!0})},r=(a,e,t,o)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let i of p(e))!g.call(a,i)&&i!==t&&n(a,i,{get:()=>e[i],enumerable:!(o=m(e,i))||o.enumerable});return a};var w=(a,e,t)=>(t=a!=null?u(f(a)):{},r(e||!a||!a.__esModule?n(t,\"default\",{value:a,enumerable:!0}):t,a)),v=a=>r(n({},\"__esModule\",{value:!0}),a);var l=y((T,c)=>{c.exports=_jsx_runtime});var S={};b(S,{default:()=>h,frontmatter:()=>x});var s=w(l()),x={title:\"Subset-based method for cross-tissue transcriptome-wide association studies improves power and interpretability\",abstract:\"Integrating results from genome-wide association studies (GWASs) and studies of molecular phenotypes such as gene expressions can improve our understanding of the biological functions of trait-associated variants and can help prioritize candidate genes for downstream analysis. Using reference expression quantitative trait locus (eQTL) studies, several methods have been proposed to identify gene-trait associations, primarily based on gene expression imputation. To increase the statistical power by leveraging substantial eQTL sharing across tissues, meta-analysis methods aggregating such gene-based test results across multiple tissues or contexts have been developed as well. However, most existing meta-analysis methods have limited power to identify associations when the gene has weaker associations in only a few tissues and cannot identify the subset of tissues in which the gene is \\u201Cactivated.\\u201D For this, we developed a cross-tissue subset-based transcriptome-wide association study (CSTWAS) meta-analysis method that improves power under such scenarios and can extract the set of potentially associated tissues. To improve applicability, CSTWAS uses only GWAS summary statistics and pre-computed correlation matrices to identify a subset of tissues that have the maximal evidence of gene-trait association. Through numerical simulations, we found that CSTWAS can maintain a well-calibrated type-I error rate, improves power especially when there is a small number of associated tissues for a gene-trait association, and identifies an accurate associated tissue set. By analyzing GWAS summary statistics of three complex traits and diseases, we demonstrate that CSTWAS could identify biological meaningful signals while providing an interpretation of disease etiology by extracting a set of potentially associated tissues.\",year:2024,venue:\"Human Genetics and Genomics Advances\",doi:\"https://doi.org/10.1016/j.xhgg.2024.100283\",pdfUrl:\"https://www.cell.com/action/showPdf?pii=S2666-2477(24)00022-8\",videoUrl:\"https://youtu.be/wSmjzx9Q3fY\",slidesUrl:\"/slides/sample-publication.pdf\",tags:[\"TWAS\",\"Meta-analysis\"],featured:!1};function d(a){let e={a:\"a\",h1:\"h1\",h2:\"h2\",p:\"p\",span:\"span\",...a.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.h1,{id:\"sample-research-publication\",children:[(0,s.jsx)(e.a,{className:\"anchor\",href:\"#sample-research-publication\",children:(0,s.jsx)(e.span,{className:\"icon icon-link\"})}),\"Sample Research Publication\"]}),`\n`,(0,s.jsx)(e.p,{children:\"This is the main content of the publication. You can include detailed explanations, methodology, results, and conclusions here.\"}),`\n`,(0,s.jsxs)(e.h2,{id:\"abstract\",children:[(0,s.jsx)(e.a,{className:\"anchor\",href:\"#abstract\",children:(0,s.jsx)(e.span,{className:\"icon icon-link\"})}),\"Abstract\"]}),`\n`,(0,s.jsx)(e.p,{children:\"Integrating results from genome-wide association studies (GWASs) and studies of molecular phenotypes such as gene expressions can improve our understanding of the biological functions of trait-associated variants and can help prioritize candidate genes for downstream analysis.\"}),`\n`,(0,s.jsxs)(e.h2,{id:\"methodology\",children:[(0,s.jsx)(e.a,{className:\"anchor\",href:\"#methodology\",children:(0,s.jsx)(e.span,{className:\"icon icon-link\"})}),\"Methodology\"]}),`\n`,(0,s.jsx)(e.p,{children:\"Describe your research methodology here...\"}),`\n`,(0,s.jsxs)(e.h2,{id:\"results\",children:[(0,s.jsx)(e.a,{className:\"anchor\",href:\"#results\",children:(0,s.jsx)(e.span,{className:\"icon icon-link\"})}),\"Results\"]}),`\n`,(0,s.jsx)(e.p,{children:\"Present your findings and results...\"}),`\n`,(0,s.jsxs)(e.h2,{id:\"conclusion\",children:[(0,s.jsx)(e.a,{className:\"anchor\",href:\"#conclusion\",children:(0,s.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,s.jsx)(e.p,{children:\"Summarize the key takeaways and future work...\"})]})}function h(a={}){let{wrapper:e}=a.components||{};return e?(0,s.jsx)(e,{...a,children:(0,s.jsx)(d,{...a})}):d(a)}return v(S);})();\n;return Component;"
        },
        "_id": "publications/CSTWAS.mdx",
        "_raw": {
          "sourceFilePath": "publications/CSTWAS.mdx",
          "sourceFileName": "CSTWAS.mdx",
          "sourceFileDir": "publications",
          "contentType": "mdx",
          "flattenedPath": "publications/CSTWAS"
        },
        "type": "Publication",
        "url": "/publications/CSTWAS",
        "slug": "CSTWAS"
      },
      "documentHash": "1756432441235",
      "hasWarnings": false,
      "documentTypeName": "Publication"
    },
    "publications/CXCL1.mdx": {
      "document": {
        "title": "Cell-Autonomous Cxcl1 Sustains Tolerogenic Circuitries and Stromal Inflammation via Neutrophil-Derived TNF in Pancreatic Cancer",
        "abstract": "TWe have shown that KRAS–TP53 genomic coalteration is associated with immune-excluded microenvironments, chemoresistance, and poor survival in pancreatic ductal adenocarcinoma (PDAC) patients. By treating KRAS–TP53 cooperativity as a model for high-risk biology, we now identify cell-autonomous Cxcl1 as a key mediator of spatial T-cell restriction via interactions with CXCR2 neutrophilic myeloid-derived suppressor cells in human PDAC using imaging mass cytometry. Silencing of cell-intrinsic Cxcl1 in LSL-Kras;Trp53;Pdx-1(KPC) cells reprograms the trafficking and functional dynamics of neutrophils to overcome T-cell exclusion and controls tumor growth in a T cell–dependent manner. Mechanistically, neutrophil-derived TNF is a central regulator of this immunologic rewiring, instigating feed-forward Cxcl1 overproduction from tumor cells and cancer-associated fibroblasts (CAF), T-cell dysfunction, and inflammatory CAF polarization via transmembrane TNF–TNFR2 interactions. TNFR2 inhibition disrupts this circuitry and improves sensitivity to chemotherapy in vivo. Our results uncover cancer cell–neutrophil cross-talk in which context-dependent TNF signaling amplifies stromal inflammation and immune tolerance to promote therapeutic resistance in PDAC.",
        "year": 2023,
        "venue": "Cancer Discovery",
        "doi": "https://doi.org/10.1158/2159-8290.CD-22-1046",
        "pdfUrl": "https://pmc.ncbi.nlm.nih.gov/articles/PMC10259764/pdf/nihms-1880552.pdf",
        "slidesUrl": "/slides/sample-publication.pdf",
        "videoUrl": "https://youtu.be/2YWfNd-Kf38",
        "tags": [
          "Cancer",
          "RNA-seq",
          "ATAC-seq"
        ],
        "featured": false,
        "body": {
          "raw": "\n# Sample Research Publication\n\nThis is the main content of the publication. You can include detailed explanations, methodology, results, and conclusions here.\n\n## Abstract\n\nThis is a placeholder for the abstract content.\n\n## Methodology\n\nDescribe your research methodology here...\n\n## Results\n\nPresent your findings and results...\n\n## Conclusion\n\nSummarize the key takeaways and future work...",
          "code": "var Component=(()=>{var m=Object.create;var t=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var y=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),C=(i,e)=>{for(var a in e)t(i,a,{get:e[a],enumerable:!0})},s=(i,e,a,r)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let o of p(e))!g.call(i,o)&&o!==a&&t(i,o,{get:()=>e[o],enumerable:!(r=u(e,o))||r.enumerable});return i};var v=(i,e,a)=>(a=i!=null?m(f(i)):{},s(e||!i||!i.__esModule?t(a,\"default\",{value:i,enumerable:!0}):a,i)),N=i=>s(t({},\"__esModule\",{value:!0}),i);var l=y((k,c)=>{c.exports=_jsx_runtime});var x={};C(x,{default:()=>d,frontmatter:()=>b});var n=v(l()),b={title:\"Cell-Autonomous Cxcl1 Sustains Tolerogenic Circuitries and Stromal Inflammation via Neutrophil-Derived TNF in Pancreatic Cancer\",abstract:\"TWe have shown that KRAS\\u2013TP53 genomic coalteration is associated with immune-excluded microenvironments, chemoresistance, and poor survival in pancreatic ductal adenocarcinoma (PDAC) patients. By treating KRAS\\u2013TP53 cooperativity as a model for high-risk biology, we now identify cell-autonomous Cxcl1 as a key mediator of spatial T-cell restriction via interactions with CXCR2 neutrophilic myeloid-derived suppressor cells in human PDAC using imaging mass cytometry. Silencing of cell-intrinsic Cxcl1 in LSL-Kras;Trp53;Pdx-1(KPC) cells reprograms the trafficking and functional dynamics of neutrophils to overcome T-cell exclusion and controls tumor growth in a T cell\\u2013dependent manner. Mechanistically, neutrophil-derived TNF is a central regulator of this immunologic rewiring, instigating feed-forward Cxcl1 overproduction from tumor cells and cancer-associated fibroblasts (CAF), T-cell dysfunction, and inflammatory CAF polarization via transmembrane TNF\\u2013TNFR2 interactions. TNFR2 inhibition disrupts this circuitry and improves sensitivity to chemotherapy in vivo. Our results uncover cancer cell\\u2013neutrophil cross-talk in which context-dependent TNF signaling amplifies stromal inflammation and immune tolerance to promote therapeutic resistance in PDAC.\",year:2023,venue:\"Cancer Discovery\",doi:\"https://doi.org/10.1158/2159-8290.CD-22-1046\",pdfUrl:\"https://pmc.ncbi.nlm.nih.gov/articles/PMC10259764/pdf/nihms-1880552.pdf\",videoUrl:\"https://youtu.be/2YWfNd-Kf38\",slidesUrl:\"/slides/sample-publication.pdf\",tags:[\"Cancer\",\"RNA-seq\",\"ATAC-seq\"],featured:!1};function h(i){let e={a:\"a\",h1:\"h1\",h2:\"h2\",p:\"p\",span:\"span\",...i.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"sample-research-publication\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#sample-research-publication\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Sample Research Publication\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This is the main content of the publication. You can include detailed explanations, methodology, results, and conclusions here.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"abstract\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#abstract\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Abstract\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This is a placeholder for the abstract content.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"methodology\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#methodology\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Methodology\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Describe your research methodology here...\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"results\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#results\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Results\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Present your findings and results...\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"conclusion\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#conclusion\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Summarize the key takeaways and future work...\"})]})}function d(i={}){let{wrapper:e}=i.components||{};return e?(0,n.jsx)(e,{...i,children:(0,n.jsx)(h,{...i})}):h(i)}return N(x);})();\n;return Component;"
        },
        "_id": "publications/CXCL1.mdx",
        "_raw": {
          "sourceFilePath": "publications/CXCL1.mdx",
          "sourceFileName": "CXCL1.mdx",
          "sourceFileDir": "publications",
          "contentType": "mdx",
          "flattenedPath": "publications/CXCL1"
        },
        "type": "Publication",
        "url": "/publications/CXCL1",
        "slug": "CXCL1"
      },
      "documentHash": "1756432441235",
      "hasWarnings": false,
      "documentTypeName": "Publication"
    },
    "publications/Cell_Cycle.mdx": {
      "document": {
        "title": "From G1 to M: a comparative study of methods for identifying cell cycle phases",
        "abstract": "Accurate identification of cell cycle phases in single-cell RNA-sequencing (scRNA-seq) data is crucial for biomedical research. Many methods have been developed to tackle this challenge, employing diverse approaches to predict cell cycle phases. In this review article, we delve into the standard processes in identifying cell cycle phases within scRNA-seq data and present several representative methods for comparison. To rigorously assess the accuracy of these methods, we propose an error function and employ multiple benchmarking datasets encompassing human and mouse data. Our evaluation results reveal a key finding: the fit between the reference data and the dataset being analyzed profoundly impacts the effectiveness of cell cycle phase identification methods. Therefore, researchers must carefully consider the compatibility between the reference data and their dataset to achieve optimal results. Furthermore, we explore the potential benefits of incorporating benchmarking data with multiple known cell cycle phases into the analysis. Merging such data with the target dataset shows promise in enhancing prediction accuracy. By shedding light on the accuracy and performance of cell cycle phase prediction methods across diverse datasets, this review aims to motivate and guide future methodological advancements. Our findings offer valuable insights for researchers seeking to improve their understanding of cellular dynamics through scRNA-seq analysis, ultimately fostering the development of more robust and widely applicable cell cycle identification methods.",
        "year": 2024,
        "venue": "Briefings in Bioinformatics",
        "doi": "https://doi.org/10.1093/bib/bbad517",
        "pdfUrl": "https://academic.oup.com/bib/article/25/2/bbad517/7584788",
        "slidesUrl": "/slides/sample-publication.pdf",
        "videoUrl": "https://youtu.be/mwVI5TFUEwY",
        "tags": [
          "RNA-seq",
          "single cell",
          "cell cycle"
        ],
        "featured": true,
        "body": {
          "raw": "\n# Sample Research Publication\n\nThis is the main content of the publication. You can include detailed explanations, methodology, results, and conclusions here.\n\n## Abstract\n\nThis is a placeholder for the abstract content.\n\n## Methodology\n\nDescribe your research methodology here...\n\n## Results\n\nPresent your findings and results...\n\n## Conclusion\n\nSummarize the key takeaways and future work...",
          "code": "var Component=(()=>{var p=Object.create;var i=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty;var g=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),b=(n,e)=>{for(var t in e)i(n,t,{get:e[t],enumerable:!0})},o=(n,e,t,c)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let s of u(e))!y.call(n,s)&&s!==t&&i(n,s,{get:()=>e[s],enumerable:!(c=m(e,s))||c.enumerable});return n};var v=(n,e,t)=>(t=n!=null?p(f(n)):{},o(e||!n||!n.__esModule?i(t,\"default\",{value:n,enumerable:!0}):t,n)),w=n=>o(i({},\"__esModule\",{value:!0}),n);var l=g((A,r)=>{r.exports=_jsx_runtime});var k={};b(k,{default:()=>d,frontmatter:()=>N});var a=v(l()),N={title:\"From G1 to M: a comparative study of methods for identifying cell cycle phases\",abstract:\"Accurate identification of cell cycle phases in single-cell RNA-sequencing (scRNA-seq) data is crucial for biomedical research. Many methods have been developed to tackle this challenge, employing diverse approaches to predict cell cycle phases. In this review article, we delve into the standard processes in identifying cell cycle phases within scRNA-seq data and present several representative methods for comparison. To rigorously assess the accuracy of these methods, we propose an error function and employ multiple benchmarking datasets encompassing human and mouse data. Our evaluation results reveal a key finding: the fit between the reference data and the dataset being analyzed profoundly impacts the effectiveness of cell cycle phase identification methods. Therefore, researchers must carefully consider the compatibility between the reference data and their dataset to achieve optimal results. Furthermore, we explore the potential benefits of incorporating benchmarking data with multiple known cell cycle phases into the analysis. Merging such data with the target dataset shows promise in enhancing prediction accuracy. By shedding light on the accuracy and performance of cell cycle phase prediction methods across diverse datasets, this review aims to motivate and guide future methodological advancements. Our findings offer valuable insights for researchers seeking to improve their understanding of cellular dynamics through scRNA-seq analysis, ultimately fostering the development of more robust and widely applicable cell cycle identification methods.\",year:2024,venue:\"Briefings in Bioinformatics\",doi:\"https://doi.org/10.1093/bib/bbad517\",pdfUrl:\"https://academic.oup.com/bib/article/25/2/bbad517/7584788\",videoUrl:\"https://youtu.be/mwVI5TFUEwY\",slidesUrl:\"/slides/sample-publication.pdf\",tags:[\"RNA-seq\",\"single cell\",\"cell cycle\"],featured:!0};function h(n){let e={a:\"a\",h1:\"h1\",h2:\"h2\",p:\"p\",span:\"span\",...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(e.h1,{id:\"sample-research-publication\",children:[(0,a.jsx)(e.a,{className:\"anchor\",href:\"#sample-research-publication\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"Sample Research Publication\"]}),`\n`,(0,a.jsx)(e.p,{children:\"This is the main content of the publication. You can include detailed explanations, methodology, results, and conclusions here.\"}),`\n`,(0,a.jsxs)(e.h2,{id:\"abstract\",children:[(0,a.jsx)(e.a,{className:\"anchor\",href:\"#abstract\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"Abstract\"]}),`\n`,(0,a.jsx)(e.p,{children:\"This is a placeholder for the abstract content.\"}),`\n`,(0,a.jsxs)(e.h2,{id:\"methodology\",children:[(0,a.jsx)(e.a,{className:\"anchor\",href:\"#methodology\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"Methodology\"]}),`\n`,(0,a.jsx)(e.p,{children:\"Describe your research methodology here...\"}),`\n`,(0,a.jsxs)(e.h2,{id:\"results\",children:[(0,a.jsx)(e.a,{className:\"anchor\",href:\"#results\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"Results\"]}),`\n`,(0,a.jsx)(e.p,{children:\"Present your findings and results...\"}),`\n`,(0,a.jsxs)(e.h2,{id:\"conclusion\",children:[(0,a.jsx)(e.a,{className:\"anchor\",href:\"#conclusion\",children:(0,a.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,a.jsx)(e.p,{children:\"Summarize the key takeaways and future work...\"})]})}function d(n={}){let{wrapper:e}=n.components||{};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(h,{...n})}):h(n)}return w(k);})();\n;return Component;"
        },
        "_id": "publications/Cell_Cycle.mdx",
        "_raw": {
          "sourceFilePath": "publications/Cell_Cycle.mdx",
          "sourceFileName": "Cell_Cycle.mdx",
          "sourceFileDir": "publications",
          "contentType": "mdx",
          "flattenedPath": "publications/Cell_Cycle"
        },
        "type": "Publication",
        "url": "/publications/Cell_Cycle",
        "slug": "Cell_Cycle"
      },
      "documentHash": "1756432441234",
      "hasWarnings": false,
      "documentTypeName": "Publication"
    },
    "publications/ERK.mdx": {
      "document": {
        "title": "ERK hyperactivation serves as a unified mechanism of escape in intrinsic and acquired CDK4/6 inhibitor resistance in acral lentiginous melanoma",
        "abstract": "Patients with metastatic acral lentiginous melanoma (ALM) suffer worse outcomes relative to patients with other forms of cutaneous melanoma (CM), and do not benefit as well to approved melanoma therapies. Identification of cyclin-dependent kinase 4 and 6 (CDK4/6) pathway gene alterations in >60% of ALMs has led to clinical trials of the CDK4/6 inhibitor (CDK4i/6i) palbociclib for ALM; however, median progression free survival with CDK4i/6i treatment was only 2.2 months, suggesting existence of resistance mechanisms. Therapy resistance in ALM remains poorly understood; here we report hyperactivation of MAPK signaling and elevated cyclin D1 expression serve as a mechanism of intrinsic early/adaptive CDK4i/6i resistance. ALM cells that have acquired CDK4i/6i resistance following chronic treatment exposure also exhibit hyperactivation of the MAPK pathway. MEK and/or ERK inhibition increases CDK4i/6i efficacy against therapy naïve and CDK4i/6i-resistant AM cells in xenograft and patient-derived xenograft (PDX) models and promotes a defective DNA repair, cell cycle arrested and apoptotic program. Notably, gene alterations poorly correlate with protein expression of cell cycle proteins in ALM or efficacy of CDK4i/6i, urging additional strategies when stratifying patients for CDK4i/6i trial inclusion. Concurrent targeting of the MAPK pathway and CDK4/6 represents a new approach for patients with metastatic ALM to improve outcomes.",
        "year": 2024,
        "venue": "Oncogene",
        "doi": "https://doi.org/10.1038/s41388-023-02900-6",
        "pdfUrl": "https://www.nature.com/articles/s41388-023-02900-6",
        "slidesUrl": "/slides/sample-publication.pdf",
        "videoUrl": "https://youtu.be/eGLsrNAQSw4",
        "tags": [
          "Cancer",
          "RNA-seq",
          "ATAC-seq"
        ],
        "featured": false,
        "body": {
          "raw": "\n# Sample Research Publication\n\nThis is the main content of the publication. You can include detailed explanations, methodology, results, and conclusions here.\n\n## Abstract\n\nThis is a placeholder for the abstract content.\n\n## Methodology\n\nDescribe your research methodology here...\n\n## Results\n\nPresent your findings and results...\n\n## Conclusion\n\nSummarize the key takeaways and future work...",
          "code": "var Component=(()=>{var p=Object.create;var s=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var y=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),w=(a,e)=>{for(var i in e)s(a,i,{get:e[i],enumerable:!0})},r=(a,e,i,o)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let t of u(e))!g.call(a,t)&&t!==i&&s(a,t,{get:()=>e[t],enumerable:!(o=m(e,t))||o.enumerable});return a};var b=(a,e,i)=>(i=a!=null?p(f(a)):{},r(e||!a||!a.__esModule?s(i,\"default\",{value:a,enumerable:!0}):i,a)),v=a=>r(s({},\"__esModule\",{value:!0}),a);var l=y((x,c)=>{c.exports=_jsx_runtime});var D={};w(D,{default:()=>d,frontmatter:()=>C});var n=b(l()),C={title:\"ERK hyperactivation serves as a unified mechanism of escape in intrinsic and acquired CDK4/6 inhibitor resistance in acral lentiginous melanoma\",abstract:\"Patients with metastatic acral lentiginous melanoma (ALM) suffer worse outcomes relative to patients with other forms of cutaneous melanoma (CM), and do not benefit as well to approved melanoma therapies. Identification of cyclin-dependent kinase 4 and 6 (CDK4/6) pathway gene alterations in >60% of ALMs has led to clinical trials of the CDK4/6 inhibitor (CDK4i/6i) palbociclib for ALM; however, median progression free survival with CDK4i/6i treatment was only 2.2 months, suggesting existence of resistance mechanisms. Therapy resistance in ALM remains poorly understood; here we report hyperactivation of MAPK signaling and elevated cyclin D1 expression serve as a mechanism of intrinsic early/adaptive CDK4i/6i resistance. ALM cells that have acquired CDK4i/6i resistance following chronic treatment exposure also exhibit hyperactivation of the MAPK pathway. MEK and/or ERK inhibition increases CDK4i/6i efficacy against therapy na\\xEFve and CDK4i/6i-resistant AM cells in xenograft and patient-derived xenograft (PDX) models and promotes a defective DNA repair, cell cycle arrested and apoptotic program. Notably, gene alterations poorly correlate with protein expression of cell cycle proteins in ALM or efficacy of CDK4i/6i, urging additional strategies when stratifying patients for CDK4i/6i trial inclusion. Concurrent targeting of the MAPK pathway and CDK4/6 represents a new approach for patients with metastatic ALM to improve outcomes.\",year:2024,venue:\"Oncogene\",doi:\"https://doi.org/10.1038/s41388-023-02900-6\",pdfUrl:\"https://www.nature.com/articles/s41388-023-02900-6\",videoUrl:\"https://youtu.be/eGLsrNAQSw4\",slidesUrl:\"/slides/sample-publication.pdf\",tags:[\"Cancer\",\"RNA-seq\",\"ATAC-seq\"],featured:!1};function h(a){let e={a:\"a\",h1:\"h1\",h2:\"h2\",p:\"p\",span:\"span\",...a.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"sample-research-publication\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#sample-research-publication\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Sample Research Publication\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This is the main content of the publication. You can include detailed explanations, methodology, results, and conclusions here.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"abstract\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#abstract\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Abstract\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This is a placeholder for the abstract content.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"methodology\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#methodology\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Methodology\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Describe your research methodology here...\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"results\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#results\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Results\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Present your findings and results...\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"conclusion\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#conclusion\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Summarize the key takeaways and future work...\"})]})}function d(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,{...a,children:(0,n.jsx)(h,{...a})}):h(a)}return v(D);})();\n;return Component;"
        },
        "_id": "publications/ERK.mdx",
        "_raw": {
          "sourceFilePath": "publications/ERK.mdx",
          "sourceFileName": "ERK.mdx",
          "sourceFileDir": "publications",
          "contentType": "mdx",
          "flattenedPath": "publications/ERK"
        },
        "type": "Publication",
        "url": "/publications/ERK",
        "slug": "ERK"
      },
      "documentHash": "1756432441235",
      "hasWarnings": false,
      "documentTypeName": "Publication"
    },
    "publications/KMT2D.mdx": {
      "document": {
        "title": "Methylation of the chromatin modifier KMT2D by SMYD2 contributes to therapeutic response in hormone-dependent breast cancer",
        "abstract": "Activating mutations in PIK3CA are frequently found in estrogen-receptor-positive (ER+) breast cancer, and the combination of the phosphatidylinositol 3-kinase (PI3K) inhibitor alpelisib with anti-ER inhibitors is approved for therapy. We have previously demonstrated that the PI3K pathway regulates ER activity through phosphorylation of the chromatin modifier KMT2D. Here, we discovered a methylation site on KMT2D, at K1330 directly adjacent to S1331, catalyzed by the lysine methyltransferase SMYD2. SMYD2 loss attenuates alpelisib-induced KMT2D chromatin binding and alpelisib-mediated changes in gene expression, including ER-dependent transcription. Knockdown or pharmacological inhibition of SMYD2 sensitizes breast cancer cells, patient-derived organoids, and tumors to PI3K/AKT inhibition and endocrine therapy in part through KMT2D K1330 methylation. Together, our findings uncover a regulatory crosstalk between post-translational modifications that fine-tunes KMT2D function at the chromatin. This provides a rationale for the use of SMYD2 inhibitors in combination with PI3Kα/AKT inhibitors in the treatment of ER+/PIK3CA mutant breast cancer.",
        "year": 2024,
        "venue": "Cell Reports",
        "doi": "https://doi.org/10.1016/j.celrep.2024.114174",
        "pdfUrl": "https://www.cell.com/action/showPdf?pii=S2211-1247(24)00502-3",
        "slidesUrl": "/slides/sample-publication.pdf",
        "videoUrl": "https://youtu.be/nQrFzAEBK1c",
        "tags": [
          "Cancer",
          "RNA-seq",
          "ATAC-seq"
        ],
        "featured": false,
        "body": {
          "raw": "\n# Sample Research Publication\n\nThis is the main content of the publication. You can include detailed explanations, methodology, results, and conclusions here.\n\n## Abstract\n\nThis is a placeholder for the abstract content.\n\n## Methodology\n\nDescribe your research methodology here...\n\n## Results\n\nPresent your findings and results...\n\n## Conclusion\n\nSummarize the key takeaways and future work...",
          "code": "var Component=(()=>{var p=Object.create;var o=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty;var y=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),g=(t,e)=>{for(var i in e)o(t,i,{get:e[i],enumerable:!0})},r=(t,e,i,s)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let a of m(e))!b.call(t,a)&&a!==i&&o(t,a,{get:()=>e[a],enumerable:!(s=u(e,a))||s.enumerable});return t};var K=(t,e,i)=>(i=t!=null?p(f(t)):{},r(e||!t||!t.__esModule?o(i,\"default\",{value:t,enumerable:!0}):i,t)),M=t=>r(o({},\"__esModule\",{value:!0}),t);var h=y((v,c)=>{c.exports=_jsx_runtime});var w={};g(w,{default:()=>d,frontmatter:()=>D});var n=K(h()),D={title:\"Methylation of the chromatin modifier KMT2D by SMYD2 contributes to therapeutic response in hormone-dependent breast cancer\",abstract:\"Activating mutations in PIK3CA are frequently found in estrogen-receptor-positive (ER+) breast cancer, and the combination of the phosphatidylinositol 3-kinase (PI3K) inhibitor alpelisib with anti-ER inhibitors is approved for therapy. We have previously demonstrated that the PI3K pathway regulates ER activity through phosphorylation of the chromatin modifier KMT2D. Here, we discovered a methylation site on KMT2D, at K1330 directly adjacent to S1331, catalyzed by the lysine methyltransferase SMYD2. SMYD2 loss attenuates alpelisib-induced KMT2D chromatin binding and alpelisib-mediated changes in gene expression, including ER-dependent transcription. Knockdown or pharmacological inhibition of SMYD2 sensitizes breast cancer cells, patient-derived organoids, and tumors to PI3K/AKT inhibition and endocrine therapy in part through KMT2D K1330 methylation. Together, our findings uncover a regulatory crosstalk between post-translational modifications that fine-tunes KMT2D function at the chromatin. This provides a rationale for the use of SMYD2 inhibitors in combination with PI3K\\u03B1/AKT inhibitors in the treatment of ER+/PIK3CA mutant breast cancer.\",year:2024,venue:\"Cell Reports\",doi:\"https://doi.org/10.1016/j.celrep.2024.114174\",pdfUrl:\"https://www.cell.com/action/showPdf?pii=S2211-1247(24)00502-3\",videoUrl:\"https://youtu.be/nQrFzAEBK1c\",slidesUrl:\"/slides/sample-publication.pdf\",tags:[\"Cancer\",\"RNA-seq\",\"ATAC-seq\"],featured:!1};function l(t){let e={a:\"a\",h1:\"h1\",h2:\"h2\",p:\"p\",span:\"span\",...t.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"sample-research-publication\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#sample-research-publication\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Sample Research Publication\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This is the main content of the publication. You can include detailed explanations, methodology, results, and conclusions here.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"abstract\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#abstract\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Abstract\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This is a placeholder for the abstract content.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"methodology\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#methodology\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Methodology\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Describe your research methodology here...\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"results\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#results\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Results\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Present your findings and results...\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"conclusion\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#conclusion\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Summarize the key takeaways and future work...\"})]})}function d(t={}){let{wrapper:e}=t.components||{};return e?(0,n.jsx)(e,{...t,children:(0,n.jsx)(l,{...t})}):l(t)}return M(w);})();\n;return Component;"
        },
        "_id": "publications/KMT2D.mdx",
        "_raw": {
          "sourceFilePath": "publications/KMT2D.mdx",
          "sourceFileName": "KMT2D.mdx",
          "sourceFileDir": "publications",
          "contentType": "mdx",
          "flattenedPath": "publications/KMT2D"
        },
        "type": "Publication",
        "url": "/publications/KMT2D",
        "slug": "KMT2D"
      },
      "documentHash": "1756432441236",
      "hasWarnings": false,
      "documentTypeName": "Publication"
    },
    "publications/TWAS_RCC.mdx": {
      "document": {
        "title": "Transcriptome- and proteome-wide association studies identify genes associated with renal cell carcinoma",
        "abstract": "We performed a series of integrative analyses including transcriptome-wide association studies (TWASs) and proteome-wide association studies (PWASs) of renal cell carcinoma (RCC) to nominate and prioritize molecular targets for laboratory investigation. On the basis of a genome-wide association study (GWAS) of 29,020 affected individuals and 835,670 control individuals and prediction models trained in transcriptomic reference models, our TWAS across four kidney transcriptomes (GTEx kidney cortex, kidney tubules, TCGA-KIRC [The Cancer Genome Atlas kidney renal clear-cell carcinoma], and TCGA-KIRP [TCGA kidney renal papillary cell carcinoma]) identified 38 gene associations (false-discovery rate <5%) in at least two of four transcriptomic panels and identified 12 genes that were independent of GWAS susceptibility regions. Analyses combining TWAS associations across 48 tissues from GTEx identified associations that were replicable in tumor transcriptomes for 23 additional genes. Analyses by the two major histologic types (clear-cell RCC and papillary RCC) revealed subtype-specific associations, although at least three gene associations were common to both subtypes. PWAS identified 13 associated proteins, all mapping to GWAS-significant loci. TWAS-identified genes were enriched for active enhancer or promoter regions in RCC tumors and hypoxia-inducible factor binding sites in relevant cell lines. Using gene expression correlation, common cancers (breast and prostate) and RCC risk factors (e.g., hypertension and BMI) display genetic contributions shared with RCC. Our work identifies potential molecular targets for RCC susceptibility for downstream functional investigation.",
        "year": 2024,
        "venue": "The American Journal of Human Genetics",
        "doi": "https://doi.org/10.1016/j.ajhg.2024.07.012",
        "pdfUrl": "https://www.cell.com/action/showPdf?pii=S0002-9297(24)00256-8",
        "slidesUrl": "/slides/sample-publication.pdf",
        "videoUrl": "https://youtu.be/BBqrIKg9idU",
        "tags": [
          "Cancer",
          "TWAS",
          "PWAS"
        ],
        "featured": false,
        "body": {
          "raw": "\n# Sample Research Publication\n\nThis is the main content of the publication. You can include detailed explanations, methodology, results, and conclusions here.\n\n## Abstract\n\nThis is a placeholder for the abstract content.\n\n## Methodology\n\nDescribe your research methodology here...\n\n## Results\n\nPresent your findings and results...\n\n## Conclusion\n\nSummarize the key takeaways and future work...",
          "code": "var Component=(()=>{var p=Object.create;var o=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var y=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),b=(i,e)=>{for(var a in e)o(i,a,{get:e[a],enumerable:!0})},r=(i,e,a,t)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let s of u(e))!g.call(i,s)&&s!==a&&o(i,s,{get:()=>e[s],enumerable:!(t=m(e,s))||t.enumerable});return i};var C=(i,e,a)=>(a=i!=null?p(f(i)):{},r(e||!i||!i.__esModule?o(a,\"default\",{value:i,enumerable:!0}):a,i)),w=i=>r(o({},\"__esModule\",{value:!0}),i);var l=y((T,c)=>{c.exports=_jsx_runtime});var k={};b(k,{default:()=>h,frontmatter:()=>A});var n=C(l()),A={title:\"Transcriptome- and proteome-wide association studies identify genes associated with renal cell carcinoma\",abstract:\"We performed a series of integrative analyses including transcriptome-wide association studies (TWASs) and proteome-wide association studies (PWASs) of renal cell carcinoma (RCC) to nominate and prioritize molecular targets for laboratory investigation. On the basis of a genome-wide association study (GWAS) of 29,020 affected individuals and 835,670 control individuals and prediction models trained in transcriptomic reference models, our TWAS across four kidney transcriptomes (GTEx kidney cortex, kidney tubules, TCGA-KIRC [The Cancer Genome Atlas kidney renal clear-cell carcinoma], and TCGA-KIRP [TCGA kidney renal papillary cell carcinoma]) identified 38 gene associations (false-discovery rate <5%) in at least two of four transcriptomic panels and identified 12 genes that were independent of GWAS susceptibility regions. Analyses combining TWAS associations across 48 tissues from GTEx identified associations that were replicable in tumor transcriptomes for 23 additional genes. Analyses by the two major histologic types (clear-cell RCC and papillary RCC) revealed subtype-specific associations, although at least three gene associations were common to both subtypes. PWAS identified 13 associated proteins, all mapping to GWAS-significant loci. TWAS-identified genes were enriched for active enhancer or promoter regions in RCC tumors and hypoxia-inducible factor binding sites in relevant cell lines. Using gene expression correlation, common cancers (breast and prostate) and RCC risk factors (e.g., hypertension and BMI) display genetic contributions shared with RCC. Our work identifies potential molecular targets for RCC susceptibility for downstream functional investigation.\",year:2024,venue:\"The American Journal of Human Genetics\",doi:\"https://doi.org/10.1016/j.ajhg.2024.07.012\",pdfUrl:\"https://www.cell.com/action/showPdf?pii=S0002-9297(24)00256-8\",videoUrl:\"https://youtu.be/BBqrIKg9idU\",slidesUrl:\"/slides/sample-publication.pdf\",tags:[\"Cancer\",\"TWAS\",\"PWAS\"],featured:!1};function d(i){let e={a:\"a\",h1:\"h1\",h2:\"h2\",p:\"p\",span:\"span\",...i.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"sample-research-publication\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#sample-research-publication\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Sample Research Publication\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This is the main content of the publication. You can include detailed explanations, methodology, results, and conclusions here.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"abstract\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#abstract\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Abstract\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This is a placeholder for the abstract content.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"methodology\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#methodology\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Methodology\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Describe your research methodology here...\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"results\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#results\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Results\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Present your findings and results...\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"conclusion\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#conclusion\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Summarize the key takeaways and future work...\"})]})}function h(i={}){let{wrapper:e}=i.components||{};return e?(0,n.jsx)(e,{...i,children:(0,n.jsx)(d,{...i})}):d(i)}return w(k);})();\n;return Component;"
        },
        "_id": "publications/TWAS_RCC.mdx",
        "_raw": {
          "sourceFilePath": "publications/TWAS_RCC.mdx",
          "sourceFileName": "TWAS_RCC.mdx",
          "sourceFileDir": "publications",
          "contentType": "mdx",
          "flattenedPath": "publications/TWAS_RCC"
        },
        "type": "Publication",
        "url": "/publications/TWAS_RCC",
        "slug": "TWAS_RCC"
      },
      "documentHash": "1756432441236",
      "hasWarnings": false,
      "documentTypeName": "Publication"
    },
    "projects/gnn-spatial-transcriptomics.mdx": {
      "document": {
        "title": "Graph Neural Networks for Spatial Transcriptomics",
        "summary": "A comprehensive guide to understanding and applying GNNs to spatial transcriptomics data, from foundational concepts to cutting-edge research implementations",
        "status": "completed",
        "role": "Research & Implementation",
        "stack": [
          "PyTorch",
          "PyTorch Geometric",
          "Python",
          "Graph Neural Networks",
          "Spatial Transcriptomics"
        ],
        "repoUrl": "https://github.com/yourusername/gnn-spatial-transcriptomics",
        "images": [],
        "tags": [
          "deep learning",
          "bioinformatics",
          "graph neural networks",
          "spatial transcriptomics",
          "computational biology"
        ],
        "featured": true,
        "startDate": "2025-08-15T00:00:00.000Z",
        "body": {
          "raw": "\n# Graph Neural Networks for Spatial Transcriptomics\n\nA deep dive into applying Graph Neural Networks (GNNs) to spatial transcriptomics research, bridging deep learning theory with cutting-edge biological applications.\n\n## Table of Contents\n\n1. [Introduction](#introduction)\n2. [From CNNs to GNNs](#from-cnns-to-gnns)\n3. [Core GNN Architectures](#core-gnn-architectures)\n4. [Graph Construction Strategies](#graph-construction-strategies)\n5. [State-of-the-Art Methods in Spatial Transcriptomics](#state-of-the-art-methods)\n6. [Implementation Guide](#implementation-guide)\n7. [Practical Considerations](#practical-considerations)\n\n---\n\n## Introduction\n\nSpatial transcriptomics (ST) captures gene expression while preserving the physical location of cells in tissue. This spatial context creates a natural graph structure where:\n\n- **Nodes** = spots/cells with gene expression vectors\n- **Edges** = spatial proximity or molecular similarity\n- **Task** = identify tissue domains, cell types, or spatial patterns\n\nGraph Neural Networks provide a powerful framework to leverage this structure, enabling message-passing that respects both spatial topology and molecular relationships.\n\n---\n\n## From CNNs to GNNs\n\n### Why CNNs Can't Handle Irregular Grids\n\nConvolutional Neural Networks excel at structured data (images) because:\n\n1. **Local connectivity**: Each pixel has a fixed neighborhood (e.g., 3×3)\n2. **Weight sharing**: The same filter slides across all positions, making parameter efficient\n3. **Translation invariance**: Patterns learned anywhere apply everywhere\n\nThe convolution operation at pixel `(i,j)` is:\n\n```\ny_{i,j} = Σ_{a=-1}^{1} Σ_{b=-1}^{1} w_{a,b} · x_{i+a, j+b}\n```\n\n**The problem for spatial transcriptomics**: Spots are irregularly spaced and often have varying numbers of neighbors. We can't use a fixed 3×3 kernel.\n\n### Message Passing: The Key Insight\n\nGNNs generalize convolution to **arbitrary graph structures** through message passing:\n\n```\nh_i^(l+1) = σ(W^(l) · AGGREGATE{h_j^(l) : j ∈ N(i)})\n```\n\nWhere:\n- `h_i^(l)` = feature vector of node `i` at layer `l`\n- `N(i)` = neighbors of node `i`\n- `W^(l)` = learnable weight matrix\n- `σ` = activation function (ReLU, etc.)\n\nThis is conceptually similar to CNN convolution, but:\n- Neighbors are defined by **edges**, not spatial proximity on a grid\n- Each node can have a **variable number** of neighbors\n- Weights are **shared across all nodes**, just like CNN filters\n\n---\n\n## Core GNN Architectures\n\n### 1. Graph Convolutional Network (GCN)\n\n**Paper**: Kipf & Welling (2017)\n\n**Core Idea**: Normalize neighbor aggregation by degree to prevent scale issues.\n\n#### Mathematical Formulation\n\nGiven:\n- **X** ∈ ℝ^(N × F): node features (N spots, F genes)\n- **A** ∈ ℝ^(N × N): adjacency matrix\n- **D**: degree matrix (diagonal, where D_ii = sum of A_ij over j)\n\nAdd self-loops and normalize:\n\n```\nÃ = A + I  (add self-connections)\nD̃ᵢᵢ = Σⱼ Ãᵢⱼ  (recompute degrees)\n```\n\nThe GCN layer performs symmetric normalization:\n\n```\nH⁽ˡ⁺¹⁾ = σ(D̃⁻¹ᐟ² à D̃⁻¹ᐟ² H⁽ˡ⁾ W⁽ˡ⁾)\n```\n\n**Intuition**: The symmetric normalization `D̃⁻¹ᐟ² Ã D̃⁻¹ᐟ²` creates a normalized adjacency that averages features fairly across neighbors, preventing high-degree nodes from dominating.\n\n#### PyTorch Implementation (Matrix Form)\n\n```python\nimport torch\nimport torch.nn as nn\n\ndef normalize_adj(edge_index, num_nodes):\n    \"\"\"\n    Build symmetric normalized adjacency: D^{-1/2} A D^{-1/2}\n    Returns sparse tensor indices and values.\n    \"\"\"\n    i, j = edge_index\n    # Add self-loops\n    self_loops = torch.arange(num_nodes, device=edge_index.device)\n    i = torch.cat([i, self_loops])\n    j = torch.cat([j, self_loops])\n\n    # Compute degree\n    deg = torch.bincount(j, minlength=num_nodes).float()\n    deg_inv_sqrt = deg.clamp(min=1).pow(-0.5)\n\n    # Symmetric normalization weights\n    vals = deg_inv_sqrt[i] * deg_inv_sqrt[j]\n    return torch.stack([i, j], dim=0), vals\n\nclass GCNLayer(nn.Module):\n    \"\"\"\n    Graph Convolutional Layer with sparse adjacency multiply.\n    \"\"\"\n    def __init__(self, in_channels, out_channels, bias=True):\n        super().__init__()\n        self.lin = nn.Linear(in_channels, out_channels, bias=bias)\n\n    def forward(self, x, edge_index):\n        N = x.size(0)\n        idx, vals = normalize_adj(edge_index, N)\n        A_norm = torch.sparse_coo_tensor(idx, vals, (N, N), device=x.device)\n\n        x = self.lin(x)                    # [N, F_out]\n        x = torch.sparse.mm(A_norm, x)     # Sparse matrix multiply\n        return torch.relu(x)\n\n# Full GCN Model\nclass GCN(nn.Module):\n    def __init__(self, in_channels, hidden_channels, out_channels, num_layers=2):\n        super().__init__()\n        self.layers = nn.ModuleList()\n        self.layers.append(GCNLayer(in_channels, hidden_channels))\n        for _ in range(num_layers - 2):\n            self.layers.append(GCNLayer(hidden_channels, hidden_channels))\n        self.layers.append(GCNLayer(hidden_channels, out_channels))\n\n    def forward(self, x, edge_index):\n        for i, layer in enumerate(self.layers[:-1]):\n            x = layer(x, edge_index)\n            x = torch.relu(x)\n            x = torch.dropout(x, p=0.5, train=self.training)\n        x = self.layers[-1](x, edge_index)\n        return x\n```\n\n**Strengths**:\n- Simple, efficient, mathematically principled\n- Fast on small-to-medium graphs\n- Smooth aggregation good for homogeneous tissue\n\n**Weaknesses**:\n- Fixed (isotropic) weights—all neighbors treated equally\n- Transductive (needs full graph at training)\n- Over-smoothing with many layers\n\n---\n\n### 2. GraphSAGE\n\n**Paper**: Hamilton et al. (2017)\n\n**Core Idea**: Sample neighbors and use robust aggregators (mean, LSTM, max-pool) to scale to large graphs and enable **inductive learning** (generalize to unseen nodes/graphs).\n\n#### Update Rule\n\n```\nh_i^(l+1) = σ(W · CONCAT[h_i^(l), AGG{h_j^(l) : j ∈ N(i)}])\n```\n\nKey differences from GCN:\n1. **Concatenate** self-feature with aggregated neighbors (preserves identity)\n2. **Sample** a fixed number of neighbors (e.g., 10) instead of using all\n3. **Aggregator** choices: mean, max-pool, LSTM\n\n#### PyTorch Implementation\n\n```python\nimport torch\nimport torch.nn as nn\nimport torch.nn.functional as F\n\nclass SAGEConv(nn.Module):\n    \"\"\"\n    GraphSAGE layer with mean aggregation.\n    \"\"\"\n    def __init__(self, in_channels, out_channels, normalize=True):\n        super().__init__()\n        self.lin_self = nn.Linear(in_channels, out_channels)\n        self.lin_neigh = nn.Linear(in_channels, out_channels)\n        self.normalize = normalize\n\n    def forward(self, x, edge_index, num_neighbors_sample=10):\n        N = x.size(0)\n\n        # Sample neighbors (for scalability)\n        src, dst = edge_index\n        # Group by destination\n        neighbors = {}\n        for s, d in zip(src.tolist(), dst.tolist()):\n            neighbors.setdefault(d, []).append(s)\n\n        # Sample and aggregate\n        neigh_features = []\n        for i in range(N):\n            if i in neighbors and len(neighbors[i]) > 0:\n                sampled = torch.tensor(\n                    neighbors[i][:num_neighbors_sample],\n                    device=x.device\n                )\n                neigh_features.append(x[sampled].mean(dim=0))\n            else:\n                neigh_features.append(torch.zeros(x.size(1), device=x.device))\n\n        neigh_agg = torch.stack(neigh_features)  # [N, F]\n\n        # Combine self and neighbor\n        out = self.lin_self(x) + self.lin_neigh(neigh_agg)\n\n        if self.normalize:\n            out = F.normalize(out, p=2, dim=1)\n\n        return out\n\nclass GraphSAGE(nn.Module):\n    def __init__(self, in_channels, hidden_channels, out_channels, num_layers=2):\n        super().__init__()\n        self.layers = nn.ModuleList()\n        self.layers.append(SAGEConv(in_channels, hidden_channels))\n        for _ in range(num_layers - 2):\n            self.layers.append(SAGEConv(hidden_channels, hidden_channels))\n        self.layers.append(SAGEConv(hidden_channels, out_channels))\n\n    def forward(self, x, edge_index):\n        for layer in self.layers[:-1]:\n            x = layer(x, edge_index)\n            x = F.relu(x)\n            x = F.dropout(x, p=0.5, training=self.training)\n        x = self.layers[-1](x, edge_index)\n        return x\n```\n\n**Strengths**:\n- Scales to massive graphs via neighbor sampling\n- Inductive: can generalize to new slides without retraining\n- Multiple aggregator options\n\n**Weaknesses**:\n- Sampling introduces variance\n- More hyperparameters (sample size per layer)\n- Still treats all sampled neighbors equally\n\n---\n\n### 3. Graph Attention Network (GAT)\n\n**Paper**: Veličković et al. (2018)\n\n**Core Idea**: Learn **per-edge attention weights** so the model can focus on important neighbors and ignore noisy ones.\n\n#### Attention Mechanism\n\nFor each edge `(i, j)`:\n\n```\ne_ij = LeakyReLU(a^T [W·h_i || W·h_j])\n```\n\nNormalize with softmax over all neighbors:\n\n```\nα_ij = exp(e_ij) / Σ_{k ∈ N(i)} exp(e_ik)\n```\n\nAggregate with learned weights:\n\n```\nh_i^(l+1) = σ(Σ_{j ∈ N(i)} α_ij · W · h_j^(l))\n```\n\n**Multi-head attention** (like Transformers): Run `K` independent attention heads and concatenate:\n\n```\nh_i^(l+1) = ||_{k=1}^K σ(Σ_{j ∈ N(i)} α_ij^k · W^k · h_j^(l))\n```\n\n#### PyTorch Implementation\n\n```python\nimport torch\nimport torch.nn as nn\nimport torch.nn.functional as F\n\nclass GATLayer(nn.Module):\n    \"\"\"\n    Graph Attention Layer (single head).\n    \"\"\"\n    def __init__(self, in_channels, out_channels, dropout=0.6, alpha=0.2):\n        super().__init__()\n        self.W = nn.Linear(in_channels, out_channels, bias=False)\n        self.a = nn.Parameter(torch.zeros(size=(2 * out_channels, 1)))\n        self.leakyrelu = nn.LeakyReLU(alpha)\n        self.dropout = dropout\n        nn.init.xavier_uniform_(self.a.data, gain=1.414)\n\n    def forward(self, x, edge_index):\n        # Linear transformation\n        Wh = self.W(x)  # [N, out_channels]\n        N = Wh.size(0)\n\n        # Compute attention coefficients\n        src, dst = edge_index\n        # Concatenate source and destination features\n        Wh_src = Wh[src]  # [E, out_channels]\n        Wh_dst = Wh[dst]  # [E, out_channels]\n        concat_features = torch.cat([Wh_src, Wh_dst], dim=1)  # [E, 2*out_channels]\n\n        # Attention mechanism\n        e = self.leakyrelu(concat_features @ self.a).squeeze()  # [E]\n\n        # Normalize per destination node\n        attention = torch.zeros(N, device=x.device)\n        attention_weights = torch.zeros_like(e)\n\n        for i in range(N):\n            mask = (dst == i)\n            if mask.sum() > 0:\n                e_neighbors = e[mask]\n                alpha = F.softmax(e_neighbors, dim=0)\n                attention_weights[mask] = alpha\n\n        # Apply dropout to attention\n        attention_weights = F.dropout(attention_weights, self.dropout, training=self.training)\n\n        # Aggregate\n        out = torch.zeros_like(Wh)\n        for i in range(N):\n            mask = (dst == i)\n            if mask.sum() > 0:\n                out[i] = (attention_weights[mask].unsqueeze(1) * Wh[src[mask]]).sum(dim=0)\n\n        return out\n\nclass GAT(nn.Module):\n    def __init__(self, in_channels, hidden_channels, out_channels,\n                 num_heads=8, dropout=0.6):\n        super().__init__()\n        self.dropout = dropout\n\n        # Multi-head first layer\n        self.attentions = nn.ModuleList([\n            GATLayer(in_channels, hidden_channels, dropout=dropout)\n            for _ in range(num_heads)\n        ])\n\n        # Single-head output layer\n        self.out_att = GATLayer(\n            hidden_channels * num_heads,\n            out_channels,\n            dropout=dropout\n        )\n\n    def forward(self, x, edge_index):\n        # First layer: concatenate multi-head outputs\n        x = torch.cat([att(x, edge_index) for att in self.attentions], dim=1)\n        x = F.dropout(x, self.dropout, training=self.training)\n        x = F.elu(x)\n\n        # Output layer\n        x = self.out_att(x, edge_index)\n        return x\n```\n\n**Strengths**:\n- Learns which neighbors are important (anisotropic)\n- Better at handling heterogeneous neighborhoods\n- Respects sharp boundaries (e.g., tumor-stroma)\n\n**Weaknesses**:\n- More parameters (attention + multi-heads)\n- Slower than GCN\n- Can be unstable (needs careful tuning of dropout, LR)\n\n---\n\n## Architecture Comparison Table\n\n| Model | Neighbor Weights | Sampling | Inductive? | Best Use Case |\n|-------|-----------------|----------|------------|---------------|\n| **GCN** | Fixed by normalized adjacency | Full graph (no sampling) | No (transductive) | Smooth tissue, clean spatial graphs, small-medium datasets |\n| **GraphSAGE** | Fixed aggregator (mean/max/LSTM) | Neighborhood sampling | Yes | Large graphs, multiple slides, production systems |\n| **GAT** | Learned per-edge attention | Full neighborhood (or can sample) | Often yes | Heterogeneous tissue, sharp boundaries, variable neighbor quality |\n\n**Visual Comparison**:\n\n```\nGCN:      All neighbors weighted equally (by degree normalization)\n          [Spot] ← (0.25, 0.25, 0.25, 0.25) ← [4 neighbors]\n\nGraphSAGE: Sample subset, aggregate with mean/max\n          [Spot] ← sample 2 → mean([n1, n2])\n\nGAT:      Learn attention per edge\n          [Spot] ← (α₁=0.5, α₂=0.3, α₃=0.15, α₄=0.05) ← [4 neighbors]\n                    ↑ Learned weights\n```\n\n---\n\n## Graph Construction Strategies\n\n**Critical insight**: Graph topology often matters more than the GNN architecture.\n\n### 1. Spatial Proximity Graphs\n\n#### k-Nearest Neighbors (kNN)\n\nConnect each spot to its `k` closest spatial neighbors.\n\n```python\nimport numpy as np\nfrom sklearn.neighbors import NearestNeighbors\nimport torch\n\ndef knn_graph(coords, k=6):\n    \"\"\"\n    Build kNN graph from spatial coordinates.\n\n    Args:\n        coords: [N, 2] array of (x, y) positions\n        k: number of neighbors\n    Returns:\n        edge_index: [2, E] tensor in COO format\n    \"\"\"\n    nbrs = NearestNeighbors(n_neighbors=k+1, algorithm='kd_tree').fit(coords)\n    distances, indices = nbrs.kneighbors(coords)\n\n    # Exclude self (first neighbor)\n    src = np.repeat(np.arange(len(coords)), k)\n    dst = indices[:, 1:].reshape(-1)\n\n    # Make undirected\n    edge_index = np.stack([src, dst], axis=0)\n    edge_index = np.concatenate([edge_index, edge_index[::-1]], axis=1)\n    edge_index = np.unique(edge_index, axis=1)\n\n    return torch.as_tensor(edge_index, dtype=torch.long)\n```\n\n**Pros**: Simple, controllable density\n**Cons**: Fixed `k` ignores tissue density variation\n\n**Effect of `k` on smoothing**:\n- **Small `k` (4-6)**: Preserves sharp boundaries, less smoothing\n- **Large `k` (12-20)**: More smoothing, boundaries blur, risk of over-smoothing\n\n#### Radius (ε-ball) Graph\n\nConnect all spots within distance `ε`.\n\n```python\ndef radius_graph(coords, radius=100.0):\n    \"\"\"\n    Build radius graph: connect nodes within distance threshold.\n    \"\"\"\n    from sklearn.neighbors import radius_neighbors_graph\n    A = radius_neighbors_graph(coords, radius, mode='connectivity')\n    edge_index = torch.as_tensor(np.array(A.nonzero()), dtype=torch.long)\n    return edge_index\n```\n\n**Pros**: Density-adaptive, physically meaningful\n**Cons**: Can create disconnected components if `ε` too small\n\n#### Delaunay Triangulation\n\nBuild triangles connecting nearest points without overlap—preserves natural geometry.\n\n```python\nfrom scipy.spatial import Delaunay\nimport numpy as np\n\ndef delaunay_graph(coords):\n    \"\"\"\n    Build graph from Delaunay triangulation.\n    Used in SpaGCN for natural spatial connectivity.\n    \"\"\"\n    tri = Delaunay(coords)\n    edges = set()\n    for simplex in tri.simplices:\n        for i in range(3):\n            edge = tuple(sorted([simplex[i], simplex[(i+1)%3]]))\n            edges.add(edge)\n\n    edges = np.array(list(edges)).T\n    # Make undirected\n    edge_index = np.concatenate([edges, edges[::-1]], axis=1)\n    return torch.as_tensor(edge_index, dtype=torch.long)\n```\n\n**Pros**: Natural geometric structure, used in SpaGCN\n**Cons**: Can create long edges in sparse regions\n\n---\n\n### 2. Expression Similarity Graphs\n\nConnect spots with similar gene expression, independent of distance.\n\n```python\ndef expression_similarity_graph(X, k=10, metric='cosine'):\n    \"\"\"\n    Build kNN graph in expression space.\n\n    Args:\n        X: [N, genes] expression matrix\n        k: number of neighbors\n        metric: 'cosine' or 'euclidean'\n    \"\"\"\n    from sklearn.neighbors import NearestNeighbors\n    nbrs = NearestNeighbors(n_neighbors=k+1, metric=metric).fit(X)\n    distances, indices = nbrs.kneighbors(X)\n\n    src = np.repeat(np.arange(len(X)), k)\n    dst = indices[:, 1:].reshape(-1)\n    edge_index = np.stack([src, dst], axis=0)\n\n    # Undirected\n    edge_index = np.concatenate([edge_index, edge_index[::-1]], axis=1)\n    edge_index = np.unique(edge_index, axis=1)\n\n    return torch.as_tensor(edge_index, dtype=torch.long)\n```\n\n**Pros**: Captures functional/molecular similarity\n**Cons**: May connect distant regions; ignores spatial structure\n\n---\n\n### 3. Hybrid (Multi-view) Graphs\n\nCombine spatial and expression information.\n\n**Weighted combination**:\n\n```\nA = α · A_spatial + (1 - α) · A_expression\n```\n\n**Learnable weighting**:\n\n```python\nclass MultiViewGNN(nn.Module):\n    def __init__(self, in_channels, out_channels):\n        super().__init__()\n        self.gcn_spatial = GCNLayer(in_channels, out_channels)\n        self.gcn_expression = GCNLayer(in_channels, out_channels)\n        self.alpha = nn.Parameter(torch.tensor(0.5))  # Learnable weight\n\n    def forward(self, x, edge_index_spatial, edge_index_expr):\n        h_spatial = self.gcn_spatial(x, edge_index_spatial)\n        h_expr = self.gcn_expression(x, edge_index_expr)\n\n        alpha = torch.sigmoid(self.alpha)  # Ensure [0,1]\n        return alpha * h_spatial + (1 - alpha) * h_expr\n```\n\n**Used in**: STAGATE, conST, GraphST\n\n---\n\n### 4. Image-Based Graphs (Histology Integration)\n\nIf H&E images are available, use morphological similarity.\n\n```python\ndef image_weighted_graph(coords, image_features, k=6, alpha=0.5):\n    \"\"\"\n    Weighted graph combining spatial distance and image feature similarity.\n\n    Args:\n        coords: [N, 2] spatial positions\n        image_features: [N, D] CNN features from histology patches\n        alpha: weight between spatial and image (0=spatial only, 1=image only)\n    \"\"\"\n    from sklearn.neighbors import NearestNeighbors\n    from sklearn.metrics.pairwise import cosine_similarity\n\n    # Spatial kNN\n    nbrs_spatial = NearestNeighbors(n_neighbors=k+1).fit(coords)\n    dist_spatial, idx_spatial = nbrs_spatial.kneighbors(coords)\n\n    # Image similarity\n    img_sim = cosine_similarity(image_features)\n\n    edges = []\n    weights = []\n    for i in range(len(coords)):\n        for j_idx, j in enumerate(idx_spatial[i, 1:]):  # Skip self\n            spatial_sim = 1.0 / (1.0 + dist_spatial[i, j_idx+1])\n            image_sim_val = img_sim[i, j]\n\n            combined_weight = alpha * spatial_sim + (1 - alpha) * image_sim_val\n            edges.append([i, j])\n            weights.append(combined_weight)\n\n    edge_index = torch.tensor(edges, dtype=torch.long).T\n    edge_weight = torch.tensor(weights, dtype=torch.float)\n\n    return edge_index, edge_weight\n```\n\n**Used in**: SpaGCN, conST, MERGE\n\n---\n\n## State-of-the-Art Methods in Spatial Transcriptomics\n\n### Method Comparison Table\n\n| Method | Year | Graph Type | GNN Architecture | Key Innovation | Task |\n|--------|------|------------|------------------|----------------|------|\n| **SpaGCN** | 2021 | Spatial + histology weighted | GCN | Delaunay + image features, domain detection | Clustering, SVG detection |\n| **STAGATE** | 2022 | Spatial kNN | Graph Attention Autoencoder | Learned attention, autoencoder framework | Clustering, denoising, trajectory |\n| **SEDR** | 2021 | Spatial kNN | VGAE + deep autoencoder | Dual embedding (expression + spatial VGAE) | Clustering, embedding |\n| **GraphST** | 2023 | Multi-view (spatial + expr) | GCN + contrastive learning | Self-supervised contrastive, multi-sample integration | Clustering, deconvolution |\n| **STdGCN** | 2023 | Hybrid (spot + pseudo-spot) | GCN | Integrate scRNA reference via hybrid graph | Deconvolution |\n| **stAA** | 2024 | Spatial kNN | Adversarial VGAE | WGAN regularization on embeddings | Clustering |\n| **stMCDI** | 2024 | Spatial | GNN encoder in diffusion model | Diffusion-based imputation with GNN | Missing value imputation |\n| **MERGE** | 2023 | Hierarchical image patches | Multi-scale GNN | Image → gene prediction via hierarchical graph | Prediction from histology |\n\n---\n\n### Deep Dive: SpaGCN\n\n**Paper**: Hu et al., *Nature Methods* (2021)\n\n**Problem**: Identify spatial domains using both gene expression and tissue morphology.\n\n**Graph Construction**:\n1. Build Delaunay triangulation from spot coordinates\n2. Weight edges by combination of:\n   - Spatial distance\n   - Histology image similarity (compare H&E patches around each spot)\n\n```\nw_ij = exp(-d_spatial(i,j)² / 2σ_d²) × exp(-d_image(i,j)² / 2σ_i²)\n```\n\n**GNN**: Standard GCN with weighted adjacency\n\n**Loss**: Combines:\n- Clustering loss (Louvain or k-means on embeddings)\n- Spatial regularization (neighbors should have similar cluster assignments)\n\n**Code Sketch**:\n\n```python\n# Weighted adjacency from spatial + image\nA_weighted = spatial_weight * image_weight\n\n# GCN embedding\nH = gcn_layers(X, A_weighted)\n\n# Clustering\nclusters = louvain_clustering(H)\n\n# Find spatially variable genes per domain\nsvg_genes = differential_expression_per_domain(clusters)\n```\n\n**Strengths**: Multi-modal, interpretable, works well on Visium data\n**Limitations**: Static graph, sensitive to weighting hyperparameters\n\n---\n\n### Deep Dive: STAGATE\n\n**Paper**: Dong & Chen, *Nature Communications* (2022)\n\n**Problem**: Learn representations robust to noise, preserve spatial structure, enable downstream tasks (clustering, pseudotime).\n\n**Architecture**: Graph Attention Autoencoder\n- **Encoder**: Multi-layer GAT → latent embedding `Z`\n- **Decoder**: Reconstruct both expression `X` and adjacency `A`\n\n**Key Innovation**: Attention mechanism learns which neighbors are relevant, mitigating over-smoothing.\n\n**Loss**:\n\n```\nL = L_recon(X, X̂) + λ · L_graph(A, Â)\n```\n\nWhere:\n- `L_recon` = MSE for expression reconstruction\n- `L_graph` = binary cross-entropy for adjacency reconstruction\n\n**Code Outline**:\n\n```python\nclass STAGATE(nn.Module):\n    def __init__(self, n_genes, hidden_dim, latent_dim):\n        super().__init__()\n        self.encoder = nn.ModuleList([\n            GATLayer(n_genes, hidden_dim),\n            GATLayer(hidden_dim, latent_dim)\n        ])\n        self.decoder_expr = nn.Linear(latent_dim, n_genes)\n        self.decoder_graph = InnerProductDecoder()\n\n    def forward(self, x, edge_index):\n        # Encode\n        h = x\n        for layer in self.encoder:\n            h = F.elu(layer(h, edge_index))\n\n        # Decode\n        x_recon = self.decoder_expr(h)\n        adj_recon = torch.sigmoid(h @ h.T)  # Inner product for adjacency\n\n        return x_recon, adj_recon, h\n```\n\n**Strengths**: Adaptive smoothing, rich embeddings for multiple tasks\n**Limitations**: More hyperparameters, potential overfitting on small datasets\n\n---\n\n### Deep Dive: GraphST (Contrastive Learning)\n\n**Paper**: Long et al., *Nature Communications* (2023)\n\n**Problem**: Integrate multiple tissue sections, perform clustering and deconvolution.\n\n**Key Idea**: Self-supervised contrastive learning on graph embeddings.\n\n**Method**:\n1. Build two views of the same graph (e.g., different augmentations or spatial vs. expression graphs)\n2. Encode both with GCN\n3. Contrastive loss: pull together embeddings from same spot, push apart different spots\n\n```\nL_contrast = -log(exp(sim(z_i, z_i⁺) / τ) / Σ_j exp(sim(z_i, z_j) / τ))\n```\n\nWhere `z_i⁺` is the augmented view of spot `i`.\n\n**Benefits**:\n- Learns robust representations without labeled data\n- Aligns multiple slides in shared embedding space\n\n**Code Sketch**:\n\n```python\n# Create two views\nedge_index_view1 = knn_graph(coords, k=6)\nedge_index_view2 = expression_similarity_graph(X, k=10)\n\n# Encode both\nz1 = gnn_encoder(X, edge_index_view1)\nz2 = gnn_encoder(X, edge_index_view2)\n\n# Contrastive loss (InfoNCE)\nloss = contrastive_loss(z1, z2, temperature=0.5)\n```\n\n---\n\n## Implementation Guide\n\n### Complete Pipeline: Spatial Domain Detection\n\nHere's a complete, runnable pipeline from raw Visium data to domain detection using a GNN.\n\n#### Step 1: Load Data\n\n```python\nimport scanpy as sc\nimport numpy as np\nimport torch\nfrom sklearn.preprocessing import StandardScaler\n\n# Load Visium data (standard scanpy format)\nadata = sc.read_visium(\"path/to/visium/data\")\n\n# Extract coordinates and expression\ncoords = adata.obsm['spatial']  # [N, 2]\nX = adata.X.toarray() if hasattr(adata.X, 'toarray') else adata.X  # [N, genes]\n\n# Highly variable genes\nsc.pp.highly_variable_genes(adata, n_top_genes=2000)\nX = X[:, adata.var['highly_variable']]\n\n# Normalize\nX = StandardScaler().fit_transform(X)\n\n# To tensors\nX_tensor = torch.tensor(X, dtype=torch.float32)\ncoords_np = np.array(coords)\n```\n\n#### Step 2: Build Graph\n\n```python\nfrom sklearn.neighbors import NearestNeighbors\n\ndef build_spatial_graph(coords, k=6):\n    nbrs = NearestNeighbors(n_neighbors=k+1).fit(coords)\n    _, indices = nbrs.kneighbors(coords)\n\n    src = np.repeat(np.arange(len(coords)), k)\n    dst = indices[:, 1:].reshape(-1)\n    edge_index = np.stack([src, dst], axis=0)\n\n    # Undirected\n    edge_index = np.concatenate([edge_index, edge_index[::-1]], axis=1)\n    edge_index = np.unique(edge_index, axis=1)\n\n    return torch.tensor(edge_index, dtype=torch.long)\n\nedge_index = build_spatial_graph(coords_np, k=6)\n```\n\n#### Step 3: Define Model\n\n```python\nclass SpatialGNN(nn.Module):\n    def __init__(self, n_genes, hidden_dim=128, latent_dim=32, n_clusters=7):\n        super().__init__()\n        self.encoder = nn.ModuleList([\n            GCNLayer(n_genes, hidden_dim),\n            GCNLayer(hidden_dim, latent_dim)\n        ])\n        self.cluster_head = nn.Linear(latent_dim, n_clusters)\n\n    def forward(self, x, edge_index):\n        h = x\n        for layer in self.encoder:\n            h = layer(h, edge_index)\n            h = F.relu(h)\n            h = F.dropout(h, p=0.3, training=self.training)\n\n        logits = self.cluster_head(h)\n        return h, logits\n\nmodel = SpatialGNN(n_genes=X.shape[1], n_clusters=7)\noptimizer = torch.optim.Adam(model.parameters(), lr=0.001)\n```\n\n#### Step 4: Training Loop\n\n```python\nfrom sklearn.cluster import KMeans\n\ndef train_epoch(model, x, edge_index, optimizer):\n    model.train()\n    optimizer.zero_grad()\n\n    # Forward\n    embeddings, logits = model(x, edge_index)\n\n    # Pseudo-labels from k-means (self-supervised)\n    with torch.no_grad():\n        kmeans = KMeans(n_clusters=7, random_state=42)\n        pseudo_labels = kmeans.fit_predict(embeddings.cpu().numpy())\n        pseudo_labels = torch.tensor(pseudo_labels, dtype=torch.long)\n\n    # Cross-entropy loss\n    loss = F.cross_entropy(logits, pseudo_labels)\n\n    loss.backward()\n    optimizer.step()\n\n    return loss.item()\n\n# Train\nfor epoch in range(100):\n    loss = train_epoch(model, X_tensor, edge_index, optimizer)\n    if epoch % 10 == 0:\n        print(f\"Epoch {epoch}, Loss: {loss:.4f}\")\n```\n\n#### Step 5: Extract Clusters and Visualize\n\n```python\nmodel.eval()\nwith torch.no_grad():\n    embeddings, logits = model(X_tensor, edge_index)\n    clusters = logits.argmax(dim=1).cpu().numpy()\n\n# Add to adata\nadata.obs['gnn_cluster'] = clusters\n\n# Visualize on tissue\nimport scanpy as sc\nsc.pl.spatial(adata, color='gnn_cluster', spot_size=150)\n```\n\n---\n\n## Practical Considerations\n\n### 1. Over-smoothing Problem\n\n**Issue**: With many GNN layers, all node features converge to the same value.\n\n**Why**: Each layer mixes neighbors' features, leading to exponential diffusion.\n\n**Solutions**:\n- **Limit layers**: 2-3 layers often enough for ST (tissue neighborhoods are local)\n- **Skip connections**: Add residual connections\n\n  ```python\n  h_new = gcn_layer(h) + h  # Residual\n  ```\n\n- **Adaptive depth** (DropEdge, PairNorm): Randomly drop edges or normalize layer outputs\n\n**Rule of thumb for ST**:\n- Small tissue sections: 2 layers\n- Whole-slide: 3-4 layers max\n- Multi-sample integration: Consider global pooling instead of deeper GNN\n\n---\n\n### 2. Choosing Hyperparameter $k$ (Number of Neighbors)\n\n**Trade-off**:\n- **Low $k$ (4-6)**: Sharp boundaries, less smoothing, more noise sensitivity\n- **High $k$ (12-20)**: Smoother, more stable, but blurs boundaries\n\n**Guideline**:\n- **Delaunay**: Natural choice, typically $k \\approx 6$\n- **Brain cortex / layered tissue**: Lower $k$ to preserve layers\n- **Tumor heterogeneity**: Mid-range $k$ (6-8)\n- **Dense spot arrays (Visium HD)**: Higher $k$ (10-15)\n\n**Experiment**: Try $k \\in \\{4, 6, 8, 10, 12\\}$ and check:\n- Silhouette score on clusters\n- Agreement with known anatomical regions\n\n---\n\n### 3. Normalization and Preprocessing\n\n**Critical steps**:\n\n1. **Gene selection**: Use highly variable genes (1000-3000)\n2. **Expression normalization**: Log1p + standard scaling\n3. **Graph normalization**: Symmetric $\\tilde{D}^{-1/2} \\tilde{A} \\tilde{D}^{-1/2}$ (built into GCN)\n4. **Feature scaling**: StandardScaler before training\n\n```python\nimport scanpy as sc\nfrom sklearn.preprocessing import StandardScaler\n\n# Standard pipeline\nsc.pp.normalize_total(adata, target_sum=1e4)\nsc.pp.log1p(adata)\nsc.pp.highly_variable_genes(adata, n_top_genes=2000)\nadata = adata[:, adata.var.highly_variable]\n\nX = StandardScaler().fit_transform(adata.X.toarray())\n```\n\n---\n\n### 4. Evaluation Metrics\n\nFor **clustering**:\n- **Adjusted Rand Index (ARI)**: Compare with ground-truth annotations\n- **Normalized Mutual Information (NMI)**\n- **Silhouette score**: Cluster separation in embedding space\n\nFor **deconvolution**:\n- **RMSE** vs. known proportions (if synthetic data)\n- **Correlation** with reference cell-type markers\n\nFor **imputation**:\n- **RMSE** on held-out genes\n- **Pearson correlation** with ground truth\n\n```python\nfrom sklearn.metrics import adjusted_rand_score, silhouette_score\n\n# Clustering evaluation\nari = adjusted_rand_score(true_labels, predicted_clusters)\nsilhouette = silhouette_score(embeddings, predicted_clusters)\n\nprint(f\"ARI: {ari:.3f}, Silhouette: {silhouette:.3f}\")\n```\n\n---\n\n### 5. Common Pitfalls\n\n| Problem | Symptom | Solution |\n|---------|---------|----------|\n| **Over-smoothing** | All embeddings identical | Reduce layers, add skip connections |\n| **Disconnected graph** | NaN in training | Check graph connectivity, increase $k$ or $\\varepsilon$ |\n| **Unstable GAT** | Loss spikes | Lower learning rate, increase dropout on attention |\n| **Poor clustering** | Random assignments | Better graph construction, tune $k$, check normalization |\n| **High memory** | OOM errors | Use mini-batching (GraphSAGE), neighbor sampling |\n\n---\n\n## Advanced Topics\n\n### 1. Hypergraph Neural Networks\n\n**Standard GNN**: Pairwise edges (connects 2 nodes)\n**Hypergraph**: Hyperedges connect ≥2 nodes simultaneously\n\n**Use case in ST**: Group of spots in a tissue domain share a hyperedge\n\n**Example**: [Hypergraph Neural Networks Reveal Spatial Domains](https://arxiv.org/abs/2401.12001)\n\n### 2. Hierarchical and Multi-Scale Graphs\n\n**Idea**: Build graphs at multiple resolutions\n- Fine-scale: spot-to-spot\n- Coarse-scale: domain-to-domain (via clustering)\n\n**Benefits**: Capture both local and global patterns\n\n**Example**: MERGE builds hierarchical image patch graphs\n\n### 3. Graph Transformers\n\nReplace message-passing with full self-attention over all nodes.\n\n**Pros**: No over-smoothing, long-range dependencies\n**Cons**: $O(N^2)$ complexity\n\n**Emerging work**: Graphormer, GraphGPS\n\n---\n\n## Resources and Next Steps\n\n### Papers (Recommended Reading Order)\n\n1. **GNN Foundations**:\n   - Kipf & Welling (2017): [Semi-Supervised Classification with GCNs](https://arxiv.org/abs/1609.02907)\n   - Hamilton et al. (2017): [GraphSAGE](https://arxiv.org/abs/1706.02216)\n   - Veličković et al. (2018): [Graph Attention Networks](https://arxiv.org/abs/1710.10903)\n\n2. **ST Applications**:\n   - SpaGCN: [Nature Methods 2021](https://www.nature.com/articles/s41592-021-01255-8)\n   - STAGATE: [Nature Communications 2022](https://www.nature.com/articles/s41467-022-29439-6)\n   - GraphST: [Nature Communications 2023](https://www.nature.com/articles/s41467-023-36796-3)\n\n3. **Advanced**:\n   - [Stanford CS224W course notes](http://web.stanford.edu/class/cs224w/)\n   - [Graph Representation Learning Book](https://www.cs.mcgill.ca/~wlh/grl_book/) (Hamilton)\n\n### Code Repositories\n\n- **PyTorch Geometric**: [https://pytorch-geometric.readthedocs.io/](https://pytorch-geometric.readthedocs.io/)\n- **DGL (Deep Graph Library)**: [https://www.dgl.ai/](https://www.dgl.ai/)\n- **STAGATE**: [https://github.com/zhanglabtools/STAGATE](https://github.com/zhanglabtools/STAGATE)\n- **GraphST**: [https://github.com/JinmiaoChenLab/GraphST](https://github.com/JinmiaoChenLab/GraphST)\n\n### Practice Projects\n\n1. **Reproduce SpaGCN** on a public Visium dataset (e.g., mouse brain)\n2. **Compare GCN vs. GAT** on your own ST data—measure ARI, runtime, smoothness\n3. **Build a hybrid graph** (spatial + expression) and tune the weighting parameter $\\alpha$\n4. **Implement contrastive learning** for multi-sample integration\n\n---\n\n## Conclusion\n\nGraph Neural Networks provide a powerful, principled framework for spatial transcriptomics analysis by:\n\n- **Respecting spatial structure** through graph topology\n- **Learning adaptive representations** via message passing\n- **Integrating multi-modal data** (expression, coordinates, images)\n- **Scaling to large datasets** with sampling and mini-batching\n\nThe key to success is:\n1. **Graph construction**: Choose topology that reflects your biology\n2. **Architecture selection**: Match model complexity to data size and task\n3. **Regularization**: Prevent over-smoothing and overfitting\n4. **Evaluation**: Use domain-relevant metrics and biological validation\n\nAs spatial omics technologies advance (Visium HD, Xenium, CosMx), GNNs will remain essential tools for discovering tissue organization, cell-cell interactions, and disease mechanisms.\n\n---\n\n**Happy graph learning!**\n",
          "code": "var Component=(()=>{var p=Object.create;var a=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var m=(l,n)=>()=>(n||l((n={exports:{}}).exports,n),n.exports),u=(l,n)=>{for(var r in n)a(l,r,{get:n[r],enumerable:!0})},i=(l,n,r,c)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let s of y(n))!g.call(l,s)&&s!==r&&a(l,s,{get:()=>n[s],enumerable:!(c=E(n,s))||c.enumerable});return l};var f=(l,n,r)=>(r=l!=null?p(F(l)):{},i(n||!l||!l.__esModule?a(r,\"default\",{value:l,enumerable:!0}):r,l)),_=l=>i(a({},\"__esModule\",{value:!0}),l);var d=m((x,o)=>{o.exports=_jsx_runtime});var b={};u(b,{default:()=>h,frontmatter:()=>B});var e=f(d()),B={title:\"Graph Neural Networks for Spatial Transcriptomics\",summary:\"A comprehensive guide to understanding and applying GNNs to spatial transcriptomics data, from foundational concepts to cutting-edge research implementations\",status:\"completed\",role:\"Research & Implementation\",stack:[\"PyTorch\",\"PyTorch Geometric\",\"Python\",\"Graph Neural Networks\",\"Spatial Transcriptomics\"],repoUrl:\"https://github.com/yourusername/gnn-spatial-transcriptomics\",tags:[\"deep learning\",\"bioinformatics\",\"graph neural networks\",\"spatial transcriptomics\",\"computational biology\"],featured:!0,startDate:\"2025-08-15\"};function t(l){let n={a:\"a\",code:\"code\",em:\"em\",figure:\"figure\",h1:\"h1\",h2:\"h2\",h3:\"h3\",h4:\"h4\",hr:\"hr\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...l.components};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h1,{id:\"graph-neural-networks-for-spatial-transcriptomics\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#graph-neural-networks-for-spatial-transcriptomics\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Graph Neural Networks for Spatial Transcriptomics\"]}),`\n`,(0,e.jsx)(n.p,{children:\"A deep dive into applying Graph Neural Networks (GNNs) to spatial transcriptomics research, bridging deep learning theory with cutting-edge biological applications.\"}),`\n`,(0,e.jsxs)(n.h2,{id:\"table-of-contents\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#table-of-contents\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Table of Contents\"]}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"#introduction\",children:\"Introduction\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"#from-cnns-to-gnns\",children:\"From CNNs to GNNs\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"#core-gnn-architectures\",children:\"Core GNN Architectures\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"#graph-construction-strategies\",children:\"Graph Construction Strategies\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"#state-of-the-art-methods\",children:\"State-of-the-Art Methods in Spatial Transcriptomics\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"#implementation-guide\",children:\"Implementation Guide\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"#practical-considerations\",children:\"Practical Considerations\"})}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h2,{id:\"introduction\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#introduction\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Introduction\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Spatial transcriptomics (ST) captures gene expression while preserving the physical location of cells in tissue. This spatial context creates a natural graph structure where:\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Nodes\"}),\" = spots/cells with gene expression vectors\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Edges\"}),\" = spatial proximity or molecular similarity\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Task\"}),\" = identify tissue domains, cell types, or spatial patterns\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"Graph Neural Networks provide a powerful framework to leverage this structure, enabling message-passing that respects both spatial topology and molecular relationships.\"}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h2,{id:\"from-cnns-to-gnns\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#from-cnns-to-gnns\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"From CNNs to GNNs\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"why-cnns-cant-handle-irregular-grids\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#why-cnns-cant-handle-irregular-grids\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Why CNNs Can't Handle Irregular Grids\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Convolutional Neural Networks excel at structured data (images) because:\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Local connectivity\"}),\": Each pixel has a fixed neighborhood (e.g., 3\\xD73)\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Weight sharing\"}),\": The same filter slides across all positions, making parameter efficient\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Translation invariance\"}),\": Patterns learned anywhere apply everywhere\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"The convolution operation at pixel \",(0,e.jsx)(n.code,{children:\"(i,j)\"}),\" is:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`y_{i,j} = \\u03A3_{a=-1}^{1} \\u03A3_{b=-1}^{1} w_{a,b} \\xB7 x_{i+a, j+b}\n`})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"The problem for spatial transcriptomics\"}),\": Spots are irregularly spaced and often have varying numbers of neighbors. We can't use a fixed 3\\xD73 kernel.\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"message-passing-the-key-insight\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#message-passing-the-key-insight\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Message Passing: The Key Insight\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"GNNs generalize convolution to \",(0,e.jsx)(n.strong,{children:\"arbitrary graph structures\"}),\" through message passing:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`h_i^(l+1) = \\u03C3(W^(l) \\xB7 AGGREGATE{h_j^(l) : j \\u2208 N(i)})\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"Where:\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"h_i^(l)\"}),\" = feature vector of node \",(0,e.jsx)(n.code,{children:\"i\"}),\" at layer \",(0,e.jsx)(n.code,{children:\"l\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"N(i)\"}),\" = neighbors of node \",(0,e.jsx)(n.code,{children:\"i\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"W^(l)\"}),\" = learnable weight matrix\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"\\u03C3\"}),\" = activation function (ReLU, etc.)\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"This is conceptually similar to CNN convolution, but:\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"Neighbors are defined by \",(0,e.jsx)(n.strong,{children:\"edges\"}),\", not spatial proximity on a grid\"]}),`\n`,(0,e.jsxs)(n.li,{children:[\"Each node can have a \",(0,e.jsx)(n.strong,{children:\"variable number\"}),\" of neighbors\"]}),`\n`,(0,e.jsxs)(n.li,{children:[\"Weights are \",(0,e.jsx)(n.strong,{children:\"shared across all nodes\"}),\", just like CNN filters\"]}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h2,{id:\"core-gnn-architectures\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#core-gnn-architectures\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Core GNN Architectures\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"1-graph-convolutional-network-gcn\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#1-graph-convolutional-network-gcn\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"1. Graph Convolutional Network (GCN)\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Paper\"}),\": Kipf & Welling (2017)\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Core Idea\"}),\": Normalize neighbor aggregation by degree to prevent scale issues.\"]}),`\n`,(0,e.jsxs)(n.h4,{id:\"mathematical-formulation\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#mathematical-formulation\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Mathematical Formulation\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Given:\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"X\"}),\" \\u2208 \\u211D^(N \\xD7 F): node features (N spots, F genes)\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"A\"}),\" \\u2208 \\u211D^(N \\xD7 N): adjacency matrix\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"D\"}),\": degree matrix (diagonal, where D_ii = sum of A_ij over j)\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"Add self-loops and normalize:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`\\xC3 = A + I  (add self-connections)\nD\\u0303\\u1D62\\u1D62 = \\u03A3\\u2C7C \\xC3\\u1D62\\u2C7C  (recompute degrees)\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"The GCN layer performs symmetric normalization:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`H\\u207D\\u02E1\\u207A\\xB9\\u207E = \\u03C3(D\\u0303\\u207B\\xB9\\u141F\\xB2 \\xE0 D\\u0303\\u207B\\xB9\\u141F\\xB2 H\\u207D\\u02E1\\u207E W\\u207D\\u02E1\\u207E)\n`})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Intuition\"}),\": The symmetric normalization \",(0,e.jsx)(n.code,{children:\"D\\u0303\\u207B\\xB9\\u141F\\xB2 \\xC3 D\\u0303\\u207B\\xB9\\u141F\\xB2\"}),\" creates a normalized adjacency that averages features fairly across neighbors, preventing high-degree nodes from dominating.\"]}),`\n`,(0,e.jsxs)(n.h4,{id:\"pytorch-implementation-matrix-form\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#pytorch-implementation-matrix-form\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"PyTorch Implementation (Matrix Form)\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" normalize_adj\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(edge_index, num_nodes):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Build symmetric normalized adjacency: D^{-1/2} A D^{-1/2}\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Returns sparse tensor indices and values.\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    i, j \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" edge_index\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # Add self-loops\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    self_loops \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.arange(num_nodes, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"device\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"edge_index.device)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    i \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.cat([i, self_loops])\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    j \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.cat([j, self_loops])\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # Compute degree\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    deg \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.bincount(j, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"minlength\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"num_nodes).float()\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    deg_inv_sqrt \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" deg.clamp(\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"min\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\").pow(\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # Symmetric normalization weights\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    vals \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" deg_inv_sqrt[i] \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" deg_inv_sqrt[j]\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.stack([i, j], \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"), vals\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" GCNLayer\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Graph Convolutional Layer with sparse adjacency multiply.\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, out_channels, bias\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"True\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".lin \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(in_channels, out_channels, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"bias\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"bias)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        N \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" x.size(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        idx, vals \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" normalize_adj(edge_index, N)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        A_norm \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.sparse_coo_tensor(idx, vals, (N, N), \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"device\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"x.device)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".lin(x)                    \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# [N, F_out]\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.sparse.mm(A_norm, x)     \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Sparse matrix multiply\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.relu(x)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Full GCN Model\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" GCN\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, hidden_channels, out_channels, num_layers\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".layers \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList()\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(GCNLayer(in_channels, hidden_channels))\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" _ \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(num_layers \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" 2\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"            self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(GCNLayer(hidden_channels, hidden_channels))\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(GCNLayer(hidden_channels, out_channels))\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" i, layer \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" enumerate\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".layers[:\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"]):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" layer(x, edge_index)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.relu(x)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.dropout(x, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"p\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"train\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".layers[\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"](x, edge_index)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]})]})})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Strengths\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Simple, efficient, mathematically principled\"}),`\n`,(0,e.jsx)(n.li,{children:\"Fast on small-to-medium graphs\"}),`\n`,(0,e.jsx)(n.li,{children:\"Smooth aggregation good for homogeneous tissue\"}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Weaknesses\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Fixed (isotropic) weights\\u2014all neighbors treated equally\"}),`\n`,(0,e.jsx)(n.li,{children:\"Transductive (needs full graph at training)\"}),`\n`,(0,e.jsx)(n.li,{children:\"Over-smoothing with many layers\"}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h3,{id:\"2-graphsage\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#2-graphsage\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"2. GraphSAGE\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Paper\"}),\": Hamilton et al. (2017)\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Core Idea\"}),\": Sample neighbors and use robust aggregators (mean, LSTM, max-pool) to scale to large graphs and enable \",(0,e.jsx)(n.strong,{children:\"inductive learning\"}),\" (generalize to unseen nodes/graphs).\"]}),`\n`,(0,e.jsxs)(n.h4,{id:\"update-rule\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#update-rule\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Update Rule\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`h_i^(l+1) = \\u03C3(W \\xB7 CONCAT[h_i^(l), AGG{h_j^(l) : j \\u2208 N(i)}])\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"Key differences from GCN:\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Concatenate\"}),\" self-feature with aggregated neighbors (preserves identity)\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Sample\"}),\" a fixed number of neighbors (e.g., 10) instead of using all\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Aggregator\"}),\" choices: mean, max-pool, LSTM\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.h4,{id:\"pytorch-implementation\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#pytorch-implementation\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"PyTorch Implementation\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn.functional \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" F\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" SAGEConv\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    GraphSAGE layer with mean aggregation.\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, out_channels, normalize\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"True\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".lin_self \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(in_channels, out_channels)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".lin_neigh \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(in_channels, out_channels)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".normalize \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" normalize\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index, num_neighbors_sample\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        N \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" x.size(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Sample neighbors (for scalability)\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        src, dst \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" edge_index\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Group by destination\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        neighbors \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" {}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" s, d \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" zip\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(src.tolist(), dst.tolist()):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            neighbors.setdefault(d, []).append(s)\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Sample and aggregate\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        neigh_features \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" []\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(N):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"            if\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" neighbors \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"and\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" len\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(neighbors[i]) \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\">\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"                sampled \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"                    neighbors[i][:num_neighbors_sample],\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"                    device\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"x.device\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"                )\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"                neigh_features.append(x[sampled].mean(\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"))\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"            else\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"                neigh_features.append(torch.zeros(x.size(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"), \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"device\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"x.device))\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        neigh_agg \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.stack(neigh_features)  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# [N, F]\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Combine self and neighbor\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        out \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".lin_self(x) \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".lin_neigh(neigh_agg)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        if\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".normalize:\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            out \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" F.normalize(out, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"p\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" out\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" GraphSAGE\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, hidden_channels, out_channels, num_layers\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".layers \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList()\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(SAGEConv(in_channels, hidden_channels))\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" _ \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(num_layers \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" 2\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"            self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(SAGEConv(hidden_channels, hidden_channels))\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".layers.append(SAGEConv(hidden_channels, out_channels))\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" layer \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".layers[:\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"]:\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" layer(x, edge_index)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" F.relu(x)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" F.dropout(x, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"p\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"training\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".layers[\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"](x, edge_index)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]})]})})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Strengths\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Scales to massive graphs via neighbor sampling\"}),`\n`,(0,e.jsx)(n.li,{children:\"Inductive: can generalize to new slides without retraining\"}),`\n`,(0,e.jsx)(n.li,{children:\"Multiple aggregator options\"}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Weaknesses\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Sampling introduces variance\"}),`\n`,(0,e.jsx)(n.li,{children:\"More hyperparameters (sample size per layer)\"}),`\n`,(0,e.jsx)(n.li,{children:\"Still treats all sampled neighbors equally\"}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h3,{id:\"3-graph-attention-network-gat\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#3-graph-attention-network-gat\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"3. Graph Attention Network (GAT)\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Paper\"}),\": Veli\\u010Dkovi\\u0107 et al. (2018)\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Core Idea\"}),\": Learn \",(0,e.jsx)(n.strong,{children:\"per-edge attention weights\"}),\" so the model can focus on important neighbors and ignore noisy ones.\"]}),`\n`,(0,e.jsxs)(n.h4,{id:\"attention-mechanism\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#attention-mechanism\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Attention Mechanism\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"For each edge \",(0,e.jsx)(n.code,{children:\"(i, j)\"}),\":\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`e_ij = LeakyReLU(a^T [W\\xB7h_i || W\\xB7h_j])\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"Normalize with softmax over all neighbors:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`\\u03B1_ij = exp(e_ij) / \\u03A3_{k \\u2208 N(i)} exp(e_ik)\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"Aggregate with learned weights:\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`h_i^(l+1) = \\u03C3(\\u03A3_{j \\u2208 N(i)} \\u03B1_ij \\xB7 W \\xB7 h_j^(l))\n`})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Multi-head attention\"}),\" (like Transformers): Run \",(0,e.jsx)(n.code,{children:\"K\"}),\" independent attention heads and concatenate:\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`h_i^(l+1) = ||_{k=1}^K \\u03C3(\\u03A3_{j \\u2208 N(i)} \\u03B1_ij^k \\xB7 W^k \\xB7 h_j^(l))\n`})}),`\n`,(0,e.jsxs)(n.h4,{id:\"pytorch-implementation-1\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#pytorch-implementation-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"PyTorch Implementation\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.nn.functional \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" F\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" GATLayer\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Graph Attention Layer (single head).\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, out_channels, dropout\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0.6\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", alpha\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0.2\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".W \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(in_channels, out_channels, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"bias\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"False\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".a \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.Parameter(torch.zeros(\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"size\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"2\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" *\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" out_channels, \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")))\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".leakyrelu \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.LeakyReLU(alpha)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".dropout \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" dropout\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        nn.init.xavier_uniform_(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".a.data, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"gain\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1.414\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Linear transformation\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        Wh \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".W(x)  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# [N, out_channels]\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        N \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" Wh.size(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Compute attention coefficients\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        src, dst \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" edge_index\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Concatenate source and destination features\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        Wh_src \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" Wh[src]  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# [E, out_channels]\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        Wh_dst \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" Wh[dst]  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# [E, out_channels]\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        concat_features \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.cat([Wh_src, Wh_dst], \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# [E, 2*out_channels]\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Attention mechanism\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        e \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".leakyrelu(concat_features \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"@\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".a).squeeze()  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# [E]\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Normalize per destination node\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        attention \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.zeros(N, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"device\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"x.device)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        attention_weights \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.zeros_like(e)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(N):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            mask \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (dst \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"==\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" i)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"            if\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" mask.sum() \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\">\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"                e_neighbors \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" e[mask]\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"                alpha \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" F.softmax(e_neighbors, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"                attention_weights[mask] \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" alpha\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Apply dropout to attention\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        attention_weights \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" F.dropout(attention_weights, \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".dropout, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"training\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Aggregate\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        out \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.zeros_like(Wh)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(N):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            mask \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (dst \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"==\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" i)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"            if\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" mask.sum() \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\">\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"                out[i] \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (attention_weights[mask].unsqueeze(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" Wh[src[mask]]).sum(\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" out\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" GAT\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, hidden_channels, out_channels,\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"                 num_heads\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"8\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", dropout\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0.6\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".dropout \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" dropout\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Multi-head first layer\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".attentions \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList([\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            GATLayer(in_channels, hidden_channels, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dropout\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"dropout)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"            for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" _ \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(num_heads)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        ])\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Single-head output layer\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".out_att \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" GATLayer(\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            hidden_channels \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" num_heads,\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            out_channels,\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"            dropout\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"dropout\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        )\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # First layer: concatenate multi-head outputs\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.cat([att(x, edge_index) \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" att \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".attentions], \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" F.dropout(x, \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".dropout, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"training\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" F.elu(x)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Output layer\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        x \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".out_att(x, edge_index)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]})]})})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Strengths\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Learns which neighbors are important (anisotropic)\"}),`\n`,(0,e.jsx)(n.li,{children:\"Better at handling heterogeneous neighborhoods\"}),`\n`,(0,e.jsx)(n.li,{children:\"Respects sharp boundaries (e.g., tumor-stroma)\"}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Weaknesses\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"More parameters (attention + multi-heads)\"}),`\n`,(0,e.jsx)(n.li,{children:\"Slower than GCN\"}),`\n`,(0,e.jsx)(n.li,{children:\"Can be unstable (needs careful tuning of dropout, LR)\"}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h2,{id:\"architecture-comparison-table\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#architecture-comparison-table\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Architecture Comparison Table\"]}),`\n`,(0,e.jsxs)(n.table,{children:[(0,e.jsx)(n.thead,{children:(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.th,{children:\"Model\"}),(0,e.jsx)(n.th,{children:\"Neighbor Weights\"}),(0,e.jsx)(n.th,{children:\"Sampling\"}),(0,e.jsx)(n.th,{children:\"Inductive?\"}),(0,e.jsx)(n.th,{children:\"Best Use Case\"})]})}),(0,e.jsxs)(n.tbody,{children:[(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"GCN\"})}),(0,e.jsx)(n.td,{children:\"Fixed by normalized adjacency\"}),(0,e.jsx)(n.td,{children:\"Full graph (no sampling)\"}),(0,e.jsx)(n.td,{children:\"No (transductive)\"}),(0,e.jsx)(n.td,{children:\"Smooth tissue, clean spatial graphs, small-medium datasets\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"GraphSAGE\"})}),(0,e.jsx)(n.td,{children:\"Fixed aggregator (mean/max/LSTM)\"}),(0,e.jsx)(n.td,{children:\"Neighborhood sampling\"}),(0,e.jsx)(n.td,{children:\"Yes\"}),(0,e.jsx)(n.td,{children:\"Large graphs, multiple slides, production systems\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"GAT\"})}),(0,e.jsx)(n.td,{children:\"Learned per-edge attention\"}),(0,e.jsx)(n.td,{children:\"Full neighborhood (or can sample)\"}),(0,e.jsx)(n.td,{children:\"Often yes\"}),(0,e.jsx)(n.td,{children:\"Heterogeneous tissue, sharp boundaries, variable neighbor quality\"})]})]})]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Visual Comparison\"}),\":\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`GCN:      All neighbors weighted equally (by degree normalization)\n          [Spot] \\u2190 (0.25, 0.25, 0.25, 0.25) \\u2190 [4 neighbors]\n\nGraphSAGE: Sample subset, aggregate with mean/max\n          [Spot] \\u2190 sample 2 \\u2192 mean([n1, n2])\n\nGAT:      Learn attention per edge\n          [Spot] \\u2190 (\\u03B1\\u2081=0.5, \\u03B1\\u2082=0.3, \\u03B1\\u2083=0.15, \\u03B1\\u2084=0.05) \\u2190 [4 neighbors]\n                    \\u2191 Learned weights\n`})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h2,{id:\"graph-construction-strategies\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#graph-construction-strategies\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Graph Construction Strategies\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Critical insight\"}),\": Graph topology often matters more than the GNN architecture.\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"1-spatial-proximity-graphs\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#1-spatial-proximity-graphs\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"1. Spatial Proximity Graphs\"]}),`\n`,(0,e.jsxs)(n.h4,{id:\"k-nearest-neighbors-knn\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#k-nearest-neighbors-knn\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"k-Nearest Neighbors (kNN)\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Connect each spot to its \",(0,e.jsx)(n.code,{children:\"k\"}),\" closest spatial neighbors.\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" numpy \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" knn_graph\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(coords, k\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Build kNN graph from spatial coordinates.\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Args:\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"        coords: [N, 2] array of (x, y) positions\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"        k: number of neighbors\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Returns:\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"        edge_index: [2, E] tensor in COO format\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    nbrs \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors(\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"n_neighbors\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"k\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"algorithm\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'kd_tree'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\").fit(coords)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    distances, indices \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nbrs.kneighbors(coords)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # Exclude self (first neighbor)\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    src \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.repeat(np.arange(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"len\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(coords)), k)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    dst \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" indices[:, \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":].reshape(\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # Make undirected\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.stack([src, dst], \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.concatenate([edge_index, edge_index[::\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"]], \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.unique(edge_index, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.as_tensor(edge_index, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]})]})})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Pros\"}),`: Simple, controllable density\n`,(0,e.jsx)(n.strong,{children:\"Cons\"}),\": Fixed \",(0,e.jsx)(n.code,{children:\"k\"}),\" ignores tissue density variation\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsxs)(n.strong,{children:[\"Effect of \",(0,e.jsx)(n.code,{children:\"k\"}),\" on smoothing\"]}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsxs)(n.strong,{children:[\"Small \",(0,e.jsx)(n.code,{children:\"k\"}),\" (4-6)\"]}),\": Preserves sharp boundaries, less smoothing\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsxs)(n.strong,{children:[\"Large \",(0,e.jsx)(n.code,{children:\"k\"}),\" (12-20)\"]}),\": More smoothing, boundaries blur, risk of over-smoothing\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.h4,{id:\"radius-\\u03B5-ball-graph\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#radius-\\u03B5-ball-graph\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Radius (\\u03B5-ball) Graph\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"Connect all spots within distance \",(0,e.jsx)(n.code,{children:\"\\u03B5\"}),\".\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" radius_graph\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(coords, radius\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"100.0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Build radius graph: connect nodes within distance threshold.\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    from\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" radius_neighbors_graph\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    A \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" radius_neighbors_graph(coords, radius, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"mode\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'connectivity'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.as_tensor(np.array(A.nonzero()), \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" edge_index\"})]})]})})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Pros\"}),`: Density-adaptive, physically meaningful\n`,(0,e.jsx)(n.strong,{children:\"Cons\"}),\": Can create disconnected components if \",(0,e.jsx)(n.code,{children:\"\\u03B5\"}),\" too small\"]}),`\n`,(0,e.jsxs)(n.h4,{id:\"delaunay-triangulation\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#delaunay-triangulation\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Delaunay Triangulation\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Build triangles connecting nearest points without overlap\\u2014preserves natural geometry.\"}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" scipy.spatial \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" Delaunay\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" numpy \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" delaunay_graph\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(coords):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Build graph from Delaunay triangulation.\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Used in SpaGCN for natural spatial connectivity.\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    tri \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" Delaunay(coords)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edges \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" set\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" simplex \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" tri.simplices:\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"3\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            edge \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" tuple\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"sorted\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"([simplex[i], simplex[(i\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"%\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"3\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"]]))\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            edges.add(edge)\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edges \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.array(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"list\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(edges)).T\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # Make undirected\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.concatenate([edges, edges[::\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"]], \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.as_tensor(edge_index, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]})]})})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Pros\"}),`: Natural geometric structure, used in SpaGCN\n`,(0,e.jsx)(n.strong,{children:\"Cons\"}),\": Can create long edges in sparse regions\"]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h3,{id:\"2-expression-similarity-graphs\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#2-expression-similarity-graphs\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"2. Expression Similarity Graphs\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Connect spots with similar gene expression, independent of distance.\"}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" expression_similarity_graph\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(X, k\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", metric\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'cosine'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Build kNN graph in expression space.\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Args:\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"        X: [N, genes] expression matrix\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"        k: number of neighbors\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"        metric: 'cosine' or 'euclidean'\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    from\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    nbrs \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors(\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"n_neighbors\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"k\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"metric\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"metric).fit(X)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    distances, indices \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nbrs.kneighbors(X)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    src \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.repeat(np.arange(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"len\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(X)), k)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    dst \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" indices[:, \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":].reshape(\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.stack([src, dst], \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # Undirected\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.concatenate([edge_index, edge_index[::\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"]], \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.unique(edge_index, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.as_tensor(edge_index, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]})]})})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Pros\"}),`: Captures functional/molecular similarity\n`,(0,e.jsx)(n.strong,{children:\"Cons\"}),\": May connect distant regions; ignores spatial structure\"]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h3,{id:\"3-hybrid-multi-view-graphs\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#3-hybrid-multi-view-graphs\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"3. Hybrid (Multi-view) Graphs\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Combine spatial and expression information.\"}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Weighted combination\"}),\":\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`A = \\u03B1 \\xB7 A_spatial + (1 - \\u03B1) \\xB7 A_expression\n`})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Learnable weighting\"}),\":\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" MultiViewGNN\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, in_channels, out_channels):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".gcn_spatial \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" GCNLayer(in_channels, out_channels)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".gcn_expression \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" GCNLayer(in_channels, out_channels)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".alpha \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.Parameter(torch.tensor(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"))  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Learnable weight\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index_spatial, edge_index_expr):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        h_spatial \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".gcn_spatial(x, edge_index_spatial)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        h_expr \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".gcn_expression(x, edge_index_expr)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        alpha \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.sigmoid(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".alpha)  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Ensure [0,1]\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" alpha \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" h_spatial \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" -\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" alpha) \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" h_expr\"})]})]})})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Used in\"}),\": STAGATE, conST, GraphST\"]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h3,{id:\"4-image-based-graphs-histology-integration\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#4-image-based-graphs-histology-integration\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"4. Image-Based Graphs (Histology Integration)\"]}),`\n`,(0,e.jsx)(n.p,{children:\"If H&E images are available, use morphological similarity.\"}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" image_weighted_graph\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(coords, image_features, k\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", alpha\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Weighted graph combining spatial distance and image feature similarity.\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"    Args:\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"        coords: [N, 2] spatial positions\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"        image_features: [N, D] CNN features from histology patches\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"        alpha: weight between spatial and image (0=spatial only, 1=image only)\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'    \"\"\"'})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    from\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    from\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.metrics.pairwise \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" cosine_similarity\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # Spatial kNN\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    nbrs_spatial \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors(\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"n_neighbors\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"k\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\").fit(coords)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    dist_spatial, idx_spatial \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nbrs_spatial.kneighbors(coords)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # Image similarity\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    img_sim \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" cosine_similarity(image_features)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edges \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" []\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    weights \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" []\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" i \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"len\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(coords)):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" j_idx, j \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" enumerate\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(idx_spatial[i, \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":]):  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Skip self\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            spatial_sim \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" 1.0\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" /\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1.0\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" +\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" dist_spatial[i, j_idx\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"])\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            image_sim_val \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" img_sim[i, j]\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            combined_weight \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" alpha \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" spatial_sim \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" -\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" alpha) \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" image_sim_val\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            edges.append([i, j])\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            weights.append(combined_weight)\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(edges, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"torch.long).T\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edge_weight \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(weights, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"torch.float)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" edge_index, edge_weight\"})]})]})})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Used in\"}),\": SpaGCN, conST, MERGE\"]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h2,{id:\"state-of-the-art-methods-in-spatial-transcriptomics\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#state-of-the-art-methods-in-spatial-transcriptomics\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"State-of-the-Art Methods in Spatial Transcriptomics\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"method-comparison-table\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#method-comparison-table\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Method Comparison Table\"]}),`\n`,(0,e.jsxs)(n.table,{children:[(0,e.jsx)(n.thead,{children:(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.th,{children:\"Method\"}),(0,e.jsx)(n.th,{children:\"Year\"}),(0,e.jsx)(n.th,{children:\"Graph Type\"}),(0,e.jsx)(n.th,{children:\"GNN Architecture\"}),(0,e.jsx)(n.th,{children:\"Key Innovation\"}),(0,e.jsx)(n.th,{children:\"Task\"})]})}),(0,e.jsxs)(n.tbody,{children:[(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"SpaGCN\"})}),(0,e.jsx)(n.td,{children:\"2021\"}),(0,e.jsx)(n.td,{children:\"Spatial + histology weighted\"}),(0,e.jsx)(n.td,{children:\"GCN\"}),(0,e.jsx)(n.td,{children:\"Delaunay + image features, domain detection\"}),(0,e.jsx)(n.td,{children:\"Clustering, SVG detection\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"STAGATE\"})}),(0,e.jsx)(n.td,{children:\"2022\"}),(0,e.jsx)(n.td,{children:\"Spatial kNN\"}),(0,e.jsx)(n.td,{children:\"Graph Attention Autoencoder\"}),(0,e.jsx)(n.td,{children:\"Learned attention, autoencoder framework\"}),(0,e.jsx)(n.td,{children:\"Clustering, denoising, trajectory\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"SEDR\"})}),(0,e.jsx)(n.td,{children:\"2021\"}),(0,e.jsx)(n.td,{children:\"Spatial kNN\"}),(0,e.jsx)(n.td,{children:\"VGAE + deep autoencoder\"}),(0,e.jsx)(n.td,{children:\"Dual embedding (expression + spatial VGAE)\"}),(0,e.jsx)(n.td,{children:\"Clustering, embedding\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"GraphST\"})}),(0,e.jsx)(n.td,{children:\"2023\"}),(0,e.jsx)(n.td,{children:\"Multi-view (spatial + expr)\"}),(0,e.jsx)(n.td,{children:\"GCN + contrastive learning\"}),(0,e.jsx)(n.td,{children:\"Self-supervised contrastive, multi-sample integration\"}),(0,e.jsx)(n.td,{children:\"Clustering, deconvolution\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"STdGCN\"})}),(0,e.jsx)(n.td,{children:\"2023\"}),(0,e.jsx)(n.td,{children:\"Hybrid (spot + pseudo-spot)\"}),(0,e.jsx)(n.td,{children:\"GCN\"}),(0,e.jsx)(n.td,{children:\"Integrate scRNA reference via hybrid graph\"}),(0,e.jsx)(n.td,{children:\"Deconvolution\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"stAA\"})}),(0,e.jsx)(n.td,{children:\"2024\"}),(0,e.jsx)(n.td,{children:\"Spatial kNN\"}),(0,e.jsx)(n.td,{children:\"Adversarial VGAE\"}),(0,e.jsx)(n.td,{children:\"WGAN regularization on embeddings\"}),(0,e.jsx)(n.td,{children:\"Clustering\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"stMCDI\"})}),(0,e.jsx)(n.td,{children:\"2024\"}),(0,e.jsx)(n.td,{children:\"Spatial\"}),(0,e.jsx)(n.td,{children:\"GNN encoder in diffusion model\"}),(0,e.jsx)(n.td,{children:\"Diffusion-based imputation with GNN\"}),(0,e.jsx)(n.td,{children:\"Missing value imputation\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"MERGE\"})}),(0,e.jsx)(n.td,{children:\"2023\"}),(0,e.jsx)(n.td,{children:\"Hierarchical image patches\"}),(0,e.jsx)(n.td,{children:\"Multi-scale GNN\"}),(0,e.jsx)(n.td,{children:\"Image \\u2192 gene prediction via hierarchical graph\"}),(0,e.jsx)(n.td,{children:\"Prediction from histology\"})]})]})]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h3,{id:\"deep-dive-spagcn\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#deep-dive-spagcn\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Deep Dive: SpaGCN\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Paper\"}),\": Hu et al., \",(0,e.jsx)(n.em,{children:\"Nature Methods\"}),\" (2021)\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Problem\"}),\": Identify spatial domains using both gene expression and tissue morphology.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Graph Construction\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Build Delaunay triangulation from spot coordinates\"}),`\n`,(0,e.jsxs)(n.li,{children:[\"Weight edges by combination of:\",`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Spatial distance\"}),`\n`,(0,e.jsx)(n.li,{children:\"Histology image similarity (compare H&E patches around each spot)\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`w_ij = exp(-d_spatial(i,j)\\xB2 / 2\\u03C3_d\\xB2) \\xD7 exp(-d_image(i,j)\\xB2 / 2\\u03C3_i\\xB2)\n`})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"GNN\"}),\": Standard GCN with weighted adjacency\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Loss\"}),\": Combines:\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Clustering loss (Louvain or k-means on embeddings)\"}),`\n`,(0,e.jsx)(n.li,{children:\"Spatial regularization (neighbors should have similar cluster assignments)\"}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Code Sketch\"}),\":\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Weighted adjacency from spatial + image\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"A_weighted \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" spatial_weight \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"*\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" image_weight\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# GCN embedding\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"H \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" gcn_layers(X, A_weighted)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Clustering\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"clusters \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" louvain_clustering(H)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Find spatially variable genes per domain\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"svg_genes \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" differential_expression_per_domain(clusters)\"})]})]})})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Strengths\"}),`: Multi-modal, interpretable, works well on Visium data\n`,(0,e.jsx)(n.strong,{children:\"Limitations\"}),\": Static graph, sensitive to weighting hyperparameters\"]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h3,{id:\"deep-dive-stagate\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#deep-dive-stagate\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Deep Dive: STAGATE\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Paper\"}),\": Dong & Chen, \",(0,e.jsx)(n.em,{children:\"Nature Communications\"}),\" (2022)\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Problem\"}),\": Learn representations robust to noise, preserve spatial structure, enable downstream tasks (clustering, pseudotime).\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Architecture\"}),\": Graph Attention Autoencoder\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Encoder\"}),\": Multi-layer GAT \\u2192 latent embedding \",(0,e.jsx)(n.code,{children:\"Z\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Decoder\"}),\": Reconstruct both expression \",(0,e.jsx)(n.code,{children:\"X\"}),\" and adjacency \",(0,e.jsx)(n.code,{children:\"A\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Key Innovation\"}),\": Attention mechanism learns which neighbors are relevant, mitigating over-smoothing.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Loss\"}),\":\"]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`L = L_recon(X, X\\u0302) + \\u03BB \\xB7 L_graph(A, \\xC2)\n`})}),`\n`,(0,e.jsx)(n.p,{children:\"Where:\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"L_recon\"}),\" = MSE for expression reconstruction\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"L_graph\"}),\" = binary cross-entropy for adjacency reconstruction\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Code Outline\"}),\":\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" STAGATE\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, n_genes, hidden_dim, latent_dim):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".encoder \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList([\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            GATLayer(n_genes, hidden_dim),\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            GATLayer(hidden_dim, latent_dim)\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        ])\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".decoder_expr \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(latent_dim, n_genes)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".decoder_graph \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" InnerProductDecoder()\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Encode\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        h \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" layer \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".encoder:\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            h \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" F.elu(layer(h, edge_index))\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # Decode\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        x_recon \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".decoder_expr(h)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        adj_recon \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.sigmoid(h \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"@\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" h.T)  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Inner product for adjacency\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" x_recon, adj_recon, h\"})]})]})})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Strengths\"}),`: Adaptive smoothing, rich embeddings for multiple tasks\n`,(0,e.jsx)(n.strong,{children:\"Limitations\"}),\": More hyperparameters, potential overfitting on small datasets\"]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h3,{id:\"deep-dive-graphst-contrastive-learning\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#deep-dive-graphst-contrastive-learning\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Deep Dive: GraphST (Contrastive Learning)\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Paper\"}),\": Long et al., \",(0,e.jsx)(n.em,{children:\"Nature Communications\"}),\" (2023)\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Problem\"}),\": Integrate multiple tissue sections, perform clustering and deconvolution.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Key Idea\"}),\": Self-supervised contrastive learning on graph embeddings.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Method\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Build two views of the same graph (e.g., different augmentations or spatial vs. expression graphs)\"}),`\n`,(0,e.jsx)(n.li,{children:\"Encode both with GCN\"}),`\n`,(0,e.jsx)(n.li,{children:\"Contrastive loss: pull together embeddings from same spot, push apart different spots\"}),`\n`]}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`L_contrast = -log(exp(sim(z_i, z_i\\u207A) / \\u03C4) / \\u03A3_j exp(sim(z_i, z_j) / \\u03C4))\n`})}),`\n`,(0,e.jsxs)(n.p,{children:[\"Where \",(0,e.jsx)(n.code,{children:\"z_i\\u207A\"}),\" is the augmented view of spot \",(0,e.jsx)(n.code,{children:\"i\"}),\".\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Benefits\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Learns robust representations without labeled data\"}),`\n`,(0,e.jsx)(n.li,{children:\"Aligns multiple slides in shared embedding space\"}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Code Sketch\"}),\":\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Create two views\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"edge_index_view1 \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" knn_graph(coords, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"k\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"edge_index_view2 \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" expression_similarity_graph(X, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"k\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"10\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Encode both\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"z1 \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" gnn_encoder(X, edge_index_view1)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"z2 \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" gnn_encoder(X, edge_index_view2)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Contrastive loss (InfoNCE)\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"loss \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" contrastive_loss(z1, z2, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"temperature\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0.5\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h2,{id:\"implementation-guide\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#implementation-guide\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Implementation Guide\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"complete-pipeline-spatial-domain-detection\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#complete-pipeline-spatial-domain-detection\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Complete Pipeline: Spatial Domain Detection\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Here's a complete, runnable pipeline from raw Visium data to domain detection using a GNN.\"}),`\n`,(0,e.jsxs)(n.h4,{id:\"step-1-load-data\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#step-1-load-data\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Step 1: Load Data\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" scanpy \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sc\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" numpy \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.preprocessing \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" StandardScaler\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Load Visium data (standard scanpy format)\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"adata \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sc.read_visium(\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"path/to/visium/data\"'}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Extract coordinates and expression\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"coords \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" adata.obsm[\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'spatial'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"]  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# [N, 2]\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"X \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" adata.X.toarray() \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"if\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" hasattr\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(adata.X, \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'toarray'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\") \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"else\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" adata.X  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# [N, genes]\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Highly variable genes\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"sc.pp.highly_variable_genes(adata, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"n_top_genes\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"2000\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"X \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" X[:, adata.var[\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'highly_variable'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"]]\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Normalize\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"X \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" StandardScaler().fit_transform(X)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# To tensors\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"X_tensor \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(X, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"torch.float32)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"coords_np \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.array(coords)\"})]})]})})}),`\n`,(0,e.jsxs)(n.h4,{id:\"step-2-build-graph\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#step-2-build-graph\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Step 2: Build Graph\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.neighbors \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" build_spatial_graph\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(coords, k\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    nbrs \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" NearestNeighbors(\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"n_neighbors\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"k\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\").fit(coords)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    _, indices \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nbrs.kneighbors(coords)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    src \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.repeat(np.arange(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"len\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(coords)), k)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    dst \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" indices[:, \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":].reshape(\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.stack([src, dst], \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # Undirected\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.concatenate([edge_index, edge_index[::\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"-\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"]], \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    edge_index \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" np.unique(edge_index, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"axis\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(edge_index, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"edge_index \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" build_spatial_graph(coords_np, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"k\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"6\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,e.jsxs)(n.h4,{id:\"step-3-define-model\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#step-3-define-model\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Step 3: Define Model\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"class\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" SpatialGNN\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"nn\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"Module\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" __init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, n_genes, hidden_dim\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"128\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", latent_dim\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"32\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", n_clusters\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"7\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        super\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"().\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"__init__\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"()\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".encoder \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.ModuleList([\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            GCNLayer(n_genes, hidden_dim),\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            GCNLayer(hidden_dim, latent_dim)\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        ])\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".cluster_head \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" nn.Linear(latent_dim, n_clusters)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" forward\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(self, x, edge_index):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        h \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" x\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" layer \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".encoder:\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            h \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" layer(h, edge_index)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            h \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" F.relu(h)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"            h \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" F.dropout(h, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"p\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0.3\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"training\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".training)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        logits \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" self\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\".cluster_head(h)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"        return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" h, logits\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"model \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" SpatialGNN(\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"n_genes\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"X.shape[\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"], \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"n_clusters\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"7\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"optimizer \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.optim.Adam(model.parameters(), \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"lr\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"0.001\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,e.jsxs)(n.h4,{id:\"step-4-training-loop\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#step-4-training-loop\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Step 4: Training Loop\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.cluster \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" KMeans\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"def\"}),(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\" train_epoch\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(model, x, edge_index, optimizer):\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    model.train()\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    optimizer.zero_grad()\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # Forward\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    embeddings, logits \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" model(x, edge_index)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # Pseudo-labels from k-means (self-supervised)\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    with\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.no_grad():\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        kmeans \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" KMeans(\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"n_clusters\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"7\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"random_state\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"42\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        pseudo_labels \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" kmeans.fit_predict(embeddings.cpu().numpy())\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"        pseudo_labels \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.tensor(pseudo_labels, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dtype\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"torch.long)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # Cross-entropy loss\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    loss \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" F.cross_entropy(logits, pseudo_labels)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    loss.backward()\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    optimizer.step()\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    return\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" loss.item()\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Train\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"for\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" epoch \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"in\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" range\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"100\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"):\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    loss \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" train_epoch(model, X_tensor, edge_index, optimizer)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"    if\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" epoch \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"%\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" 10\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\" ==\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" 0\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"        print\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"f\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"Epoch '}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"{\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"epoch\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"}\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\", Loss: \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"{\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"loss\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\":.4f\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"}\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"'}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,e.jsxs)(n.h4,{id:\"step-5-extract-clusters-and-visualize\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#step-5-extract-clusters-and-visualize\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Step 5: Extract Clusters and Visualize\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"model.eval()\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"with\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" torch.no_grad():\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    embeddings, logits \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" model(X_tensor, edge_index)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    clusters \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" logits.argmax(\"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"dim\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\").cpu().numpy()\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Add to adata\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"adata.obs[\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'gnn_cluster'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" clusters\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Visualize on tissue\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" scanpy \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sc\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"sc.pl.spatial(adata, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"color\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'gnn_cluster'\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\", \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"spot_size\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"150\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h2,{id:\"practical-considerations\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#practical-considerations\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Practical Considerations\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"1-over-smoothing-problem\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#1-over-smoothing-problem\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"1. Over-smoothing Problem\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Issue\"}),\": With many GNN layers, all node features converge to the same value.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Why\"}),\": Each layer mixes neighbors' features, leading to exponential diffusion.\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Solutions\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Limit layers\"}),\": 2-3 layers often enough for ST (tissue neighborhoods are local)\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Skip connections\"}),\": Add residual connections\"]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsx)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"h_new \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" gcn_layer(h) \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"+\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" h  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Residual\"})]})})})}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Adaptive depth\"}),\" (DropEdge, PairNorm): Randomly drop edges or normalize layer outputs\"]}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Rule of thumb for ST\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Small tissue sections: 2 layers\"}),`\n`,(0,e.jsx)(n.li,{children:\"Whole-slide: 3-4 layers max\"}),`\n`,(0,e.jsx)(n.li,{children:\"Multi-sample integration: Consider global pooling instead of deeper GNN\"}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h3,{id:\"2-choosing-hyperparameter-k-number-of-neighbors\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#2-choosing-hyperparameter-k-number-of-neighbors\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"2. Choosing Hyperparameter $k$ (Number of Neighbors)\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Trade-off\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Low $k$ (4-6)\"}),\": Sharp boundaries, less smoothing, more noise sensitivity\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"High $k$ (12-20)\"}),\": Smoother, more stable, but blurs boundaries\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Guideline\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Delaunay\"}),\": Natural choice, typically $k \\\\approx 6$\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Brain cortex / layered tissue\"}),\": Lower $k$ to preserve layers\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Tumor heterogeneity\"}),\": Mid-range $k$ (6-8)\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Dense spot arrays (Visium HD)\"}),\": Higher $k$ (10-15)\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Experiment\"}),\": Try $k \\\\in {4, 6, 8, 10, 12}$ and check:\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Silhouette score on clusters\"}),`\n`,(0,e.jsx)(n.li,{children:\"Agreement with known anatomical regions\"}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h3,{id:\"3-normalization-and-preprocessing\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#3-normalization-and-preprocessing\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"3. Normalization and Preprocessing\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Critical steps\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Gene selection\"}),\": Use highly variable genes (1000-3000)\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Expression normalization\"}),\": Log1p + standard scaling\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Graph normalization\"}),\": Symmetric $\\\\tilde\",D,\"^\",-1/2,\" \\\\tilde\",A,\" \\\\tilde\",D,\"^\",-1/2,\"$ (built into GCN)\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Feature scaling\"}),\": StandardScaler before training\"]}),`\n`]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" scanpy \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"as\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sc\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.preprocessing \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" StandardScaler\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Standard pipeline\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"sc.pp.normalize_total(adata, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"target_sum\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"1e4\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"sc.pp.log1p(adata)\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"sc.pp.highly_variable_genes(adata, \"}),(0,e.jsx)(n.span,{style:{color:\"#FFAB70\"},children:\"n_top_genes\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"2000\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"adata \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" adata[:, adata.var.highly_variable]\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"X \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" StandardScaler().fit_transform(adata.X.toarray())\"})]})]})})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h3,{id:\"4-evaluation-metrics\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#4-evaluation-metrics\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"4. Evaluation Metrics\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"For \",(0,e.jsx)(n.strong,{children:\"clustering\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Adjusted Rand Index (ARI)\"}),\": Compare with ground-truth annotations\"]}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.strong,{children:\"Normalized Mutual Information (NMI)\"})}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Silhouette score\"}),\": Cluster separation in embedding space\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"For \",(0,e.jsx)(n.strong,{children:\"deconvolution\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"RMSE\"}),\" vs. known proportions (if synthetic data)\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Correlation\"}),\" with reference cell-type markers\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[\"For \",(0,e.jsx)(n.strong,{children:\"imputation\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"RMSE\"}),\" on held-out genes\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Pearson correlation\"}),\" with ground truth\"]}),`\n`]}),`\n`,(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"python\",\"data-theme\":\"github-dark\",children:(0,e.jsxs)(n.code,{\"data-language\":\"python\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" sklearn.metrics \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" adjusted_rand_score, silhouette_score\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# Clustering evaluation\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"ari \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" adjusted_rand_score(true_labels, predicted_clusters)\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"silhouette \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" silhouette_score(embeddings, predicted_clusters)\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"print\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"f\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"ARI: '}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"{\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"ari\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\":.3f\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"}\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\", Silhouette: \"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"{\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"silhouette\"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\":.3f\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"}\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"'}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\")\"})]})]})})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h3,{id:\"5-common-pitfalls\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#5-common-pitfalls\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"5. Common Pitfalls\"]}),`\n`,(0,e.jsxs)(n.table,{children:[(0,e.jsx)(n.thead,{children:(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.th,{children:\"Problem\"}),(0,e.jsx)(n.th,{children:\"Symptom\"}),(0,e.jsx)(n.th,{children:\"Solution\"})]})}),(0,e.jsxs)(n.tbody,{children:[(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"Over-smoothing\"})}),(0,e.jsx)(n.td,{children:\"All embeddings identical\"}),(0,e.jsx)(n.td,{children:\"Reduce layers, add skip connections\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"Disconnected graph\"})}),(0,e.jsx)(n.td,{children:\"NaN in training\"}),(0,e.jsx)(n.td,{children:\"Check graph connectivity, increase $k$ or $\\\\varepsilon$\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"Unstable GAT\"})}),(0,e.jsx)(n.td,{children:\"Loss spikes\"}),(0,e.jsx)(n.td,{children:\"Lower learning rate, increase dropout on attention\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"Poor clustering\"})}),(0,e.jsx)(n.td,{children:\"Random assignments\"}),(0,e.jsx)(n.td,{children:\"Better graph construction, tune $k$, check normalization\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:(0,e.jsx)(n.strong,{children:\"High memory\"})}),(0,e.jsx)(n.td,{children:\"OOM errors\"}),(0,e.jsx)(n.td,{children:\"Use mini-batching (GraphSAGE), neighbor sampling\"})]})]})]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h2,{id:\"advanced-topics\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#advanced-topics\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Advanced Topics\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"1-hypergraph-neural-networks\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#1-hypergraph-neural-networks\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"1. Hypergraph Neural Networks\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Standard GNN\"}),`: Pairwise edges (connects 2 nodes)\n`,(0,e.jsx)(n.strong,{children:\"Hypergraph\"}),\": Hyperedges connect \\u22652 nodes simultaneously\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Use case in ST\"}),\": Group of spots in a tissue domain share a hyperedge\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Example\"}),\": \",(0,e.jsx)(n.a,{href:\"https://arxiv.org/abs/2401.12001\",children:\"Hypergraph Neural Networks Reveal Spatial Domains\"})]}),`\n`,(0,e.jsxs)(n.h3,{id:\"2-hierarchical-and-multi-scale-graphs\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#2-hierarchical-and-multi-scale-graphs\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"2. Hierarchical and Multi-Scale Graphs\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Idea\"}),\": Build graphs at multiple resolutions\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"Fine-scale: spot-to-spot\"}),`\n`,(0,e.jsx)(n.li,{children:\"Coarse-scale: domain-to-domain (via clustering)\"}),`\n`]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Benefits\"}),\": Capture both local and global patterns\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Example\"}),\": MERGE builds hierarchical image patch graphs\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"3-graph-transformers\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#3-graph-transformers\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"3. Graph Transformers\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Replace message-passing with full self-attention over all nodes.\"}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Pros\"}),`: No over-smoothing, long-range dependencies\n`,(0,e.jsx)(n.strong,{children:\"Cons\"}),\": $O(N^2)$ complexity\"]}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Emerging work\"}),\": Graphormer, GraphGPS\"]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h2,{id:\"resources-and-next-steps\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#resources-and-next-steps\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Resources and Next Steps\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"papers-recommended-reading-order\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#papers-recommended-reading-order\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Papers (Recommended Reading Order)\"]}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"GNN Foundations\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"Kipf & Welling (2017): \",(0,e.jsx)(n.a,{href:\"https://arxiv.org/abs/1609.02907\",children:\"Semi-Supervised Classification with GCNs\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[\"Hamilton et al. (2017): \",(0,e.jsx)(n.a,{href:\"https://arxiv.org/abs/1706.02216\",children:\"GraphSAGE\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[\"Veli\\u010Dkovi\\u0107 et al. (2018): \",(0,e.jsx)(n.a,{href:\"https://arxiv.org/abs/1710.10903\",children:\"Graph Attention Networks\"})]}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"ST Applications\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[\"SpaGCN: \",(0,e.jsx)(n.a,{href:\"https://www.nature.com/articles/s41592-021-01255-8\",children:\"Nature Methods 2021\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[\"STAGATE: \",(0,e.jsx)(n.a,{href:\"https://www.nature.com/articles/s41467-022-29439-6\",children:\"Nature Communications 2022\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[\"GraphST: \",(0,e.jsx)(n.a,{href:\"https://www.nature.com/articles/s41467-023-36796-3\",children:\"Nature Communications 2023\"})]}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Advanced\"}),\":\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"http://web.stanford.edu/class/cs224w/\",children:\"Stanford CS224W course notes\"})}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.a,{href:\"https://www.cs.mcgill.ca/~wlh/grl_book/\",children:\"Graph Representation Learning Book\"}),\" (Hamilton)\"]}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,e.jsxs)(n.h3,{id:\"code-repositories\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#code-repositories\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Code Repositories\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"PyTorch Geometric\"}),\": \",(0,e.jsx)(n.a,{href:\"https://pytorch-geometric.readthedocs.io/\",children:\"https://pytorch-geometric.readthedocs.io/\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"DGL (Deep Graph Library)\"}),\": \",(0,e.jsx)(n.a,{href:\"https://www.dgl.ai/\",children:\"https://www.dgl.ai/\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"STAGATE\"}),\": \",(0,e.jsx)(n.a,{href:\"https://github.com/zhanglabtools/STAGATE\",children:\"https://github.com/zhanglabtools/STAGATE\"})]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"GraphST\"}),\": \",(0,e.jsx)(n.a,{href:\"https://github.com/JinmiaoChenLab/GraphST\",children:\"https://github.com/JinmiaoChenLab/GraphST\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.h3,{id:\"practice-projects\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#practice-projects\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Practice Projects\"]}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Reproduce SpaGCN\"}),\" on a public Visium dataset (e.g., mouse brain)\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Compare GCN vs. GAT\"}),\" on your own ST data\\u2014measure ARI, runtime, smoothness\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Build a hybrid graph\"}),\" (spatial + expression) and tune the weighting parameter $\\\\alpha$\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Implement contrastive learning\"}),\" for multi-sample integration\"]}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsxs)(n.h2,{id:\"conclusion\",children:[(0,e.jsx)(n.a,{className:\"anchor\",href:\"#conclusion\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Conclusion\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Graph Neural Networks provide a powerful, principled framework for spatial transcriptomics analysis by:\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Respecting spatial structure\"}),\" through graph topology\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Learning adaptive representations\"}),\" via message passing\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Integrating multi-modal data\"}),\" (expression, coordinates, images)\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Scaling to large datasets\"}),\" with sampling and mini-batching\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"The key to success is:\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Graph construction\"}),\": Choose topology that reflects your biology\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Architecture selection\"}),\": Match model complexity to data size and task\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Regularization\"}),\": Prevent over-smoothing and overfitting\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Evaluation\"}),\": Use domain-relevant metrics and biological validation\"]}),`\n`]}),`\n`,(0,e.jsx)(n.p,{children:\"As spatial omics technologies advance (Visium HD, Xenium, CosMx), GNNs will remain essential tools for discovering tissue organization, cell-cell interactions, and disease mechanisms.\"}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"Happy graph learning!\"})})]})}function h(l={}){let{wrapper:n}=l.components||{};return n?(0,e.jsx)(n,{...l,children:(0,e.jsx)(t,{...l})}):t(l)}return _(b);})();\n;return Component;"
        },
        "_id": "projects/gnn-spatial-transcriptomics.mdx",
        "_raw": {
          "sourceFilePath": "projects/gnn-spatial-transcriptomics.mdx",
          "sourceFileName": "gnn-spatial-transcriptomics.mdx",
          "sourceFileDir": "projects",
          "contentType": "mdx",
          "flattenedPath": "projects/gnn-spatial-transcriptomics"
        },
        "type": "Project",
        "url": "/projects/gnn-spatial-transcriptomics",
        "slug": "gnn-spatial-transcriptomics"
      },
      "documentHash": "1759705616006",
      "hasWarnings": false,
      "documentTypeName": "Project"
    },
    "projects/personal-website.mdx": {
      "document": {
        "title": "Personal Website Project",
        "summary": "A modern personal website with AI-powered content search and interactive knowledge graphs",
        "status": "in-progress",
        "role": "Full-stack Developer",
        "stack": [
          "Next.js",
          "TypeScript",
          "Tailwind CSS",
          "Supabase",
          "Contentlayer"
        ],
        "repoUrl": "https://github.com/sample/personal-website",
        "demoUrl": "https://sample-website.vercel.app",
        "images": [],
        "tags": [
          "web development",
          "AI",
          "full-stack"
        ],
        "featured": true,
        "startDate": "2025-08-27T00:00:00.000Z",
        "body": {
          "raw": "\n# Personal Website Project\n\nThis project showcases a modern approach to building personal academic websites with integrated AI capabilities.\n\n## Overview\n\nThe website features:\n- Git-based content management\n- AI-powered search and chat\n- Interactive knowledge graphs\n- Responsive design with dark mode\n\n## Technology Stack\n\n- **Frontend**: Next.js with App Router, React, TypeScript\n- **Styling**: Tailwind CSS, shadcn/ui components  \n- **Content**: MDX with Contentlayer for static generation\n- **Database**: Supabase with pgvector for embeddings\n- **Deployment**: Vercel for automatic deployments\n\n## Key Features\n\n### Content Management\n- Markdown/MDX files in Git for publications and projects\n- Automatic content indexing and embedding generation\n- Support for rich media including images, videos, and PDFs\n\n### AI Agent\n- Context-aware chat interface on every page\n- Semantic search across all content\n- Graph visualization tools\n- Media preview capabilities\n\n## Architecture\n\nThe application follows a modern JAMstack approach with:\n1. Static generation for optimal performance\n2. Dynamic API routes for search and AI features  \n3. Edge functions for content processing\n4. CDN distribution for global availability",
          "code": "var Component=(()=>{var p=Object.create;var t=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty;var w=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),b=(i,e)=>{for(var a in e)t(i,a,{get:e[a],enumerable:!0})},l=(i,e,a,c)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let r of g(e))!f.call(i,r)&&r!==a&&t(i,r,{get:()=>e[r],enumerable:!(c=m(e,r))||c.enumerable});return i};var k=(i,e,a)=>(a=i!=null?p(u(i)):{},l(e||!i||!i.__esModule?t(a,\"default\",{value:i,enumerable:!0}):a,i)),v=i=>l(t({},\"__esModule\",{value:!0}),i);var s=w((x,o)=>{o.exports=_jsx_runtime});var N={};b(N,{default:()=>d,frontmatter:()=>y});var n=k(s()),y={title:\"Personal Website Project\",summary:\"A modern personal website with AI-powered content search and interactive knowledge graphs\",status:\"in-progress\",role:\"Full-stack Developer\",stack:[\"Next.js\",\"TypeScript\",\"Tailwind CSS\",\"Supabase\",\"Contentlayer\"],repoUrl:\"https://github.com/sample/personal-website\",demoUrl:\"https://sample-website.vercel.app\",tags:[\"web development\",\"AI\",\"full-stack\"],featured:!0,startDate:\"2025-08-27\"};function h(i){let e={a:\"a\",h1:\"h1\",h2:\"h2\",h3:\"h3\",li:\"li\",ol:\"ol\",p:\"p\",span:\"span\",strong:\"strong\",ul:\"ul\",...i.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:\"personal-website-project\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#personal-website-project\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Personal Website Project\"]}),`\n`,(0,n.jsx)(e.p,{children:\"This project showcases a modern approach to building personal academic websites with integrated AI capabilities.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"overview\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#overview\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Overview\"]}),`\n`,(0,n.jsx)(e.p,{children:\"The website features:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Git-based content management\"}),`\n`,(0,n.jsx)(e.li,{children:\"AI-powered search and chat\"}),`\n`,(0,n.jsx)(e.li,{children:\"Interactive knowledge graphs\"}),`\n`,(0,n.jsx)(e.li,{children:\"Responsive design with dark mode\"}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"technology-stack\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#technology-stack\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Technology Stack\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Frontend\"}),\": Next.js with App Router, React, TypeScript\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Styling\"}),\": Tailwind CSS, shadcn/ui components\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Content\"}),\": MDX with Contentlayer for static generation\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Database\"}),\": Supabase with pgvector for embeddings\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Deployment\"}),\": Vercel for automatic deployments\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"key-features\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#key-features\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Key Features\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"content-management\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#content-management\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Content Management\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Markdown/MDX files in Git for publications and projects\"}),`\n`,(0,n.jsx)(e.li,{children:\"Automatic content indexing and embedding generation\"}),`\n`,(0,n.jsx)(e.li,{children:\"Support for rich media including images, videos, and PDFs\"}),`\n`]}),`\n`,(0,n.jsxs)(e.h3,{id:\"ai-agent\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#ai-agent\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"AI Agent\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Context-aware chat interface on every page\"}),`\n`,(0,n.jsx)(e.li,{children:\"Semantic search across all content\"}),`\n`,(0,n.jsx)(e.li,{children:\"Graph visualization tools\"}),`\n`,(0,n.jsx)(e.li,{children:\"Media preview capabilities\"}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"architecture\",children:[(0,n.jsx)(e.a,{className:\"anchor\",href:\"#architecture\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Architecture\"]}),`\n`,(0,n.jsx)(e.p,{children:\"The application follows a modern JAMstack approach with:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Static generation for optimal performance\"}),`\n`,(0,n.jsx)(e.li,{children:\"Dynamic API routes for search and AI features\"}),`\n`,(0,n.jsx)(e.li,{children:\"Edge functions for content processing\"}),`\n`,(0,n.jsx)(e.li,{children:\"CDN distribution for global availability\"}),`\n`]})]})}function d(i={}){let{wrapper:e}=i.components||{};return e?(0,n.jsx)(e,{...i,children:(0,n.jsx)(h,{...i})}):h(i)}return v(N);})();\n;return Component;"
        },
        "_id": "projects/personal-website.mdx",
        "_raw": {
          "sourceFilePath": "projects/personal-website.mdx",
          "sourceFileName": "personal-website.mdx",
          "sourceFileDir": "projects",
          "contentType": "mdx",
          "flattenedPath": "projects/personal-website"
        },
        "type": "Project",
        "url": "/projects/personal-website",
        "slug": "personal-website"
      },
      "documentHash": "1756352998086",
      "hasWarnings": false,
      "documentTypeName": "Project"
    }
  }
}
